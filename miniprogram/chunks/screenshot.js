"use strict";var e=require("./three-platformize.js");class t{constructor(e,t){this.parts=e,this.options=t}}for(var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=new Uint8Array(256),n=0;n<r.length;n++)a[r.charCodeAt(n)]=n;class s{createObjectURL(e){if(e instanceof t){const t=function(e){for(var t,a="",n=new Uint8Array(e),s=n.byteLength,i=s%3,o=s-i,c=0;c<o;c+=3)t=n[c]<<16|n[c+1]<<8|n[c+2],a+=r[(16515072&t)>>18]+r[(258048&t)>>12]+r[(4032&t)>>6]+r[63&t];return 1==i?(t=n[o],a+=r[(252&t)>>2]+r[(3&t)<<4]+"=="):2==i&&(t=n[o]<<8|n[o+1],a+=r[(64512&t)>>10]+r[(1008&t)>>4]+r[(15&t)<<2]+"="),a}(e.parts[0]);return`data:${e.options.type};base64,${t}`}return""}revokeObjectURL(){}}function i(e){if((e=(e=`${e}`).replace(/[ \t\n\f\r]/g,"")).length%4==0&&(e=e.replace(/==?$/,"")),e.length%4==1||/[^+/0-9A-Za-z]/.test(e))return null;let t="",r=0,a=0;for(let n=0;n<e.length;n++)r<<=6,r|=o(e[n]),a+=6,24===a&&(t+=String.fromCharCode((16711680&r)>>16),t+=String.fromCharCode((65280&r)>>8),t+=String.fromCharCode(255&r),r=a=0);return 12===a?(r>>=4,t+=String.fromCharCode(r)):18===a&&(r>>=2,t+=String.fromCharCode((65280&r)>>8),t+=String.fromCharCode(255&r)),t}function o(e){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(e);return t<0?void 0:t}const c=new WeakMap;class l{constructor(e){this.identifier=e.identifier,this.force=void 0===e.force?1:e.force,this.pageX=void 0===e.pageX?e.x:e.pageX,this.pageY=void 0===e.pageY?e.y:e.pageY,this.clientX=void 0===e.clientX?e.x:e.clientX,this.clientY=void 0===e.clientY?e.y:e.clientY,this.screenX=this.pageX,this.screenY=this.pageY}}class u{constructor(){c.set(this,{})}addEventListener(e,t,r={}){let a=c.get(this);a||(a={},c.set(this,a)),a[e]||(a[e]=[]),a[e].push(t),r.capture,r.once,r.passive}removeEventListener(e,t){const r=c.get(this);if(r){const a=r[e];if(a&&a.length>0)for(let e=a.length;e--;e>0)if(a[e]===t){a.splice(e,1);break}}}dispatchEvent(e={}){"function"!=typeof e.preventDefault&&(e.preventDefault=()=>{}),"function"!=typeof e.stopPropagation&&(e.stopPropagation=()=>{});const t=c.get(this);if(t){const r=t[e.type];if(r)for(let t=0;t<r.length;t++)r[t](e)}}}const h=new WeakMap,p=new WeakMap,f=new WeakMap;function d(e,t={}){t.target=t.target||this,"function"==typeof this[`on${e}`]&&this[`on${e}`].call(this,t)}function g(e,t={}){this.readyState=e,t.readyState=e,d.call(this,"readystatechange",t)}const{platform:m}=wx.getSystemInfoSync();class v extends u{constructor(){super(),this.onabort=null,this.onerror=null,this.onload=null,this.onloadstart=null,this.onprogress=null,this.ontimeout=null,this.onloadend=null,this.onreadystatechange=null,this.readyState=0,this.response=null,this.responseText=null,this.responseType="text",this.dataType="string",this.responseXML=null,this.status=0,this.statusText="",this.upload={},this.withCredentials=!1,h.set(this,{"content-type":"application/x-www-form-urlencoded"}),p.set(this,{})}abort(){const e=f.get(this);e&&e.abort()}getAllResponseHeaders(){const e=p.get(this);return Object.keys(e).map((t=>`${t}: ${e[t]}`)).join("\n")}getResponseHeader(e){return p.get(this)[e]}open(e,t){this._method=e,this._url=t,g.call(this,v.OPENED)}overrideMimeType(){}send(e=""){if(this.readyState!==v.OPENED)throw new Error("Failed to execute 'send' on 'XMLHttpRequest': The object's state must be OPENED.");{const r=this._url,a=h.get(this),n=this.responseType,s=this.dataType,i=function(e){return!/^(http|https|ftp|wxfile):\/\/.*/i.test(e)}(r);let o;"arraybuffer"===n||(o="utf8"),delete this.response,this.response=null;let c=!1;const l=({data:e,statusCode:t,header:r})=>{if(!c){if(c=!0,t=void 0===t?200:t,"string"!=typeof e&&!(e instanceof ArrayBuffer))try{e=JSON.stringify(e)}catch(e){}this.status=t,r&&p.set(this,r),d.call(this,"loadstart"),g.call(this,v.HEADERS_RECEIVED),g.call(this,v.LOADING),this.response=e,e instanceof ArrayBuffer?Object.defineProperty(this,"responseText",{enumerable:!0,configurable:!0,get:function(){throw"InvalidStateError : responseType is "+this.responseType}}):this.responseText=e,g.call(this,v.DONE),d.call(this,"load"),d.call(this,"loadend")}},u=({errMsg:e})=>{c||(c=!0,-1!==e.indexOf("abort")?d.call(this,"abort"):d.call(this,"error",{message:e}),d.call(this,"loadend"),i&&console.warn(e))};if(i){const e=wx.getFileSystemManager();var t={filePath:r,success:l,fail:u};return o&&(t.encoding=o),void e.readFile(t)}const f="arraybuffer"===n&&"ios"===m&&v.useFetchPatch;wx.request({data:e,url:r,method:this._method,header:a,dataType:s,responseType:n,enableCache:!1,success:l,fail:u}),f&&setTimeout((function(){wx.request({data:e,url:r,method:this._method,header:a,dataType:s,responseType:n,enableCache:!0,success:l,fail:u})}),v.fetchPatchDelay)}}setRequestHeader(e,t){const r=h.get(this);r[e]=t,h.set(this,r)}addEventListener(e,t){"function"==typeof t&&(this["on"+e]=(e={})=>{e.target=e.target||this,t.call(this,e)})}removeEventListener(e,t){this["on"+e]===t&&(this["on"+e]=null)}}function y(e){return e=(e=e.trim()).replace(/<!--[\s\S]*?-->/g,""),{declaration:t(),root:r()};function t(){if(!n(/^<\?xml\s*/))return;const e={attributes:{}};for(;!s()&&!i("?>");){const t=a();if(!t)return e;e.attributes[t.name]=t.value}return n(/\?>\s*/),n(/<!DOCTYPE[^>]*>\s/),e}function r(){const e=n(/^<([\w-:.]+)\s*/);if(!e)return;const t={name:e[1],attributes:{},children:[]};for(;!(s()||i(">")||i("?>")||i("/>"));){const e=a();if(!e)return t;t.attributes[e.name]=e.value}if(n(/^\s*\/>\s*/))return t;let o;for(n(/\??>\s*/),t.content=function(){const e=n(/^([^<]*)/);return e?e[1]:""}();o=r();)t.children.push(o);return n(/^<\/[\w-:.]+>\s*/),t}function a(){const e=n(/([\w:-]+)\s*=\s*("[^"]*"|'[^']*'|\w+)\s*/);var t;if(e)return{name:e[1],value:(t=e[2],t.replace(/^['"]|['"]$/g,""))}}function n(t){const r=e.match(t);if(r)return e=e.slice(r[0].length),r}function s(){return 0==e.length}function i(t){return 0==e.indexOf(t)}}function A(e,t){t(e),e.children.forEach((e=>A(e,t)))}v.UNSEND=0,v.OPENED=1,v.HEADERS_RECEIVED=2,v.LOADING=3,v.DONE=4,v.useFetchPatch=!1,v.fetchPatchDelay=200;class b{parseFromString(e){const t=y(e),r={hasAttribute(e){return void 0!==this.attributes[e]},getAttribute(e){return this.attributes[e]},getElementsByTagName(e){const t=[];return this.childNodes.forEach((r=>A(r,(r=>e===r.name&&t.push(r))))),t}};A(t.root,(e=>{e.nodeType=1,e.nodeName=e.name,e.style=new Proxy((e.attributes.style||"").split(";").reduce(((e,t)=>{if(t){let[r,a]=t.split(":");e[r.trim()]=a.trim()}return e}),{}),{get:(e,t)=>e[t]||""}),e.textContent=e.content,e.childNodes=e.children,e.__proto__=r}));const a={documentElement:t.root,childNodes:[t.root]};return a.__proto__=r,a}}class B{decode(e){let t="";for(let r=0,a=e.length;r<a;r++)t+=String.fromCharCode(e[r]);try{return decodeURIComponent(escape(t))}catch(e){return t}}}function C(){return wx.createOffscreenCanvas()}var x=function(){function t(t){e.Loader.call(this,t),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register((function(e){return new i(e)})),this.register((function(e){return new c(e)})),this.register((function(e){return new l(e)})),this.register((function(e){return new o(e)})),this.register((function(e){return new n(e)})),this.register((function(e){return new u(e)}))}function r(){var e={};return{get:function(t){return e[t]},add:function(t,r){e[t]=r},remove:function(t){delete e[t]},removeAll:function(){e={}}}}t.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:t,load:function(t,r,a,n){var s,i=this;s=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:e.LoaderUtils.extractUrlBase(t),this.manager.itemStart(t);var o=function(e){n?n(e):console.error(e),i.manager.itemError(t),i.manager.itemEnd(t)},c=new e.FileLoader(this.manager);c.setPath(this.path),c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(t,(function(e){try{i.parse(e,s,(function(e){r(e),i.manager.itemEnd(t)}),o)}catch(e){o(e)}}),a,o)},setDRACOLoader:function(e){return this.dracoLoader=e,this},setDDSLoader:function(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')},setKTX2Loader:function(e){return this.ktx2Loader=e,this},setMeshoptDecoder:function(e){return this.meshoptDecoder=e,this},register:function(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this},unregister:function(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this},parse:function(t,r,n,i){var o,c={},l={};if("string"==typeof t)o=t;else if(e.LoaderUtils.decodeText(new Uint8Array(t,0,4))===h){try{c[a.KHR_BINARY_GLTF]=new d(t)}catch(e){return void(i&&i(e))}o=c[a.KHR_BINARY_GLTF].content}else o=e.LoaderUtils.decodeText(new Uint8Array(t));var u=JSON.parse(o);if(void 0===u.asset||u.asset.version[0]<2)i&&i(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));else{var p=new j(u,{path:r||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});p.fileLoader.setRequestHeader(this.requestHeader);for(var f=0;f<this.pluginCallbacks.length;f++){var v=this.pluginCallbacks[f](p);l[v.name]=v,c[v.name]=!0}if(u.extensionsUsed)for(f=0;f<u.extensionsUsed.length;++f){var b=u.extensionsUsed[f],B=u.extensionsRequired||[];switch(b){case a.KHR_MATERIALS_UNLIT:c[b]=new s;break;case a.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:c[b]=new y;break;case a.KHR_DRACO_MESH_COMPRESSION:c[b]=new g(u,this.dracoLoader);break;case a.KHR_TEXTURE_TRANSFORM:c[b]=new m;break;case a.KHR_MESH_QUANTIZATION:c[b]=new A;break;default:B.indexOf(b)>=0&&void 0===l[b]&&console.warn('THREE.GLTFLoader: Unknown extension "'+b+'".')}}p.setExtensions(c),p.setPlugins(l),p.parse(n,i)}}});var a={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"};function n(e){this.parser=e,this.name=a.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}function s(){this.name=a.KHR_MATERIALS_UNLIT}function i(e){this.parser=e,this.name=a.KHR_MATERIALS_CLEARCOAT}function o(e){this.parser=e,this.name=a.KHR_MATERIALS_TRANSMISSION}function c(e){this.parser=e,this.name=a.KHR_TEXTURE_BASISU}function l(e){this.parser=e,this.name=a.EXT_TEXTURE_WEBP,this.isSupported=null}function u(e){this.name=a.EXT_MESHOPT_COMPRESSION,this.parser=e}n.prototype._markDefs=function(){for(var e=this.parser,t=this.parser.json.nodes||[],r=0,a=t.length;r<a;r++){var n=t[r];n.extensions&&n.extensions[this.name]&&void 0!==n.extensions[this.name].light&&e._addNodeRef(this.cache,n.extensions[this.name].light)}},n.prototype._loadLight=function(t){var r=this.parser,a="light:"+t,n=r.cache.get(a);if(n)return n;var s,i=r.json,o=((i.extensions&&i.extensions[this.name]||{}).lights||[])[t],c=new e.Color(16777215);void 0!==o.color&&c.fromArray(o.color);var l=void 0!==o.range?o.range:0;switch(o.type){case"directional":(s=new e.DirectionalLight(c)).target.position.set(0,0,-1),s.add(s.target);break;case"point":(s=new e.PointLight(c)).distance=l;break;case"spot":(s=new e.SpotLight(c)).distance=l,o.spot=o.spot||{},o.spot.innerConeAngle=void 0!==o.spot.innerConeAngle?o.spot.innerConeAngle:0,o.spot.outerConeAngle=void 0!==o.spot.outerConeAngle?o.spot.outerConeAngle:Math.PI/4,s.angle=o.spot.outerConeAngle,s.penumbra=1-o.spot.innerConeAngle/o.spot.outerConeAngle,s.target.position.set(0,0,-1),s.add(s.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+o.type)}return s.position.set(0,0,0),s.decay=2,void 0!==o.intensity&&(s.intensity=o.intensity),s.name=r.createUniqueName(o.name||"light_"+t),n=Promise.resolve(s),r.cache.add(a,n),n},n.prototype.createNodeAttachment=function(e){var t=this,r=this.parser,a=r.json.nodes[e],n=(a.extensions&&a.extensions[this.name]||{}).light;return void 0===n?null:this._loadLight(n).then((function(e){return r._getNodeRef(t.cache,n,e)}))},s.prototype.getMaterialType=function(){return e.MeshBasicMaterial},s.prototype.extendParams=function(t,r,a){var n=[];t.color=new e.Color(1,1,1),t.opacity=1;var s=r.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){var i=s.baseColorFactor;t.color.fromArray(i),t.opacity=i[3]}void 0!==s.baseColorTexture&&n.push(a.assignTexture(t,"map",s.baseColorTexture))}return Promise.all(n)},i.prototype.getMaterialType=function(t){var r=this.parser.json.materials[t];return r.extensions&&r.extensions[this.name]?e.MeshPhysicalMaterial:null},i.prototype.extendMaterialParams=function(t,r){var a=this.parser,n=a.json.materials[t];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();var s=[],i=n.extensions[this.name];if(void 0!==i.clearcoatFactor&&(r.clearcoat=i.clearcoatFactor),void 0!==i.clearcoatTexture&&s.push(a.assignTexture(r,"clearcoatMap",i.clearcoatTexture)),void 0!==i.clearcoatRoughnessFactor&&(r.clearcoatRoughness=i.clearcoatRoughnessFactor),void 0!==i.clearcoatRoughnessTexture&&s.push(a.assignTexture(r,"clearcoatRoughnessMap",i.clearcoatRoughnessTexture)),void 0!==i.clearcoatNormalTexture&&(s.push(a.assignTexture(r,"clearcoatNormalMap",i.clearcoatNormalTexture)),void 0!==i.clearcoatNormalTexture.scale)){var o=i.clearcoatNormalTexture.scale;r.clearcoatNormalScale=new e.Vector2(o,-o)}return Promise.all(s)},o.prototype.getMaterialType=function(t){var r=this.parser.json.materials[t];return r.extensions&&r.extensions[this.name]?e.MeshPhysicalMaterial:null},o.prototype.extendMaterialParams=function(e,t){var r=this.parser,a=r.json.materials[e];if(!a.extensions||!a.extensions[this.name])return Promise.resolve();var n=[],s=a.extensions[this.name];return void 0!==s.transmissionFactor&&(t.transmission=s.transmissionFactor),void 0!==s.transmissionTexture&&n.push(r.assignTexture(t,"transmissionMap",s.transmissionTexture)),Promise.all(n)},c.prototype.loadTexture=function(e){var t=this.parser,r=t.json,a=r.textures[e];if(!a.extensions||!a.extensions[this.name])return null;var n=a.extensions[this.name],s=r.images[n.source],i=t.options.ktx2Loader;if(!i){if(r.extensionsRequired&&r.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s,i)},l.prototype.loadTexture=function(e){var t=this.name,r=this.parser,a=r.json,n=a.textures[e];if(!n.extensions||!n.extensions[t])return null;var s=n.extensions[t],i=a.images[s.source],o=r.textureLoader;if(i.uri){var c=r.options.manager.getHandler(i.uri);null!==c&&(o=c)}return this.detectSupport().then((function(n){if(n)return r.loadTextureImage(e,i,o);if(a.extensionsRequired&&a.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return r.loadTexture(e)}))},l.prototype.detectSupport=function(){return this.isSupported||(this.isSupported=new Promise((function(e){var t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}}))),this.isSupported},u.prototype.loadBufferView=function(e){var t=this.parser.json,r=t.bufferViews[e];if(r.extensions&&r.extensions[this.name]){var a=r.extensions[this.name],n=this.parser.getDependency("buffer",a.buffer),s=this.parser.options.meshoptDecoder;if(!s||!s.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([n,s.ready]).then((function(e){var t=a.byteOffset||0,r=a.byteLength||0,n=a.count,i=a.byteStride,o=new ArrayBuffer(n*i),c=new Uint8Array(e[0],t,r);return s.decodeGltfBuffer(new Uint8Array(o),n,i,c,a.mode,a.filter),o}))}return null};var h="glTF",p=1313821514,f=5130562;function d(t){this.name=a.KHR_BINARY_GLTF,this.content=null,this.body=null;var r=new DataView(t,0,12);if(this.header={magic:e.LoaderUtils.decodeText(new Uint8Array(t.slice(0,4))),version:r.getUint32(4,!0),length:r.getUint32(8,!0)},this.header.magic!==h)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");for(var n=this.header.length-12,s=new DataView(t,12),i=0;i<n;){var o=s.getUint32(i,!0);i+=4;var c=s.getUint32(i,!0);if(i+=4,c===p){var l=new Uint8Array(t,12+i,o);this.content=e.LoaderUtils.decodeText(l)}else if(c===f){var u=12+i;this.body=t.slice(u,u+o)}i+=o}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}function g(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=a.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}function m(){this.name=a.KHR_TEXTURE_TRANSFORM}function v(t){e.MeshStandardMaterial.call(this),this.isGLTFSpecularGlossinessMaterial=!0;var r=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),a=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),n=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),s=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),i=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularColor = specularFactor;"].join("\n"),o={specular:{value:(new e.Color).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=o,this.onBeforeCompile=function(e){for(var t in o)e.uniforms[t]=o[t];e.fragmentShader=e.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",r).replace("#include <metalnessmap_pars_fragment>",a).replace("#include <roughnessmap_fragment>",n).replace("#include <metalnessmap_fragment>",s).replace("#include <lights_physical_fragment>",i)},Object.defineProperties(this,{specular:{get:function(){return o.specular.value},set:function(e){o.specular.value=e}},specularMap:{get:function(){return o.specularMap.value},set:function(e){o.specularMap.value=e,e?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return o.glossiness.value},set:function(e){o.glossiness.value=e}},glossinessMap:{get:function(){return o.glossinessMap.value},set:function(e){o.glossinessMap.value=e,e?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(t)}function y(){return{name:a.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return v},extendParams:function(t,r,a){var n=r.extensions[this.name];t.color=new e.Color(1,1,1),t.opacity=1;var s=[];if(Array.isArray(n.diffuseFactor)){var i=n.diffuseFactor;t.color.fromArray(i),t.opacity=i[3]}if(void 0!==n.diffuseTexture&&s.push(a.assignTexture(t,"map",n.diffuseTexture)),t.emissive=new e.Color(0,0,0),t.glossiness=void 0!==n.glossinessFactor?n.glossinessFactor:1,t.specular=new e.Color(1,1,1),Array.isArray(n.specularFactor)&&t.specular.fromArray(n.specularFactor),void 0!==n.specularGlossinessTexture){var o=n.specularGlossinessTexture;s.push(a.assignTexture(t,"glossinessMap",o)),s.push(a.assignTexture(t,"specularMap",o))}return Promise.all(s)},createMaterial:function(t){var r=new v(t);return r.fog=!0,r.color=t.color,r.map=void 0===t.map?null:t.map,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=void 0===t.aoMap?null:t.aoMap,r.aoMapIntensity=1,r.emissive=t.emissive,r.emissiveIntensity=1,r.emissiveMap=void 0===t.emissiveMap?null:t.emissiveMap,r.bumpMap=void 0===t.bumpMap?null:t.bumpMap,r.bumpScale=1,r.normalMap=void 0===t.normalMap?null:t.normalMap,r.normalMapType=e.TangentSpaceNormalMap,t.normalScale&&(r.normalScale=t.normalScale),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.specularMap=void 0===t.specularMap?null:t.specularMap,r.specular=t.specular,r.glossinessMap=void 0===t.glossinessMap?null:t.glossinessMap,r.glossiness=t.glossiness,r.alphaMap=null,r.envMap=void 0===t.envMap?null:t.envMap,r.envMapIntensity=1,r.refractionRatio=.98,r}}}function A(){this.name=a.KHR_MESH_QUANTIZATION}function b(t,r,a,n){e.Interpolant.call(this,t,r,a,n)}g.prototype.decodePrimitive=function(e,t){var r=this.json,a=this.dracoLoader,n=e.extensions[this.name].bufferView,s=e.extensions[this.name].attributes,i={},o={},c={};for(var l in s){var u=R[l]||l.toLowerCase();i[u]=s[l]}for(l in e.attributes){u=R[l]||l.toLowerCase();if(void 0!==s[l]){var h=r.accessors[e.attributes[l]],p=I[h.componentType];c[u]=p,o[u]=!0===h.normalized}}return t.getDependency("bufferView",n).then((function(e){return new Promise((function(t){a.decodeDracoFile(e,(function(e){for(var r in e.attributes){var a=e.attributes[r],n=o[r];void 0!==n&&(a.normalized=n)}t(e)}),i,c)}))}))},m.prototype.extendTexture=function(e,t){return e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),e.needsUpdate=!0,e},v.prototype=Object.create(e.MeshStandardMaterial.prototype),v.prototype.constructor=v,v.prototype.copy=function(t){return e.MeshStandardMaterial.prototype.copy.call(this,t),this.specularMap=t.specularMap,this.specular.copy(t.specular),this.glossinessMap=t.glossinessMap,this.glossiness=t.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this},b.prototype=Object.create(e.Interpolant.prototype),b.prototype.constructor=b,b.prototype.copySampleValue_=function(e){for(var t=this.resultBuffer,r=this.sampleValues,a=this.valueSize,n=e*a*3+a,s=0;s!==a;s++)t[s]=r[n+s];return t},b.prototype.beforeStart_=b.prototype.copySampleValue_,b.prototype.afterEnd_=b.prototype.copySampleValue_,b.prototype.interpolate_=function(e,t,r,a){for(var n=this.resultBuffer,s=this.sampleValues,i=this.valueSize,o=2*i,c=3*i,l=a-t,u=(r-t)/l,h=u*u,p=h*u,f=e*c,d=f-c,g=-2*p+3*h,m=p-h,v=1-g,y=m-h+u,A=0;A!==i;A++){var b=s[d+A+i],B=s[d+A+o]*l,C=s[f+A+i],x=s[f+A]*l;n[A]=v*b+y*B+g*C+m*x}return n};var B=0,C=1,x=2,F=3,w=4,E=5,S=6,I={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},M={9728:e.NearestFilter,9729:e.LinearFilter,9984:e.NearestMipmapNearestFilter,9985:e.LinearMipmapNearestFilter,9986:e.NearestMipmapLinearFilter,9987:e.LinearMipmapLinearFilter},T={33071:e.ClampToEdgeWrapping,33648:e.MirroredRepeatWrapping,10497:e.RepeatWrapping},k={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},R={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},L={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},D={CUBICSPLINE:void 0,LINEAR:e.InterpolateLinear,STEP:e.InterpolateDiscrete},O="OPAQUE",U="MASK",G="BLEND";function N(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}function P(e,t,r){for(var a in r.extensions)void 0===e[a]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[a]=r.extensions[a])}function H(e,t){void 0!==t.extras&&("object"==typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function J(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(var r=0,a=t.weights.length;r<a;r++)e.morphTargetInfluences[r]=t.weights[r];if(t.extras&&Array.isArray(t.extras.targetNames)){var n=t.extras.targetNames;if(e.morphTargetInfluences.length===n.length){e.morphTargetDictionary={};for(r=0,a=n.length;r<a;r++)e.morphTargetDictionary[n[r]]=r}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function _(e){for(var t="",r=Object.keys(e).sort(),a=0,n=r.length;a<n;a++)t+=r[a]+":"+e[r[a]]+";";return t}function j(t,a){this.json=t||{},this.extensions={},this.plugins={},this.options=a||{},this.cache=new r,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.nodeNamesUsed={},void 0!==e.$createImageBitmap&&!1===/Firefox/.test(navigator.userAgent)?this.textureLoader=new e.ImageBitmapLoader(this.options.manager):this.textureLoader=new e.TextureLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new e.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}function V(t,r,a){var n=r.attributes,s=[];function i(e,r){return a.getDependency("accessor",e).then((function(e){t.setAttribute(r,e)}))}for(var o in n){var c=R[o]||o.toLowerCase();c in t.attributes||s.push(i(n[o],c))}if(void 0!==r.indices&&!t.index){var l=a.getDependency("accessor",r.indices).then((function(e){t.setIndex(e)}));s.push(l)}return H(t,r),function(t,r,a){var n=r.attributes,s=new e.Box3;if(void 0!==n.POSITION){var i=(f=a.json.accessors[n.POSITION]).min,o=f.max;if(void 0!==i&&void 0!==o){s.set(new e.Vector3(i[0],i[1],i[2]),new e.Vector3(o[0],o[1],o[2]));var c=r.targets;if(void 0!==c){for(var l=new e.Vector3,u=new e.Vector3,h=0,p=c.length;h<p;h++){var f,d=c[h];if(void 0!==d.POSITION)i=(f=a.json.accessors[d.POSITION]).min,o=f.max,void 0!==i&&void 0!==o?(u.setX(Math.max(Math.abs(i[0]),Math.abs(o[0]))),u.setY(Math.max(Math.abs(i[1]),Math.abs(o[1]))),u.setZ(Math.max(Math.abs(i[2]),Math.abs(o[2]))),l.max(u)):console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}s.expandByVector(l)}t.boundingBox=s;var g=new e.Sphere;s.getCenter(g.center),g.radius=s.min.distanceTo(s.max)/2,t.boundingSphere=g}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}(t,r,a),Promise.all(s).then((function(){return void 0!==r.targets?function(e,t,r){for(var a=!1,n=!1,s=0,i=t.length;s<i&&(void 0!==(l=t[s]).POSITION&&(a=!0),void 0!==l.NORMAL&&(n=!0),!a||!n);s++);if(!a&&!n)return Promise.resolve(e);var o=[],c=[];for(s=0,i=t.length;s<i;s++){var l=t[s];if(a){var u=void 0!==l.POSITION?r.getDependency("accessor",l.POSITION):e.attributes.position;o.push(u)}n&&(u=void 0!==l.NORMAL?r.getDependency("accessor",l.NORMAL):e.attributes.normal,c.push(u))}return Promise.all([Promise.all(o),Promise.all(c)]).then((function(t){var r=t[0],s=t[1];return a&&(e.morphAttributes.position=r),n&&(e.morphAttributes.normal=s),e.morphTargetsRelative=!0,e}))}(t,r.targets,a):t}))}function X(t,r){var a=t.getIndex();if(null===a){var n=[],s=t.getAttribute("position");if(void 0===s)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),t;for(var i=0;i<s.count;i++)n.push(i);t.setIndex(n),a=t.getIndex()}var o=a.count-2,c=[];if(r===e.TriangleFanDrawMode)for(i=1;i<=o;i++)c.push(a.getX(0)),c.push(a.getX(i)),c.push(a.getX(i+1));else for(i=0;i<o;i++)i%2==0?(c.push(a.getX(i)),c.push(a.getX(i+1)),c.push(a.getX(i+2))):(c.push(a.getX(i+2)),c.push(a.getX(i+1)),c.push(a.getX(i)));c.length/3!==o&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var l=t.clone();return l.setIndex(c),l}return j.prototype.setExtensions=function(e){this.extensions=e},j.prototype.setPlugins=function(e){this.plugins=e},j.prototype.parse=function(e,t){var r=this,a=this.json,n=this.extensions;this.cache.removeAll(),this._invokeAll((function(e){return e._markDefs&&e._markDefs()})),Promise.all(this._invokeAll((function(e){return e.beforeRoot&&e.beforeRoot()}))).then((function(){return Promise.all([r.getDependencies("scene"),r.getDependencies("animation"),r.getDependencies("camera")])})).then((function(t){var s={scene:t[0][a.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:a.asset,parser:r,userData:{}};P(n,s,a),H(s,a),Promise.all(r._invokeAll((function(e){return e.afterRoot&&e.afterRoot(s)}))).then((function(){e(s)}))})).catch(t)},j.prototype._markDefs=function(){for(var e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[],a=0,n=t.length;a<n;a++)for(var s=t[a].joints,i=0,o=s.length;i<o;i++)e[s[i]].isBone=!0;for(var c=0,l=e.length;c<l;c++){var u=e[c];void 0!==u.mesh&&(this._addNodeRef(this.meshCache,u.mesh),void 0!==u.skin&&(r[u.mesh].isSkinnedMesh=!0)),void 0!==u.camera&&this._addNodeRef(this.cameraCache,u.camera)}},j.prototype._addNodeRef=function(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)},j.prototype._getNodeRef=function(e,t,r){if(e.refs[t]<=1)return r;var a=r.clone();return a.name+="_instance_"+e.uses[t]++,a},j.prototype._invokeOne=function(e){var t=Object.values(this.plugins);t.push(this);for(var r=0;r<t.length;r++){var a=e(t[r]);if(a)return a}},j.prototype._invokeAll=function(e){var t=Object.values(this.plugins);t.unshift(this);for(var r=[],a=0;a<t.length;a++){var n=e(t[a]);n&&r.push(n)}return r},j.prototype.getDependency=function(e,t){var r=e+":"+t,a=this.cache.get(r);if(!a){switch(e){case"scene":a=this.loadScene(t);break;case"node":a=this.loadNode(t);break;case"mesh":a=this._invokeOne((function(e){return e.loadMesh&&e.loadMesh(t)}));break;case"accessor":a=this.loadAccessor(t);break;case"bufferView":a=this._invokeOne((function(e){return e.loadBufferView&&e.loadBufferView(t)}));break;case"buffer":a=this.loadBuffer(t);break;case"material":a=this._invokeOne((function(e){return e.loadMaterial&&e.loadMaterial(t)}));break;case"texture":a=this._invokeOne((function(e){return e.loadTexture&&e.loadTexture(t)}));break;case"skin":a=this.loadSkin(t);break;case"animation":a=this.loadAnimation(t);break;case"camera":a=this.loadCamera(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(r,a)}return a},j.prototype.getDependencies=function(e){var t=this.cache.get(e);if(!t){var r=this,a=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(a.map((function(t,a){return r.getDependency(e,a)}))),this.cache.add(e,t)}return t},j.prototype.loadBuffer=function(e){var t=this.json.buffers[e],r=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[a.KHR_BINARY_GLTF].body);var n=this.options;return new Promise((function(e,a){r.load(N(t.uri,n.path),e,void 0,(function(){a(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))},j.prototype.loadBufferView=function(e){var t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){var r=t.byteLength||0,a=t.byteOffset||0;return e.slice(a,a+r)}))},j.prototype.loadAccessor=function(t){var r=this,a=this.json,n=this.json.accessors[t];if(void 0===n.bufferView&&void 0===n.sparse)return Promise.resolve(null);var s=[];return void 0!==n.bufferView?s.push(this.getDependency("bufferView",n.bufferView)):s.push(null),void 0!==n.sparse&&(s.push(this.getDependency("bufferView",n.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",n.sparse.values.bufferView))),Promise.all(s).then((function(t){var s,i,o=t[0],c=k[n.type],l=I[n.componentType],u=l.BYTES_PER_ELEMENT,h=u*c,p=n.byteOffset||0,f=void 0!==n.bufferView?a.bufferViews[n.bufferView].byteStride:void 0,d=!0===n.normalized;if(f&&f!==h){var g=Math.floor(p/f),m="InterleavedBuffer:"+n.bufferView+":"+n.componentType+":"+g+":"+n.count,v=r.cache.get(m);v||(s=new l(o,g*f,n.count*f/u),v=new e.InterleavedBuffer(s,f/u),r.cache.add(m,v)),i=new e.InterleavedBufferAttribute(v,c,p%f/u,d)}else s=null===o?new l(n.count*c):new l(o,p,n.count*c),i=new e.BufferAttribute(s,c,d);if(void 0!==n.sparse){var y=k.SCALAR,A=I[n.sparse.indices.componentType],b=n.sparse.indices.byteOffset||0,B=n.sparse.values.byteOffset||0,C=new A(t[1],b,n.sparse.count*y),x=new l(t[2],B,n.sparse.count*c);null!==o&&(i=new e.BufferAttribute(i.array.slice(),i.itemSize,i.normalized));for(var F=0,w=C.length;F<w;F++){var E=C[F];if(i.setX(E,x[F*c]),c>=2&&i.setY(E,x[F*c+1]),c>=3&&i.setZ(E,x[F*c+2]),c>=4&&i.setW(E,x[F*c+3]),c>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return i}))},j.prototype.loadTexture=function(e){var t=this.json,r=this.options,a=t.textures[e],n=t.images[a.source],s=this.textureLoader;if(n.uri){var i=r.manager.getHandler(n.uri);null!==i&&(s=i)}return this.loadTextureImage(e,n,s)},j.prototype.loadTextureImage=function(t,r,a){var n=this,s=this.json,i=this.options,o=s.textures[t],c=e.$URL||self.webkitURL,l=r.uri,u=!1,h=!0;if("image/jpeg"===r.mimeType&&(h=!1),void 0!==r.bufferView)l=n.getDependency("bufferView",r.bufferView).then((function(t){if("image/png"===r.mimeType){var a=new DataView(t,25,1).getUint8(0,!1);h=6===a||4===a||3===a}u=!0;var n=new e.$Blob([t],{type:r.mimeType});return l=c.createObjectURL(n)}));else if(void 0===r.uri)throw new Error("THREE.GLTFLoader: Image "+t+" is missing URI and bufferView");return Promise.resolve(l).then((function(t){return new Promise((function(r,n){var s=r;!0===a.isImageBitmapLoader&&(s=function(t){r(new e.CanvasTexture(t))}),a.load(N(t,i.path),s,void 0,n)}))})).then((function(r){!0===u&&c.revokeObjectURL(l),r.flipY=!1,o.name&&(r.name=o.name),h||(r.format=e.RGBFormat);var a=(s.samplers||{})[o.sampler]||{};return r.magFilter=M[a.magFilter]||e.LinearFilter,r.minFilter=M[a.minFilter]||e.LinearMipmapLinearFilter,r.wrapS=T[a.wrapS]||e.RepeatWrapping,r.wrapT=T[a.wrapT]||e.RepeatWrapping,n.associations.set(r,{type:"textures",index:t}),r}))},j.prototype.assignTexture=function(e,t,r){var n=this;return this.getDependency("texture",r.index).then((function(s){if(void 0===r.texCoord||0==r.texCoord||"aoMap"===t&&1==r.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+r.texCoord+" for texture "+t+" not yet supported."),n.extensions[a.KHR_TEXTURE_TRANSFORM]){var i=void 0!==r.extensions?r.extensions[a.KHR_TEXTURE_TRANSFORM]:void 0;if(i){var o=n.associations.get(s);s=n.extensions[a.KHR_TEXTURE_TRANSFORM].extendTexture(s,i),n.associations.set(s,o)}}e[t]=s}))},j.prototype.assignFinalMaterial=function(t){var r=t.geometry,a=t.material,n=void 0!==r.attributes.tangent,s=void 0!==r.attributes.color,i=void 0===r.attributes.normal,o=!0===t.isSkinnedMesh,c=Object.keys(r.morphAttributes).length>0,l=c&&void 0!==r.morphAttributes.normal;if(t.isPoints){var u="PointsMaterial:"+a.uuid,h=this.cache.get(u);h||(h=new e.PointsMaterial,e.Material.prototype.copy.call(h,a),h.color.copy(a.color),h.map=a.map,h.sizeAttenuation=!1,this.cache.add(u,h)),a=h}else if(t.isLine){u="LineBasicMaterial:"+a.uuid;var p=this.cache.get(u);p||(p=new e.LineBasicMaterial,e.Material.prototype.copy.call(p,a),p.color.copy(a.color),this.cache.add(u,p)),a=p}if(n||s||i||o||c){u="ClonedMaterial:"+a.uuid+":";a.isGLTFSpecularGlossinessMaterial&&(u+="specular-glossiness:"),o&&(u+="skinning:"),n&&(u+="vertex-tangents:"),s&&(u+="vertex-colors:"),i&&(u+="flat-shading:"),c&&(u+="morph-targets:"),l&&(u+="morph-normals:");var f=this.cache.get(u);f||(f=a.clone(),o&&(f.skinning=!0),s&&(f.vertexColors=!0),i&&(f.flatShading=!0),c&&(f.morphTargets=!0),l&&(f.morphNormals=!0),n&&(f.vertexTangents=!0,f.normalScale&&(f.normalScale.y*=-1),f.clearcoatNormalScale&&(f.clearcoatNormalScale.y*=-1)),this.cache.add(u,f),this.associations.set(f,this.associations.get(a))),a=f}a.aoMap&&void 0===r.attributes.uv2&&void 0!==r.attributes.uv&&r.setAttribute("uv2",r.attributes.uv),t.material=a},j.prototype.getMaterialType=function(){return e.MeshStandardMaterial},j.prototype.loadMaterial=function(t){var r,n=this,s=this.json,i=this.extensions,o=s.materials[t],c={},l=o.extensions||{},u=[];if(l[a.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var h=i[a.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];r=h.getMaterialType(),u.push(h.extendParams(c,o,n))}else if(l[a.KHR_MATERIALS_UNLIT]){var p=i[a.KHR_MATERIALS_UNLIT];r=p.getMaterialType(),u.push(p.extendParams(c,o,n))}else{var f=o.pbrMetallicRoughness||{};if(c.color=new e.Color(1,1,1),c.opacity=1,Array.isArray(f.baseColorFactor)){var d=f.baseColorFactor;c.color.fromArray(d),c.opacity=d[3]}void 0!==f.baseColorTexture&&u.push(n.assignTexture(c,"map",f.baseColorTexture)),c.metalness=void 0!==f.metallicFactor?f.metallicFactor:1,c.roughness=void 0!==f.roughnessFactor?f.roughnessFactor:1,void 0!==f.metallicRoughnessTexture&&(u.push(n.assignTexture(c,"metalnessMap",f.metallicRoughnessTexture)),u.push(n.assignTexture(c,"roughnessMap",f.metallicRoughnessTexture))),r=this._invokeOne((function(e){return e.getMaterialType&&e.getMaterialType(t)})),u.push(Promise.all(this._invokeAll((function(e){return e.extendMaterialParams&&e.extendMaterialParams(t,c)}))))}!0===o.doubleSided&&(c.side=e.DoubleSide);var g=o.alphaMode||O;return g===G?(c.transparent=!0,c.depthWrite=!1):(c.transparent=!1,g===U&&(c.alphaTest=void 0!==o.alphaCutoff?o.alphaCutoff:.5)),void 0!==o.normalTexture&&r!==e.MeshBasicMaterial&&(u.push(n.assignTexture(c,"normalMap",o.normalTexture)),c.normalScale=new e.Vector2(1,-1),void 0!==o.normalTexture.scale&&c.normalScale.set(o.normalTexture.scale,-o.normalTexture.scale)),void 0!==o.occlusionTexture&&r!==e.MeshBasicMaterial&&(u.push(n.assignTexture(c,"aoMap",o.occlusionTexture)),void 0!==o.occlusionTexture.strength&&(c.aoMapIntensity=o.occlusionTexture.strength)),void 0!==o.emissiveFactor&&r!==e.MeshBasicMaterial&&(c.emissive=(new e.Color).fromArray(o.emissiveFactor)),void 0!==o.emissiveTexture&&r!==e.MeshBasicMaterial&&u.push(n.assignTexture(c,"emissiveMap",o.emissiveTexture)),Promise.all(u).then((function(){var s;return s=r===v?i[a.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(c):new r(c),o.name&&(s.name=o.name),s.map&&(s.map.encoding=e.sRGBEncoding),s.emissiveMap&&(s.emissiveMap.encoding=e.sRGBEncoding),H(s,o),n.associations.set(s,{type:"materials",index:t}),o.extensions&&P(i,s,o),s}))},j.prototype.createUniqueName=function(t){for(var r=e.PropertyBinding.sanitizeNodeName(t||""),a=r,n=1;this.nodeNamesUsed[a];++n)a=r+"_"+n;return this.nodeNamesUsed[a]=!0,a},j.prototype.loadGeometries=function(t){var r=this,n=this.extensions,s=this.primitiveCache;function i(e){return n[a.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,r).then((function(t){return V(t,e,r)}))}for(var o,c,l=[],u=0,h=t.length;u<h;u++){var p,f=t[u],d=(c=void 0,(c=(o=f).extensions&&o.extensions[a.KHR_DRACO_MESH_COMPRESSION])?"draco:"+c.bufferView+":"+c.indices+":"+_(c.attributes):o.indices+":"+_(o.attributes)+":"+o.mode),g=s[d];if(g)l.push(g.promise);else p=f.extensions&&f.extensions[a.KHR_DRACO_MESH_COMPRESSION]?i(f):V(new e.BufferGeometry,f,r),s[d]={primitive:f,promise:p},l.push(p)}return Promise.all(l)},j.prototype.loadMesh=function(t){for(var r,a=this,n=this.json,s=this.extensions,i=n.meshes[t],o=i.primitives,c=[],l=0,u=o.length;l<u;l++){var h=void 0===o[l].material?(void 0===(r=this.cache).DefaultMaterial&&(r.DefaultMaterial=new e.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:e.FrontSide})),r.DefaultMaterial):this.getDependency("material",o[l].material);c.push(h)}return c.push(a.loadGeometries(o)),Promise.all(c).then((function(r){for(var n=r.slice(0,r.length-1),c=r[r.length-1],l=[],u=0,h=c.length;u<h;u++){var p,f=c[u],d=o[u],g=n[u];if(d.mode===w||d.mode===E||d.mode===S||void 0===d.mode)!0!==(p=!0===i.isSkinnedMesh?new e.SkinnedMesh(f,g):new e.Mesh(f,g)).isSkinnedMesh||p.geometry.attributes.skinWeight.normalized||p.normalizeSkinWeights(),d.mode===E?p.geometry=X(p.geometry,e.TriangleStripDrawMode):d.mode===S&&(p.geometry=X(p.geometry,e.TriangleFanDrawMode));else if(d.mode===C)p=new e.LineSegments(f,g);else if(d.mode===F)p=new e.Line(f,g);else if(d.mode===x)p=new e.LineLoop(f,g);else{if(d.mode!==B)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+d.mode);p=new e.Points(f,g)}Object.keys(p.geometry.morphAttributes).length>0&&J(p,i),p.name=a.createUniqueName(i.name||"mesh_"+t),H(p,i),d.extensions&&P(s,p,d),a.assignFinalMaterial(p),l.push(p)}if(1===l.length)return l[0];var m=new e.Group;for(u=0,h=l.length;u<h;u++)m.add(l[u]);return m}))},j.prototype.loadCamera=function(t){var r,a=this.json.cameras[t],n=a[a.type];if(n)return"perspective"===a.type?r=new e.PerspectiveCamera(e.MathUtils.radToDeg(n.yfov),n.aspectRatio||1,n.znear||1,n.zfar||2e6):"orthographic"===a.type&&(r=new e.OrthographicCamera(-n.xmag,n.xmag,n.ymag,-n.ymag,n.znear,n.zfar)),a.name&&(r.name=this.createUniqueName(a.name)),H(r,a),Promise.resolve(r);console.warn("THREE.GLTFLoader: Missing camera parameters.")},j.prototype.loadSkin=function(e){var t=this.json.skins[e],r={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(r):this.getDependency("accessor",t.inverseBindMatrices).then((function(e){return r.inverseBindMatrices=e,r}))},j.prototype.loadAnimation=function(t){for(var r=this.json.animations[t],a=[],n=[],s=[],i=[],o=[],c=0,l=r.channels.length;c<l;c++){var u=r.channels[c],h=r.samplers[u.sampler],p=u.target,f=void 0!==p.node?p.node:p.id,d=void 0!==r.parameters?r.parameters[h.input]:h.input,g=void 0!==r.parameters?r.parameters[h.output]:h.output;a.push(this.getDependency("node",f)),n.push(this.getDependency("accessor",d)),s.push(this.getDependency("accessor",g)),i.push(h),o.push(p)}return Promise.all([Promise.all(a),Promise.all(n),Promise.all(s),Promise.all(i),Promise.all(o)]).then((function(a){for(var n=a[0],s=a[1],i=a[2],o=a[3],c=a[4],l=[],u=0,h=n.length;u<h;u++){var p=n[u],f=s[u],d=i[u],g=o[u],m=c[u];if(void 0!==p){var v;switch(p.updateMatrix(),p.matrixAutoUpdate=!0,L[m.path]){case L.weights:v=e.NumberKeyframeTrack;break;case L.rotation:v=e.QuaternionKeyframeTrack;break;case L.position:case L.scale:default:v=e.VectorKeyframeTrack}var y=p.name?p.name:p.uuid,A=void 0!==g.interpolation?D[g.interpolation]:e.InterpolateLinear,B=[];L[m.path]===L.weights?p.traverse((function(e){!0===e.isMesh&&e.morphTargetInfluences&&B.push(e.name?e.name:e.uuid)})):B.push(y);var C=d.array;if(d.normalized){var x;if(C.constructor===Int8Array)x=1/127;else if(C.constructor===Uint8Array)x=1/255;else if(C.constructor==Int16Array)x=1/32767;else{if(C.constructor!==Uint16Array)throw new Error("THREE.GLTFLoader: Unsupported output accessor component type.");x=1/65535}for(var F=new Float32Array(C.length),w=0,E=C.length;w<E;w++)F[w]=C[w]*x;C=F}for(w=0,E=B.length;w<E;w++){var S=new v(B[w]+"."+L[m.path],f.array,C,A);"CUBICSPLINE"===g.interpolation&&(S.createInterpolant=function(e){return new b(this.times,this.values,this.getValueSize()/3,e)},S.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),l.push(S)}}}var I=r.name?r.name:"animation_"+t;return new e.AnimationClip(I,void 0,l)}))},j.prototype.loadNode=function(t){var r,a=this.json,n=this.extensions,s=this,i=a.nodes[t],o=i.name?s.createUniqueName(i.name):"";return(r=[],void 0!==i.mesh&&r.push(s.getDependency("mesh",i.mesh).then((function(e){var t=s._getNodeRef(s.meshCache,i.mesh,e);return void 0!==i.weights&&t.traverse((function(e){if(e.isMesh)for(var t=0,r=i.weights.length;t<r;t++)e.morphTargetInfluences[t]=i.weights[t]})),t}))),void 0!==i.camera&&r.push(s.getDependency("camera",i.camera).then((function(e){return s._getNodeRef(s.cameraCache,i.camera,e)}))),s._invokeAll((function(e){return e.createNodeAttachment&&e.createNodeAttachment(t)})).forEach((function(e){r.push(e)})),Promise.all(r)).then((function(r){var a;if((a=!0===i.isBone?new e.Bone:r.length>1?new e.Group:1===r.length?r[0]:new e.Object3D)!==r[0])for(var c=0,l=r.length;c<l;c++)a.add(r[c]);if(i.name&&(a.userData.name=i.name,a.name=o),H(a,i),i.extensions&&P(n,a,i),void 0!==i.matrix){var u=new e.Matrix4;u.fromArray(i.matrix),a.applyMatrix4(u)}else void 0!==i.translation&&a.position.fromArray(i.translation),void 0!==i.rotation&&a.quaternion.fromArray(i.rotation),void 0!==i.scale&&a.scale.fromArray(i.scale);return s.associations.set(a,{type:"nodes",index:t}),a}))},j.prototype.loadScene=function(){function t(r,a,n,s){var i=n.nodes[r];return s.getDependency("node",r).then((function(t){return void 0===i.skin?t:s.getDependency("skin",i.skin).then((function(e){for(var t=[],a=0,n=(r=e).joints.length;a<n;a++)t.push(s.getDependency("node",r.joints[a]));return Promise.all(t)})).then((function(a){return t.traverse((function(t){if(t.isMesh){for(var n=[],s=[],i=0,o=a.length;i<o;i++){var c=a[i];if(c){n.push(c);var l=new e.Matrix4;void 0!==r.inverseBindMatrices&&l.fromArray(r.inverseBindMatrices.array,16*i),s.push(l)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',r.joints[i])}t.bind(new e.Skeleton(n,s),t.matrixWorld)}})),t}));var r})).then((function(e){a.add(e);var r=[];if(i.children)for(var o=i.children,c=0,l=o.length;c<l;c++){var u=o[c];r.push(t(u,e,n,s))}return Promise.all(r)}))}return function(r){var a=this.json,n=this.extensions,s=this.json.scenes[r],i=new e.Group;s.name&&(i.name=this.createUniqueName(s.name)),H(i,s),s.extensions&&P(n,i,s);for(var o=s.nodes||[],c=[],l=0,u=o.length;l<u;l++)c.push(t(o[l],i,a,this));return Promise.all(c).then((function(){return i}))}}(),t}(),F=function(t,r){var a,n,s,i,o,c;void 0===r&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),r===e.$document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=t,this.domElement=r,this.enabled=!0,this.target=new e.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:e.MOUSE.ROTATE,MIDDLE:e.MOUSE.DOLLY,RIGHT:e.MOUSE.PAN},this.touches={ONE:e.TOUCH.ROTATE,TWO:e.TOUCH.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return m.phi},this.getAzimuthalAngle=function(){return m.theta},this.listenToKeyEvents=function(e){e.addEventListener("keydown",q),this._domElementKeyEvents=e},this.saveState=function(){l.target0.copy(l.target),l.position0.copy(l.object.position),l.zoom0=l.object.zoom},this.reset=function(){l.target.copy(l.target0),l.object.position.copy(l.position0),l.object.zoom=l.zoom0,l.object.updateProjectionMatrix(),l.dispatchEvent(u),l.update(),d=f.NONE},this.update=(a=new e.Vector3,n=(new e.Quaternion).setFromUnitVectors(t.up,new e.Vector3(0,1,0)),s=n.clone().invert(),i=new e.Vector3,o=new e.Quaternion,c=2*Math.PI,function(){var e=l.object.position;a.copy(e).sub(l.target),a.applyQuaternion(n),m.setFromVector3(a),l.autoRotate&&d===f.NONE&&k(2*Math.PI/60/60*l.autoRotateSpeed),l.enableDamping?(m.theta+=v.theta*l.dampingFactor,m.phi+=v.phi*l.dampingFactor):(m.theta+=v.theta,m.phi+=v.phi);var t=l.minAzimuthAngle,r=l.maxAzimuthAngle;return isFinite(t)&&isFinite(r)&&(t<-Math.PI?t+=c:t>Math.PI&&(t-=c),r<-Math.PI?r+=c:r>Math.PI&&(r-=c),m.theta=t<=r?Math.max(t,Math.min(r,m.theta)):m.theta>(t+r)/2?Math.max(t,m.theta):Math.min(r,m.theta)),m.phi=Math.max(l.minPolarAngle,Math.min(l.maxPolarAngle,m.phi)),m.makeSafe(),m.radius*=y,m.radius=Math.max(l.minDistance,Math.min(l.maxDistance,m.radius)),!0===l.enableDamping?l.target.addScaledVector(A,l.dampingFactor):l.target.add(A),a.setFromSpherical(m),a.applyQuaternion(s),e.copy(l.target).add(a),l.object.lookAt(l.target),!0===l.enableDamping?(v.theta*=1-l.dampingFactor,v.phi*=1-l.dampingFactor,A.multiplyScalar(1-l.dampingFactor)):(v.set(0,0,0),A.set(0,0,0)),y=1,!!(b||i.distanceToSquared(l.object.position)>g||8*(1-o.dot(l.object.quaternion))>g)&&(l.dispatchEvent(u),i.copy(l.object.position),o.copy(l.object.quaternion),b=!1,!0)}),this.dispose=function(){l.domElement.removeEventListener("contextmenu",te),l.domElement.removeEventListener("pointerdown",z),l.domElement.removeEventListener("wheel",Q),l.domElement.removeEventListener("touchstart",Z),l.domElement.removeEventListener("touchend",ee),l.domElement.removeEventListener("touchmove",$),l.domElement.ownerDocument.removeEventListener("pointermove",W),l.domElement.ownerDocument.removeEventListener("pointerup",Y),null!==l._domElementKeyEvents&&l._domElementKeyEvents.removeEventListener("keydown",q)};var l=this,u={type:"change"},h={type:"start"},p={type:"end"},f={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},d=f.NONE,g=1e-6,m=new e.Spherical,v=new e.Spherical,y=1,A=new e.Vector3,b=!1,B=new e.Vector2,C=new e.Vector2,x=new e.Vector2,F=new e.Vector2,w=new e.Vector2,E=new e.Vector2,S=new e.Vector2,I=new e.Vector2,M=new e.Vector2;function T(){return Math.pow(.95,l.zoomSpeed)}function k(e){v.theta-=e}function R(e){v.phi-=e}var L,D=(L=new e.Vector3,function(e,t){L.setFromMatrixColumn(t,0),L.multiplyScalar(-e),A.add(L)}),O=function(){var t=new e.Vector3;return function(e,r){!0===l.screenSpacePanning?t.setFromMatrixColumn(r,1):(t.setFromMatrixColumn(r,0),t.crossVectors(l.object.up,t)),t.multiplyScalar(e),A.add(t)}}(),U=function(){var t=new e.Vector3;return function(e,r){var a=l.domElement;if(l.object.isPerspectiveCamera){var n=l.object.position;t.copy(n).sub(l.target);var s=t.length();s*=Math.tan(l.object.fov/2*Math.PI/180),D(2*e*s/a.clientHeight,l.object.matrix),O(2*r*s/a.clientHeight,l.object.matrix)}else l.object.isOrthographicCamera?(D(e*(l.object.right-l.object.left)/l.object.zoom/a.clientWidth,l.object.matrix),O(r*(l.object.top-l.object.bottom)/l.object.zoom/a.clientHeight,l.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),l.enablePan=!1)}}();function G(e){l.object.isPerspectiveCamera?y/=e:l.object.isOrthographicCamera?(l.object.zoom=Math.max(l.minZoom,Math.min(l.maxZoom,l.object.zoom*e)),l.object.updateProjectionMatrix(),b=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),l.enableZoom=!1)}function N(e){l.object.isPerspectiveCamera?y*=e:l.object.isOrthographicCamera?(l.object.zoom=Math.max(l.minZoom,Math.min(l.maxZoom,l.object.zoom/e)),l.object.updateProjectionMatrix(),b=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),l.enableZoom=!1)}function P(e){B.set(e.clientX,e.clientY)}function H(e){F.set(e.clientX,e.clientY)}function J(e){if(1==e.touches.length)B.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),r=.5*(e.touches[0].pageY+e.touches[1].pageY);B.set(t,r)}}function _(e){if(1==e.touches.length)F.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),r=.5*(e.touches[0].pageY+e.touches[1].pageY);F.set(t,r)}}function j(e){var t=e.touches[0].pageX-e.touches[1].pageX,r=e.touches[0].pageY-e.touches[1].pageY,a=Math.sqrt(t*t+r*r);S.set(0,a)}function V(e){if(1==e.touches.length)C.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),r=.5*(e.touches[0].pageY+e.touches[1].pageY);C.set(t,r)}x.subVectors(C,B).multiplyScalar(l.rotateSpeed);var a=l.domElement;k(2*Math.PI*x.x/a.clientHeight),R(2*Math.PI*x.y/a.clientHeight),B.copy(C)}function X(e){if(1==e.touches.length)w.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),r=.5*(e.touches[0].pageY+e.touches[1].pageY);w.set(t,r)}E.subVectors(w,F).multiplyScalar(l.panSpeed),U(E.x,E.y),F.copy(w)}function K(e){var t=e.touches[0].pageX-e.touches[1].pageX,r=e.touches[0].pageY-e.touches[1].pageY,a=Math.sqrt(t*t+r*r);I.set(0,a),M.set(0,Math.pow(I.y/S.y,l.zoomSpeed)),G(M.y),S.copy(I)}function z(t){if(!1!==l.enabled)switch(t.pointerType){case"mouse":case"pen":!function(t){var r;switch(t.preventDefault(),l.domElement.focus?l.domElement.focus():e.$window.focus(),t.button){case 0:r=l.mouseButtons.LEFT;break;case 1:r=l.mouseButtons.MIDDLE;break;case 2:r=l.mouseButtons.RIGHT;break;default:r=-1}switch(r){case e.MOUSE.DOLLY:if(!1===l.enableZoom)return;!function(e){S.set(e.clientX,e.clientY)}(t),d=f.DOLLY;break;case e.MOUSE.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===l.enablePan)return;H(t),d=f.PAN}else{if(!1===l.enableRotate)return;P(t),d=f.ROTATE}break;case e.MOUSE.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===l.enableRotate)return;P(t),d=f.ROTATE}else{if(!1===l.enablePan)return;H(t),d=f.PAN}break;default:d=f.NONE}d!==f.NONE&&(l.domElement.ownerDocument.addEventListener("pointermove",W),l.domElement.ownerDocument.addEventListener("pointerup",Y),l.dispatchEvent(h))}(t)}}function W(e){if(!1!==l.enabled)switch(e.pointerType){case"mouse":case"pen":!function(e){if(!1===l.enabled)return;switch(e.preventDefault(),d){case f.ROTATE:if(!1===l.enableRotate)return;!function(e){C.set(e.clientX,e.clientY),x.subVectors(C,B).multiplyScalar(l.rotateSpeed);var t=l.domElement;k(2*Math.PI*x.x/t.clientHeight),R(2*Math.PI*x.y/t.clientHeight),B.copy(C),l.update()}(e);break;case f.DOLLY:if(!1===l.enableZoom)return;!function(e){I.set(e.clientX,e.clientY),M.subVectors(I,S),M.y>0?G(T()):M.y<0&&N(T()),S.copy(I),l.update()}(e);break;case f.PAN:if(!1===l.enablePan)return;!function(e){w.set(e.clientX,e.clientY),E.subVectors(w,F).multiplyScalar(l.panSpeed),U(E.x,E.y),F.copy(w),l.update()}(e)}}(e)}}function Y(e){switch(e.pointerType){case"mouse":case"pen":!function(e){if(l.domElement.ownerDocument.removeEventListener("pointermove",W),l.domElement.ownerDocument.removeEventListener("pointerup",Y),!1===l.enabled)return;l.dispatchEvent(p),d=f.NONE}()}}function Q(e){!1===l.enabled||!1===l.enableZoom||d!==f.NONE&&d!==f.ROTATE||(e.preventDefault(),l.dispatchEvent(h),function(e){e.deltaY<0?N(T()):e.deltaY>0&&G(T()),l.update()}(e),l.dispatchEvent(p))}function q(e){!1!==l.enabled&&!1!==l.enablePan&&function(e){var t=!1;switch(e.code){case l.keys.UP:U(0,l.keyPanSpeed),t=!0;break;case l.keys.BOTTOM:U(0,-l.keyPanSpeed),t=!0;break;case l.keys.LEFT:U(l.keyPanSpeed,0),t=!0;break;case l.keys.RIGHT:U(-l.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),l.update())}(e)}function Z(t){if(!1!==l.enabled){switch(t.preventDefault(),t.touches.length){case 1:switch(l.touches.ONE){case e.TOUCH.ROTATE:if(!1===l.enableRotate)return;J(t),d=f.TOUCH_ROTATE;break;case e.TOUCH.PAN:if(!1===l.enablePan)return;_(t),d=f.TOUCH_PAN;break;default:d=f.NONE}break;case 2:switch(l.touches.TWO){case e.TOUCH.DOLLY_PAN:if(!1===l.enableZoom&&!1===l.enablePan)return;!function(e){l.enableZoom&&j(e),l.enablePan&&_(e)}(t),d=f.TOUCH_DOLLY_PAN;break;case e.TOUCH.DOLLY_ROTATE:if(!1===l.enableZoom&&!1===l.enableRotate)return;!function(e){l.enableZoom&&j(e),l.enableRotate&&J(e)}(t),d=f.TOUCH_DOLLY_ROTATE;break;default:d=f.NONE}break;default:d=f.NONE}d!==f.NONE&&l.dispatchEvent(h)}}function $(e){if(!1!==l.enabled)switch(e.preventDefault(),d){case f.TOUCH_ROTATE:if(!1===l.enableRotate)return;V(e),l.update();break;case f.TOUCH_PAN:if(!1===l.enablePan)return;X(e),l.update();break;case f.TOUCH_DOLLY_PAN:if(!1===l.enableZoom&&!1===l.enablePan)return;!function(e){l.enableZoom&&K(e),l.enablePan&&X(e)}(e),l.update();break;case f.TOUCH_DOLLY_ROTATE:if(!1===l.enableZoom&&!1===l.enableRotate)return;!function(e){l.enableZoom&&K(e),l.enableRotate&&V(e)}(e),l.update();break;default:d=f.NONE}}function ee(e){!1!==l.enabled&&(l.dispatchEvent(p),d=f.NONE)}function te(e){!1!==l.enabled&&e.preventDefault()}l.domElement.addEventListener("contextmenu",te),l.domElement.addEventListener("pointerdown",z),l.domElement.addEventListener("wheel",Q),l.domElement.addEventListener("touchstart",Z),l.domElement.addEventListener("touchend",ee),l.domElement.addEventListener("touchmove",$),this.update()};(F.prototype=Object.create(e.EventDispatcher.prototype)).constructor=F;var w=function(t,r){F.call(this,t,r),this.screenSpacePanning=!1,this.mouseButtons.LEFT=e.MOUSE.PAN,this.mouseButtons.RIGHT=e.MOUSE.ROTATE,this.touches.ONE=e.TOUCH.PAN,this.touches.TWO=e.TOUCH.DOLLY_ROTATE};function E(e){e.isMesh?(e.geometry&&e.geometry.dispose(),e.material&&Object.keys(e.material).forEach((t=>{const r=e.material[t];r&&r.dispose instanceof Function&&r.dispose()}))):e.isScene&&(e.background&&e.background.dispose&&e.background.dispose(),e.environment&&e.environment.dispose&&e.environment.dispose())}function S(e,t=E){for(var r=e.children.length-1;r>=0;r--){var a=e.children[r];S(a,t),t(a)}t(e)}function I(e){let t,r=e[0],a=1;for(;a<e.length;){const n=e[a],s=e[a+1];if(a+=2,("optionalAccess"===n||"optionalCall"===n)&&null==r)return;"access"===n||"optionalAccess"===n?(t=r,r=s(r)):"call"!==n&&"optionalCall"!==n||(r=s(((...e)=>r.call(t,...e))),t=void 0)}return r}(w.prototype=Object.create(e.EventDispatcher.prototype)).constructor=w;const M="http://www.yanhuangxueyuan.com/threejs/examples";class T{__init(){this._objects=[]}__init2(){this._cameraObjects=[]}constructor(e){T.prototype.__init.call(this),T.prototype.__init2.call(this),this.deps=e}add(e){this._objects.push(e),this.deps.scene.add(e)}addCamera(e){this._cameraObjects.push(e),this.deps.camera.add(e)}addControl(){const{camera:e,renderer:t}=this.deps;this.orbitControl=new F(e,t.domElement),this.orbitControl.enableDamping=!0,this.orbitControl.dampingFactor=.05}reset(t=!0){const{camera:r,scene:a,renderer:n}=this.deps;r.position.set(0,0,0),r.quaternion.set(0,0,0,1),I([a.background,"optionalAccess",e=>e.dispose,"optionalCall",e=>e()]),a.background=null,a.fog=null,a.position.z=-3,n.shadowMap.enabled=!1,n.physicallyCorrectLights=!1,n.outputEncoding=e.sRGBEncoding,S(this.deps.scene),this._objects.forEach((e=>I([e,"access",e=>e.material,"optionalAccess",e=>e.dispose,"optionalCall",e=>e()]))),this._cameraObjects.forEach((e=>I([e,"access",e=>e.material,"optionalAccess",e=>e.dispose,"optionalCall",e=>e()]))),a.remove(...this._objects),r.remove(...this._cameraObjects),this._objects.length=0,this._cameraObjects.length=0,I([this,"access",e=>e.orbitControl,"optionalAccess",e=>e.dispose,"call",e=>e()]),t&&(this.orbitControl=null,this.deps=null)}}for(var k,R=new Uint8Array(123),L=25;L>=0;--L)R[48+L]=52+L,R[65+L]=L,R[97+L]=26+L;function D(e){!function(e,t,r){for(var a,n,s=0,i=t,o=r.length,c=t+(3*o>>2)-("="==r[o-2])-("="==r[o-1]);s<o;s+=4)a=R[r.charCodeAt(s+1)],n=R[r.charCodeAt(s+2)],e[i++]=R[r.charCodeAt(s)]<<2|a>>4,i<c&&(e[i++]=a<<4|n>>2),i<c&&(e[i++]=n<<6|R[r.charCodeAt(s+3)])}(k,1024,"EGQAAA==")}R[43]=62,R[47]=63;var O=new ArrayBuffer(16),U=new Int32Array(O),G=new Float32Array(O);var N=function(e){var t=new ArrayBuffer(65536),r=new Int8Array(t),a=new Int16Array(t),n=new Int32Array(t),s=new Uint8Array(t),i=new Float32Array(t),o=Math.imul,c=Math.fround,l=Math.abs,u=Math.sqrt,h=(e.abort,25616);function p(e,t,a){a|=0;var i=0;if(3&((t|=0)|(e|=0)|0)|0)i=e;else{if(a>>>0>=16){i=e;e:for(;n[i>>2]=0|n[t>>2],n[(i+4|0)>>2]=0|n[(t+4|0)>>2],n[(i+8|0)>>2]=0|n[(t+8|0)>>2],n[(i+12|0)>>2]=0|n[(t+12|0)>>2],i=i+16|0,t=t+16|0,(a=a+-16|0)>>>0>15;);}else i=e;if(!(a>>>0<4))e:for(;n[i>>2]=0|n[t>>2],t=t+4|0,i=i+4|0,(a=a+-4|0)>>>0>3;);}if(a)e:for(;r[i>>0]=0|s[t>>0],i=i+1|0,t=t+1|0,a=a+-1|0;);return 0|e}function f(){return t.byteLength/65536|0}function d(e){e|=0;var c=0|f(),l=c+e|0;if(c<l&&l<65536){var u=new ArrayBuffer(o(l,65536));new Int8Array(u).set(r),r=new Int8Array(u),a=new Int16Array(u),n=new Int32Array(u),s=new Uint8Array(u),i=new Float32Array(u),t=u,k=s}return c}return k=s,D(),{memory:Object.create(Object.prototype,{grow:{value:d},buffer:{get:function(){return t}}}),__wasm_call_ctors:function(){},meshopt_decodeVertexBuffer:function(e,t,a,i,c){e|=0,t|=0,i|=0;var l,u=0,f=0,d=0,g=0,m=0,v=0,y=0,A=0,b=0,B=0,C=0,x=0,F=0,w=0,E=0,S=0,I=0,M=0,T=0,k=0,R=0,L=0,D=0,O=0,U=0,G=0,N=0,P=0,H=0,J=0,_=0,j=0,V=0,X=0,K=0,z=0,W=0,Y=0,Q=0,q=0,Z=0,$=0,ee=0,te=0,re=0,ae=0,ne=0,se=0,ie=0,oe=0,ce=0,le=0,ue=0,he=0,pe=0,fe=0,de=0;h=l=h-8704|0,g=-2;e:if(!(((a|=0)+1|0)>>>0>(c|=0)>>>0)&&(g=-1,160==(0|s[i>>0]))){A=0|p(0|l,0|(F=i+c|0)-a,0|a),M=(g=16368&(8192/(a>>>0)|0)|0)>>>0<256?g:256,c=i+1|0,C=0;t:{r:for(;;){if(C>>>0>=t>>>0)break t;x=(C+M|0)>>>0<t>>>0?M:t-C|0;a:{if(a){T=-16&(g=x+15|0)|0,k=(3+(g>>>4|0)|0)>>>2|0,I=A+256|0,w=0,b=c;n:for(;;){if(!((F-b|0)>>>0>=k>>>0)){c=0;break a}if(c=b+k|0,T){B=0,i=0;s:for(;;){if(!((F-c|0)>>>0>=24)){c=0;break a}g=(A+8448|0)+i|0;i:{o:switch(0|3&((0|s[(b+(i>>>6|0)|0)>>0])>>>(6&B|0)|0)){default:m=g,v=0,n[g>>2]=0,n[(g+4|0)>>2]=v,v=0,n[(m=g+8|0)>>2]=0,n[(m+4|0)>>2]=v;break i;case 1:R=u=(f=0|s[c>>0])>>>6|0,u=3==(0|u),r[g>>0]=(fe=0|s[(c+4|0)>>0],de=R,u?fe:de),u=(c+4|0)+u|0,L=d=3&(f>>>4|0)|0,d=3==(0|d),r[(g+1|0)>>0]=(fe=0|s[u>>0],de=L,d?fe:de),u=u+d|0,D=d=3&(f>>>2|0)|0,d=3==(0|d),r[(g+2|0)>>0]=(fe=0|s[u>>0],de=D,d?fe:de),u=u+d|0,O=f=3&f|0,f=3==(0|f),r[(g+3|0)>>0]=(fe=0|s[u>>0],de=O,f?fe:de),u=u+f|0,U=d=(f=0|s[(c+1|0)>>0])>>>6|0,d=3==(0|d),r[(g+4|0)>>0]=(fe=0|s[u>>0],de=U,d?fe:de),u=u+d|0,G=d=3&(f>>>4|0)|0,d=3==(0|d),r[(g+5|0)>>0]=(fe=0|s[u>>0],de=G,d?fe:de),u=u+d|0,N=d=3&(f>>>2|0)|0,d=3==(0|d),r[(g+6|0)>>0]=(fe=0|s[u>>0],de=N,d?fe:de),u=u+d|0,P=f=3&f|0,f=3==(0|f),r[(g+7|0)>>0]=(fe=0|s[u>>0],de=P,f?fe:de),u=u+f|0,H=d=(f=0|s[(c+2|0)>>0])>>>6|0,d=3==(0|d),r[(g+8|0)>>0]=(fe=0|s[u>>0],de=H,d?fe:de),u=u+d|0,J=d=3&(f>>>4|0)|0,d=3==(0|d),r[(g+9|0)>>0]=(fe=0|s[u>>0],de=J,d?fe:de),u=u+d|0,_=d=3&(f>>>2|0)|0,d=3==(0|d),r[(g+10|0)>>0]=(fe=0|s[u>>0],de=_,d?fe:de),u=u+d|0,j=f=3&f|0,f=3==(0|f),r[(g+11|0)>>0]=(fe=0|s[u>>0],de=j,f?fe:de),f=u+f|0,V=u=(c=0|s[(c+3|0)>>0])>>>6|0,u=3==(0|u),r[(g+12|0)>>0]=(fe=0|s[f>>0],de=V,u?fe:de),f=f+u|0,X=u=3&(c>>>4|0)|0,u=3==(0|u),r[(g+13|0)>>0]=(fe=0|s[f>>0],de=X,u?fe:de),f=f+u|0,K=u=3&(c>>>2|0)|0,u=3==(0|u),r[(g+14|0)>>0]=(fe=0|s[f>>0],de=K,u?fe:de),z=g+15|0,g=f+u|0,W=c=3&c|0,c=3==(0|c),r[z>>0]=(fe=0|s[g>>0],de=W,c?fe:de),c=g+c|0;break i;case 2:Y=u=(f=0|s[c>>0])>>>4|0,u=15==(0|u),r[g>>0]=(fe=0|s[(c+8|0)>>0],de=Y,u?fe:de),u=(c+8|0)+u|0,Q=f=15&f|0,f=15==(0|f),r[(g+1|0)>>0]=(fe=0|s[u>>0],de=Q,f?fe:de),f=u+f|0,q=d=(u=0|s[(c+1|0)>>0])>>>4|0,d=15==(0|d),r[(g+2|0)>>0]=(fe=0|s[f>>0],de=q,d?fe:de),f=f+d|0,Z=u=15&u|0,u=15==(0|u),r[(g+3|0)>>0]=(fe=0|s[f>>0],de=Z,u?fe:de),f=f+u|0,$=d=(u=0|s[(c+2|0)>>0])>>>4|0,d=15==(0|d),r[(g+4|0)>>0]=(fe=0|s[f>>0],de=$,d?fe:de),f=f+d|0,ee=u=15&u|0,u=15==(0|u),r[(g+5|0)>>0]=(fe=0|s[f>>0],de=ee,u?fe:de),f=f+u|0,te=d=(u=0|s[(c+3|0)>>0])>>>4|0,d=15==(0|d),r[(g+6|0)>>0]=(fe=0|s[f>>0],de=te,d?fe:de),f=f+d|0,re=u=15&u|0,u=15==(0|u),r[(g+7|0)>>0]=(fe=0|s[f>>0],de=re,u?fe:de),f=f+u|0,ae=d=(u=0|s[(c+4|0)>>0])>>>4|0,d=15==(0|d),r[(g+8|0)>>0]=(fe=0|s[f>>0],de=ae,d?fe:de),f=f+d|0,ne=u=15&u|0,u=15==(0|u),r[(g+9|0)>>0]=(fe=0|s[f>>0],de=ne,u?fe:de),f=f+u|0,se=d=(u=0|s[(c+5|0)>>0])>>>4|0,d=15==(0|d),r[(g+10|0)>>0]=(fe=0|s[f>>0],de=se,d?fe:de),f=f+d|0,ie=u=15&u|0,u=15==(0|u),r[(g+11|0)>>0]=(fe=0|s[f>>0],de=ie,u?fe:de),f=f+u|0,oe=d=(u=0|s[(c+6|0)>>0])>>>4|0,d=15==(0|d),r[(g+12|0)>>0]=(fe=0|s[f>>0],de=oe,d?fe:de),f=f+d|0,ce=u=15&u|0,u=15==(0|u),r[(g+13|0)>>0]=(fe=0|s[f>>0],de=ce,u?fe:de),f=f+u|0,le=u=(c=0|s[(c+7|0)>>0])>>>4|0,u=15==(0|u),r[(g+14|0)>>0]=(fe=0|s[f>>0],de=le,u?fe:de),ue=g+15|0,g=f+u|0,he=c=15&c|0,c=15==(0|c),r[ue>>0]=(fe=0|s[g>>0],de=he,c?fe:de),c=g+c|0;break i;case 3:break o}v=0|(0|s[c>>0]|(0|s[(c+1|0)>>0])<<8)|((0|s[(c+2|0)>>0])<<16|0|(0|s[(c+3|0)>>0])<<24)|0,m=0|(0|s[(c+4|0)>>0]|(0|s[(c+5|0)>>0])<<8)|((0|s[(c+6|0)>>0])<<16|0|(0|s[(c+7|0)>>0])<<24)|0,pe=v,v=g,E=pe,r[g>>0]=E,r[(g+1|0)>>0]=E>>>8|0,r[(g+2|0)>>0]=E>>>16|0,r[(g+3|0)>>0]=E>>>24|0,r[(g+4|0)>>0]=m,r[(g+5|0)>>0]=m>>>8|0,r[(g+6|0)>>0]=m>>>16|0,r[(g+7|0)>>0]=m>>>24|0,m=0|(0|s[(y=c+8|0)>>0]|(0|s[(y+1|0)>>0])<<8)|((0|s[(y+2|0)>>0])<<16|0|(0|s[(y+3|0)>>0])<<24)|0,v=0|(0|s[(y+4|0)>>0]|(0|s[(y+5|0)>>0])<<8)|((0|s[(y+6|0)>>0])<<16|0|(0|s[(y+7|0)>>0])<<24)|0,S=m,r[(m=g+8|0)>>0]=S,r[(m+1|0)>>0]=S>>>8|0,r[(m+2|0)>>0]=S>>>16|0,r[(m+3|0)>>0]=S>>>24|0,r[(m+4|0)>>0]=v,r[(m+5|0)>>0]=v>>>8|0,r[(m+6|0)>>0]=v>>>16|0,r[(m+7|0)>>0]=v>>>24|0,c=c+16|0}if(B=B+2|0,!((i=i+16|0)>>>0<T>>>0))break s}}if(!c){c=0;break a}if(x){B=0|s[(A+w|0)>>0],g=0,i=I;s:for(;B=(((b=0|s[((A+8448|0)+g|0)>>0])>>>1|0)^(0-(1&b|0)|0)|0)+B|0,r[i>>0]=B,i=i+a|0,(0|(g=g+1|0))!=(0|x););}if(I=I+1|0,b=c,(0|(w=w+1|0))==(0|a))break n}}p(0|e+o(C,a),0|A+256,0|o(x,a)),p(0|A,0|(A+256|0)+o(x+-1|0,a),0|a)}if(C=(c?x:0)+C|0,!c)break r}g=-2;break e}g=(0|F-c)==(0|(a>>>0>32?a:32))?0:-3}return h=l+8704|0,0|g},meshopt_decodeIndexBuffer:function(e,t,i,c,l){e|=0,i|=0,c|=0;var u,p=0,f=0,d=0,g=0,m=0,v=0,y=0,A=0,b=0,B=0,C=0,x=0,F=0,w=0,E=0,S=0,I=0,M=0,T=0;h=u=h-192|0,v=-2;e:if(!(((p=((t|=0)>>>0)/3|0)+17|0)>>>0>(l|=0)>>>0||(v=-1,224!=(0|240&(w=0|s[c>>0]))||(C=15&w|0)>>>0>1))){if(function(e,t,a){t|=0,a|=0;var s=0,i=0;if(3&(e|=0)|0)s=e;else{if(i=o(255&t|0,16843009),a>>>0>=16){s=e;t:for(;n[s>>2]=i,n[(s+12|0)>>2]=i,n[(s+8|0)>>2]=i,n[(s+4|0)>>2]=i,s=s+16|0,(a=a+-16|0)>>>0>15;);}else s=e;if(!(a>>>0<4))t:for(;n[s>>2]=i,s=s+4|0,(a=a+-4|0)>>>0>3;);}if(a)t:for(;r[s>>0]=t,s=s+1|0,a=a+-1|0;);}(0|u+64,255,128),x=-1,n[(y=u+56|0)>>2]=-1,n[(y+4|0)>>2]=x,x=-1,n[(y=u+48|0)>>2]=-1,n[(y+4|0)>>2]=x,x=-1,n[(y=u+40|0)>>2]=-1,n[(y+4|0)>>2]=x,x=-1,n[(y=u+32|0)>>2]=-1,n[(y+4|0)>>2]=x,x=-1,n[(y=u+24|0)>>2]=-1,n[(y+4|0)>>2]=x,x=-1,n[(y=u+16|0)>>2]=-1,n[(y+4|0)>>2]=x,y=u,x=-1,n[(u+8|0)>>2]=-1,n[(u+12|0)>>2]=x,y=u,x=-1,n[u>>2]=-1,n[(u+4|0)>>2]=x,E=(c+l|0)-16|0,f=(w=c+1|0)+p|0,t){I=1==(0|C)?13:15,c=e,C=0,b=0,S=0,l=0,v=0;t:for(;;){if(!(f>>>0<=E>>>0)){v=-2;break e}r:if((p=0|s[w>>0])>>>0>239)p>>>0>253?(p=(m=(g=0|s[f>>0])?C:0)+(A=254==(0|p))|0,B=15&g|0,(F=g>>>4|0)?(d=p,p=0|n[(u+((15&(l-F|0)|0)<<2|0)|0)>>2]):d=p+1|0,B?(C=d,d=0|n[(u+((15&(l-g|0)|0)<<2|0)|0)>>2]):C=d+1|0,A?g=f+1|0:(m=255&(g=0|r[(f+1|0)>>0])|0,(0|g)<=-1?(m=0|((127&(g=0|r[(f+2|0)>>0])|0)<<7|0|127&m),(0|g)<=-1?(m=(127&(g=0|r[(f+3|0)>>0])|0)<<14|0|m|0,(0|g)<=-1?(m=(127&(g=0|r[(f+4|0)>>0])|0)<<21|0|m|0,(0|g)<=-1?(g=f+6|0,m=(0|s[(f+5|0)>>0])<<28|0|m|0):g=f+5|0):g=f+4|0):g=f+3|0):g=f+2|0,m=b=((m>>>1|0)^(0-(1&m|0)|0)|0)+b|0),15==(0|F)?(p=255&(f=0|r[g>>0])|0,(0|f)<=-1?(p=0|((127&(f=0|r[(g+1|0)>>0])|0)<<7|0|127&p),(0|f)<=-1?(p=(127&(f=0|r[(g+2|0)>>0])|0)<<14|0|p|0,(0|f)<=-1?(p=(127&(f=0|r[(g+3|0)>>0])|0)<<21|0|p|0,(0|f)<=-1?(A=g+5|0,p=(0|s[(g+4|0)>>0])<<28|0|p|0):A=g+4|0):A=g+3|0):A=g+2|0):A=g+1|0,p=b=((p>>>1|0)^(0-(1&p|0)|0)|0)+b|0):A=g,15==(0|B)?(d=255&(f=0|r[A>>0])|0,(0|f)<=-1?(d=0|((127&(f=0|r[(A+1|0)>>0])|0)<<7|0|127&d),(0|f)<=-1?(d=(127&(f=0|r[(A+2|0)>>0])|0)<<14|0|d|0,(0|f)<=-1?(d=(127&(f=0|r[(A+3|0)>>0])|0)<<21|0|d|0,(0|f)<=-1?(f=A+5|0,d=(0|s[(A+4|0)>>0])<<28|0|d|0):f=A+4|0):f=A+3|0):f=A+2|0):f=A+1|0,d=b=((d>>>1|0)^(0-(1&d|0)|0)|0)+b|0):f=A,2!=(0|i)?(n[c>>2]=m,n[(c+8|0)>>2]=d,n[(c+4|0)>>2]=p):(a[e>>1]=m,a[(e+4|0)>>1]=d,a[(e+2|0)>>1]=p),n[(g=(u+64|0)+(v<<3|0)|0)>>2]=p,n[(g+4|0)>>2]=m,n[(u+(l<<2|0)|0)>>2]=m,n[(g=(u+64|0)+((15&(v+1|0)|0)<<3|0)|0)>>2]=d,n[(g+4|0)>>2]=p,n[(u+((15&(l=l+1|0)|0)<<2|0)|0)>>2]=p,n[(p=(u+64|0)+((15&(v+2|0)|0)<<3|0)|0)>>2]=m,n[(p+4|0)>>2]=d,n[(u+((15&(l=l+(!F|15==(0|F)|0)|0)|0)<<2|0)|0)>>2]=d,l=l+(!B|15==(0|B)|0)|0,v=v+3|0):(d=0|s[(E+(15&p|0)|0)>>0],B=C+1|0,M=0|n[(u+((15&(l-(m=d>>>4|0)|0)|0)<<2|0)|0)>>2],T=B,p=m?M:T,B=B+(F=!m)|0,m=15&d|0,M=0|n[(u+((15&(l-d|0)|0)<<2|0)|0)>>2],T=B,d=m?M:T,m=!m,2!=(0|i)?(n[c>>2]=C,n[(c+8|0)>>2]=d,n[(c+4|0)>>2]=p):(a[e>>1]=C,a[(e+4|0)>>1]=d,a[(e+2|0)>>1]=p),n[(u+(l<<2|0)|0)>>2]=C,n[(g=(u+64|0)+(v<<3|0)|0)>>2]=p,n[(g+4|0)>>2]=C,n[(u+((15&(l=l+1|0)|0)<<2|0)|0)>>2]=p,n[(g=(u+64|0)+((15&(v+1|0)|0)<<3|0)|0)>>2]=d,n[(g+4|0)>>2]=p,n[(u+((l=15&(l+F|0)|0)<<2|0)|0)>>2]=d,n[(p=(u+64|0)+((v=15&(v+2|0)|0)<<3|0)|0)>>2]=C,n[(p+4|0)>>2]=d,v=v+1|0,l=l+m|0,C=B+m|0);else{if(m=0|n[((d=(u+64|0)+((15&((-1^(p>>>4|0)|0)+v|0)|0)<<3|0)|0)+4|0)>>2],B=0|n[d>>2],!((d=15&p|0)>>>0>=I>>>0)){M=0|n[(u+((15&((-1^p|0)+l|0)|0)<<2|0)|0)>>2],T=C,p=d?M:T,d=!d,2!=(0|i)?(n[c>>2]=B,n[(c+8|0)>>2]=p,n[(c+4|0)>>2]=m):(a[e>>1]=B,a[(e+4|0)>>1]=p,a[(e+2|0)>>1]=m),C=C+d|0,n[(F=(u+64|0)+(v<<3|0)|0)>>2]=p,n[(F+4|0)>>2]=m,n[(u+(l<<2|0)|0)>>2]=p,n[(m=(u+64|0)+((v=15&(v+1|0)|0)<<3|0)|0)>>2]=B,n[(m+4|0)>>2]=p,l=l+d|0,v=v+1|0;break r}15==(0|d)?(p=255&(d=0|r[f>>0])|0,(0|d)<=-1?(p=0|((127&(d=0|r[(f+1|0)>>0])|0)<<7|0|127&p),(0|d)<=-1?(p=(127&(d=0|r[(f+2|0)>>0])|0)<<14|0|p|0,(0|d)<=-1?(p=(127&(d=0|r[(f+3|0)>>0])|0)<<21|0|p|0,(0|d)<=-1?(p=(0|s[(f+4|0)>>0])<<28|0|p|0,f=f+5|0):f=f+4|0):f=f+3|0):f=f+2|0):f=f+1|0,b=((p>>>1|0)^(0-(1&p|0)|0)|0)+b|0):b=1+((b+d|0)+(-4^d|0)|0)|0,2!=(0|i)?(n[c>>2]=B,n[(c+8|0)>>2]=b,n[(c+4|0)>>2]=m):(a[e>>1]=B,a[(e+4|0)>>1]=b,a[(e+2|0)>>1]=m),n[(p=(u+64|0)+(v<<3|0)|0)>>2]=b,n[(p+4|0)>>2]=m,n[(u+(l<<2|0)|0)>>2]=b,n[(p=(u+64|0)+((v=15&(v+1|0)|0)<<3|0)|0)>>2]=B,n[(p+4|0)>>2]=b,l=l+1|0,v=v+1|0}if(w=w+1|0,e=e+6|0,c=c+12|0,v=15&v|0,l=15&l|0,!((S=S+3|0)>>>0<t>>>0))break t}}v=(0|f)==(0|E)?0:-3}return h=u+192|0,0|v},meshopt_decodeIndexSequence:function(e,t,i,o,c){e|=0,i|=0,o|=0;var l,u=0;if(l=h-16|0,u=-2,!(((t|=0)+5|0)>>>0>(c|=0)>>>0)&&(u=-1,208==(0|254&(0|s[o>>0])))){n[(l+8|0)>>2]=0,n[(l+12|0)>>2]=0,u=o+1|0,o=(o+c|0)-4|0;e:if(t){if(2!=(0|i))for(;;){if(!(u>>>0<o>>>0))return-2;if(c=255&(i=0|r[u>>0])|0,(0|i)<=-1?(c=0|((127&(i=0|r[(u+1|0)>>0])|0)<<7|0|127&c),(0|i)<=-1?(c=(127&(i=0|r[(u+2|0)>>0])|0)<<14|0|c|0,(0|i)<=-1?(c=(127&(i=0|r[(u+3|0)>>0])|0)<<21|0|c|0,(0|i)<=-1?(c=(0|s[(u+4|0)>>0])<<28|0|c|0,u=u+5|0):u=u+4|0):u=u+3|0):u=u+2|0):u=u+1|0,c=((c>>>2|0)^(0-(1&(c>>>1|0)|0)|0)|0)+(0|n[(i=0|(l+8|0|(1&c|0)<<2))>>2])|0,n[i>>2]=c,n[e>>2]=c,e=e+4|0,!(t=t+-1|0))break e}t:for(;;){if(!(u>>>0<o>>>0))return-2;if(c=255&(i=0|r[u>>0])|0,(0|i)<=-1?(c=0|((127&(i=0|r[(u+1|0)>>0])|0)<<7|0|127&c),(0|i)<=-1?(c=(127&(i=0|r[(u+2|0)>>0])|0)<<14|0|c|0,(0|i)<=-1?(c=(127&(i=0|r[(u+3|0)>>0])|0)<<21|0|c|0,(0|i)<=-1?(c=(0|s[(u+4|0)>>0])<<28|0|c|0,u=u+5|0):u=u+4|0):u=u+3|0):u=u+2|0):u=u+1|0,i=((c>>>2|0)^(0-(1&(c>>>1|0)|0)|0)|0)+(0|n[(c=0|(l+8|0|(1&c|0)<<2))>>2])|0,a[e>>1]=i,n[c>>2]=i,e=e+2|0,!(t=t+-1|0))break t}}u=(0|u)==(0|o)?0:-3}return 0|u},meshopt_decodeFilterOct:function(e,t,n){e|=0,t|=0,n|=0;var s=c(0),i=c(0),o=c(0),h=c(0),p=0,f=0,d=0,g=0,m=c(0);e:{if(4==(0|n)){if(!t)break e;for(;;)if(n=e+2|0,p=0|r[e>>0],o=c(0|p),d=0|r[(f=e+1|0)>>0],h=c(0|d),i=(g=(s=c(c(c(0|r[n>>0])-c(l(o)))-c(l(h))))>=c(0))?c(0):s,m=c(-i),o=c(((0|p)>-1?i:m)+o),i=c(((0|d)>-1?i:m)+h),h=c(c(127)/c(u(c(c(s*s)+c(c(o*o)+c(i*i)))))),s=c(c(g?.5:-.5)+c(s*h)),p=c(l(s))<c(2147483648)?~~s:-2147483648,r[n>>0]=p,s=c((i>=c(0)?c(.5):c(-.5))+c(i*h)),n=c(l(s))<c(2147483648)?~~s:-2147483648,r[f>>0]=n,s=c((o>=c(0)?c(.5):c(-.5))+c(o*h)),n=c(l(s))<c(2147483648)?~~s:-2147483648,r[e>>0]=n,e=e+4|0,!(t=t+-1|0))break e}if(t)t:for(;n=e+4|0,p=0|a[e>>1],o=c(0|p),d=0|a[(f=e+2|0)>>1],h=c(0|d),i=(g=(s=c(c(c(0|a[n>>1])-c(l(o)))-c(l(h))))>=c(0))?c(0):s,m=c(-i),o=c(((0|p)>-1?i:m)+o),i=c(((0|d)>-1?i:m)+h),h=c(c(32767)/c(u(c(c(s*s)+c(c(o*o)+c(i*i)))))),s=c(c(g?.5:-.5)+c(s*h)),p=c(l(s))<c(2147483648)?~~s:-2147483648,a[n>>1]=p,s=c((i>=c(0)?c(.5):c(-.5))+c(i*h)),n=c(l(s))<c(2147483648)?~~s:-2147483648,a[f>>1]=n,s=c((o>=c(0)?c(.5):c(-.5))+c(o*h)),n=c(l(s))<c(2147483648)?~~s:-2147483648,a[e>>1]=n,e=e+8|0,t=t+-1|0;);}},meshopt_decodeFilterQuat:function(e,t,r){e|=0,t|=0;var n=c(0),s=c(0),i=c(0),o=0,h=0,p=0,f=0,d=c(0),g=0,m=0;if(t){h=0,p=e;e:for(;f=0|a[(p+6|0)>>1],s=c(c(.7071067690849304)/c(3|f)),n=c(s*c(0|a[p>>1])),i=c(c(n*c(32767))+(n>=c(0)?c(.5):c(-.5))),m=c(l(i))<c(2147483648)?~~i:-2147483648,o=0|a[(p+4|0)>>1],g=0|a[(p+2|0)>>1],a[(e+((3&(f+1|0)|0|h|0)<<1|0)|0)>>1]=m,i=c(s*c(0|g)),d=c(c(i*c(32767))+(i>=c(0)?c(.5):c(-.5))),g=c(l(d))<c(2147483648)?~~d:-2147483648,a[(e+((3&(f+2|0)|0|h|0)<<1|0)|0)>>1]=g,s=c(s*c(0|o)),d=c(c(s*c(32767))+(s>=c(0)?c(.5):c(-.5))),o=c(l(d))<c(2147483648)?~~d:-2147483648,a[(e+((3&(f+-1|0)|0|h|0)<<1|0)|0)>>1]=o,n=c(c(c(c(1)-c(n*n))-c(i*i))-c(s*s)),n=c(c(c(u(n>=c(0)?n:c(0)))*c(32767))+c(.5)),o=c(l(n))<c(2147483648)?~~n:-2147483648,a[(e+((3&f|0|h|0)<<1|0)|0)>>1]=o,p=p+8|0,h=h+4|0,t=t+-1|0;);}},meshopt_decodeFilterExp:function(e,t,r){if(e|=0,t=o((r|=0)>>>2|0,t|=0))e:for(;r=0|n[e>>2],i[e>>2]=c(c(0|(r<<8|0)>>8)*(a=1065353216+((r>>24|0)<<23|0)|0,U[2]=a,G[2])),e=e+4|0,t=t+-1|0;);var a},sbrk:function(e){e|=0;var t,r=0,a=0;return e=(t=0|n[256])+(-4&(e+3|0)|0)|0,n[256]=e,(e>>>0<=(r=f()<<16|0)>>>0||(a=-1,-1!=(0|d(0|(65535+(e-r|0)|0)>>>16))))&&(a=t),0|a}}}({abort:function(){throw new Error("abort")}}),P=N.memory,H=N.__wasm_call_ctors,J=N.meshopt_decodeVertexBuffer,_=N.meshopt_decodeIndexBuffer,j=N.meshopt_decodeIndexSequence,V=N.meshopt_decodeFilterOct,X=N.meshopt_decodeFilterQuat,K=N.meshopt_decodeFilterExp,z=N.sbrk,W=Object.freeze({__proto__:null,memory:P,__wasm_call_ctors:H,meshopt_decodeVertexBuffer:J,meshopt_decodeIndexBuffer:_,meshopt_decodeIndexSequence:j,meshopt_decodeFilterOct:V,meshopt_decodeFilterQuat:X,meshopt_decodeFilterExp:K,sbrk:z}),Y=function(){var e={exports:W};function t(t,r,a,n,s,i){var o=e.exports.sbrk,c=a+3&-4,l=o(c*n),u=o(s.length),h=new Uint8Array(e.exports.memory.buffer);h.set(s,u);var p=t(l,a,n,u,s.length);if(0==p&&i&&i(l,c,n),r.set(h.subarray(l,l+a*n)),o(l-o(0)),0!=p)throw new Error("Malformed buffer data: "+p)}var r={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},a={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:Promise.resolve(),supported:!0,decodeVertexBuffer:function(a,n,s,i,o){t(e.exports.meshopt_decodeVertexBuffer,a,n,s,i,e.exports[r[o]])},decodeIndexBuffer:function(r,a,n,s){t(e.exports.meshopt_decodeIndexBuffer,r,a,n,s)},decodeIndexSequence:function(r,a,n,s){t(e.exports.meshopt_decodeIndexSequence,r,a,n,s)},decodeGltfBuffer:function(n,s,i,o,c,l){t(e.exports[a[c]],n,s,i,o,e.exports[r[l]])}}}();var Q=function(){var e=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),t=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if("object"!=typeof WebAssembly)return{supported:!1};var r,a="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB";WebAssembly.validate(e)&&(a="B9h9z9tFBBBFiI9gBB9gLaaaaaFa9gEaaaB9gFaFaEMcBBFBFFGGGEILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBOn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBNI9z9iqlBVc+N9IcIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMk8lLbaE97F9+FaL978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAeDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAeDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBReCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBH8ZCFD9tA8ZAPD9OD9hD9RH8ZDQBTFtGmEYIPLdKeOnHpAIAQJDBIBHyCFD9tAyAPD9OD9hD9RHyAIASJDBIBH8cCFD9tA8cAPD9OD9hD9RH8cDQBTFtGmEYIPLdKeOnH8dDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAeD9uHeDyBjGBAEAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeApA8dDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNiV8ZcpMyS8cQ8df8eb8fHdAyA8cDQNiV8ZcpMyS8cQ8df8eb8fH8ZDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/dLEK97FaF97GXGXAGCI9HQBAF9FQFCBRGEXABABDBBBHECiD+rFCiD+sFD/6FHIAECND+rFCiD+sFD/6FAID/gFAECTD+rFCiD+sFD/6FHLD/gFD/kFD/lFHKCBDtD+2FHOAICUUUU94DtHND9OD9RD/kFHI9DBB/+hDYAIAID/mFAKAKD/mFALAOALAND9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHLD/mF9DBBX9LDYHOD/kFCgFDtD9OAECUUU94DtD9OD9QAIALD/mFAOD/kFCND+rFCU/+EDtD9OD9QAKALD/mFAOD/kFCTD+rFCUU/8ODtD9OD9QDMBBABCTJRBAGCIJHGAF9JQBSGMMAF9FQBCBRGEXABCTJHVAVDBBBHECBDtHOCUU98D8cFCUU98D8cEHND9OABDBBBHKAEDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAKAEDQBFGENVcMTtmYi8ZpyHECTD+sFD/6FHID/gFAECTD+rFCTD+sFD/6FHLD/gFD/kFD/lFHE9DB/+g6DYALAEAOD+2FHOALCUUUU94DtHcD9OD9RD/kFHLALD/mFAEAED/mFAIAOAIAcD9OD9RD/kFHEAED/mFD/kFD/kFD/jFD/nFHID/mF9DBBX9LDYHOD/kFCTD+rFALAID/mFAOD/kFCggEDtD9OD9QHLAEAID/mFAOD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHEDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAKAND9OALAEDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM/hEIGaF97FaL978jUUUUBCTlREGXAF9FQBCBRIEXAEABDBBBHLABCTJHKDBBBHODQILKOSQfbPden8c8d8e8fHNCTD+sFHVCID+rFDMIBAB9DBBU8/DY9D/zI818/DYAVCEDtD9QD/6FD/nFHVALAODQBFGENVcMTtmYi8ZpyHLCTD+rFCTD+sFD/6FD/mFHOAOD/mFAVALCTD+sFD/6FD/mFHcAcD/mFAVANCTD+rFCTD+sFD/6FD/mFHNAND/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHVD/mF9DBBX9LDYHLD/kFCggEDtHMD9OAcAVD/mFALD/kFCTD+rFD9QHcANAVD/mFALD/kFCTD+rFAOAVD/mFALD/kFAMD9OD9QHVDQBFTtGEmYILPdKOenHLD8dBAEDBIBDyB+t+J83EBABCNJALD8dFAEDBIBDyF+t+J83EBAKAcAVDQNVi8ZcMpySQ8c8dfb8e8fHVD8dBAEDBIBDyG+t+J83EBABCiJAVD8dFAEDBIBDyE+t+J83EBABCAJRBAICIJHIAF9JQBMMM9jFF97GXAGCGrAF9sHG9FQBCBRFEXABABDBBBHECND+rFCND+sFD/6FAECiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBABCTJRBAFCIJHFAG9JQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",console.log("Warning: meshopt_decoder is using experimental SIMD support"));var n=WebAssembly.instantiate(function(e){for(var r=new Uint8Array(e.length),a=0;a<e.length;++a){var n=e.charCodeAt(a);r[a]=n>96?n-71:n>64?n-65:n>47?n+4:n>46?63:62}var s=0;for(a=0;a<e.length;++a)r[s++]=r[a]<60?t[r[a]]:64*(r[a]-60)+r[++a];return r.buffer.slice(0,s)}(a),{}).then((function(e){(r=e.instance).exports.__wasm_call_ctors()}));function s(e,t,a,n,s,i){var o=r.exports.sbrk,c=a+3&-4,l=o(c*n),u=o(s.length),h=new Uint8Array(r.exports.memory.buffer);h.set(s,u);var p=e(l,a,n,u,s.length);if(0==p&&i&&i(l,c,n),t.set(h.subarray(l,l+a*n)),o(l-o(0)),0!=p)throw new Error("Malformed buffer data: "+p)}var i={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},o={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:n,supported:!0,decodeVertexBuffer:function(e,t,a,n,o){s(r.exports.meshopt_decodeVertexBuffer,e,t,a,n,r.exports[i[o]])},decodeIndexBuffer:function(e,t,a,n){s(r.exports.meshopt_decodeIndexBuffer,e,t,a,n)},decodeIndexSequence:function(e,t,a,n){s(r.exports.meshopt_decodeIndexSequence,e,t,a,n)},decodeGltfBuffer:function(e,t,a,n,c,l){s(r.exports[o[c]],e,t,a,n,r.exports[i[l]])}}}();var q=function(t){e.DataTextureLoader.call(this,t)};q.prototype=Object.assign(Object.create(e.DataTextureLoader.prototype),{constructor:q,load:function(t,r,a,n){return e.DataTextureLoader.prototype.load.call(this,t,(function(t,a){t.flipY=!0,t.generateMipmaps=!0,t.unpackAlignment=4,t.magFilter=e.LinearFilter,t.minFilter=e.LinearMipmapLinearFilter,r&&r(t,a)}),a,n)},parse:function(e){var t=0,r=1,a=2,n=3,s=9,i=10,o=11,c=48,l=4,u=0,h=1,p=2,f=3;e.length<19&&console.error("THREE.TGALoader: Not enough data to contain header.");var d=new Uint8Array(e),g=0,m={id_length:d[g++],colormap_type:d[g++],image_type:d[g++],colormap_index:d[g++]|d[g++]<<8,colormap_length:d[g++]|d[g++]<<8,colormap_size:d[g++],origin:[d[g++]|d[g++]<<8,d[g++]|d[g++]<<8],width:d[g++]|d[g++]<<8,height:d[g++]|d[g++]<<8,pixel_size:d[g++],flags:d[g++]};!function(e){switch(e.image_type){case r:case s:(e.colormap_length>256||24!==e.colormap_size||1!==e.colormap_type)&&console.error("THREE.TGALoader: Invalid type colormap data for indexed type.");break;case a:case n:case i:case o:e.colormap_type&&console.error("THREE.TGALoader: Invalid type colormap data for colormap type.");break;case t:console.error("THREE.TGALoader: No data.");default:console.error('THREE.TGALoader: Invalid type "%s".',e.image_type)}(e.width<=0||e.height<=0)&&console.error("THREE.TGALoader: Invalid image size."),8!==e.pixel_size&&16!==e.pixel_size&&24!==e.pixel_size&&32!==e.pixel_size&&console.error('THREE.TGALoader: Invalid pixel size "%s".',e.pixel_size)}(m),m.id_length+g>e.length&&console.error("THREE.TGALoader: No data."),g+=m.id_length;var v=!1,y=!1,A=!1;switch(m.image_type){case s:v=!0,y=!0;break;case r:y=!0;break;case i:v=!0;break;case a:break;case o:v=!0,A=!0;break;case n:A=!0}var b=new Uint8Array(m.width*m.height*4),B=function(e,t,r,a,n){var s,i,o,c;if(i=r.pixel_size>>3,o=r.width*r.height*i,t&&(c=n.subarray(a,a+=r.colormap_length*(r.colormap_size>>3))),e){var l,u,h;s=new Uint8Array(o);for(var p=0,f=new Uint8Array(i);p<o;)if(u=1+(127&(l=n[a++])),128&l){for(h=0;h<i;++h)f[h]=n[a++];for(h=0;h<u;++h)s.set(f,p+h*i);p+=i*u}else{for(u*=i,h=0;h<u;++h)s[p+h]=n[a++];p+=u}}else s=n.subarray(a,a+=t?r.width*r.height:o);return{pixel_data:s,palettes:c}}(v,y,m,g,d);return function(e,t,r,a,n){var s,i,o,d,g,v;switch((m.flags&c)>>l){default:case p:s=0,o=1,g=t,i=0,d=1,v=r;break;case u:s=0,o=1,g=t,i=r-1,d=-1,v=-1;break;case f:s=t-1,o=-1,g=-1,i=0,d=1,v=r;break;case h:s=t-1,o=-1,g=-1,i=r-1,d=-1,v=-1}if(A)switch(m.pixel_size){case 8:!function(e,t,r,a,n,s,i,o){var c,l,u,h=0,p=m.width;for(u=t;u!==a;u+=r)for(l=n;l!==i;l+=s,h++)c=o[h],e[4*(l+p*u)+0]=c,e[4*(l+p*u)+1]=c,e[4*(l+p*u)+2]=c,e[4*(l+p*u)+3]=255}(e,i,d,v,s,o,g,a);break;case 16:!function(e,t,r,a,n,s,i,o){var c,l,u=0,h=m.width;for(l=t;l!==a;l+=r)for(c=n;c!==i;c+=s,u+=2)e[4*(c+h*l)+0]=o[u+0],e[4*(c+h*l)+1]=o[u+0],e[4*(c+h*l)+2]=o[u+0],e[4*(c+h*l)+3]=o[u+1]}(e,i,d,v,s,o,g,a);break;default:console.error("THREE.TGALoader: Format not supported.")}else switch(m.pixel_size){case 8:!function(e,t,r,a,n,s,i,o,c){var l,u,h,p=c,f=0,d=m.width;for(h=t;h!==a;h+=r)for(u=n;u!==i;u+=s,f++)l=o[f],e[4*(u+d*h)+3]=255,e[4*(u+d*h)+2]=p[3*l+0],e[4*(u+d*h)+1]=p[3*l+1],e[4*(u+d*h)+0]=p[3*l+2]}(e,i,d,v,s,o,g,a,n);break;case 16:!function(e,t,r,a,n,s,i,o){var c,l,u,h=0,p=m.width;for(u=t;u!==a;u+=r)for(l=n;l!==i;l+=s,h+=2)c=o[h+0]+(o[h+1]<<8),e[4*(l+p*u)+0]=(31744&c)>>7,e[4*(l+p*u)+1]=(992&c)>>2,e[4*(l+p*u)+2]=(31&c)>>3,e[4*(l+p*u)+3]=32768&c?0:255}(e,i,d,v,s,o,g,a);break;case 24:!function(e,t,r,a,n,s,i,o){var c,l,u=0,h=m.width;for(l=t;l!==a;l+=r)for(c=n;c!==i;c+=s,u+=3)e[4*(c+h*l)+3]=255,e[4*(c+h*l)+2]=o[u+0],e[4*(c+h*l)+1]=o[u+1],e[4*(c+h*l)+0]=o[u+2]}(e,i,d,v,s,o,g,a);break;case 32:!function(e,t,r,a,n,s,i,o){var c,l,u=0,h=m.width;for(l=t;l!==a;l+=r)for(c=n;c!==i;c+=s,u+=4)e[4*(c+h*l)+2]=o[u+0],e[4*(c+h*l)+1]=o[u+1],e[4*(c+h*l)+0]=o[u+2],e[4*(c+h*l)+3]=o[u+3]}(e,i,d,v,s,o,g,a);break;default:console.error("THREE.TGALoader: Format not supported.")}}(b,m.width,m.height,B.pixel_data,B.palettes),{data:b,width:m.width,height:m.height}}});var Z=function(t){e.Loader.call(this,t)};Z.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:Z,load:function(t,r,a,n){var s=this,i=new e.FileLoader(s.manager);i.setPath(s.path),i.setRequestHeader(s.requestHeader),i.setWithCredentials(s.withCredentials),i.load(t,(function(e){try{r(s.parse(e))}catch(e){n?n(e):console.error(e),s.manager.itemError(t)}}),a,n)},parse:function(t){function r(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function a(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}function n(e,t){var r=parseInt(g[m].substr(e,t));if(r){var a=function(e,t){return"s"+Math.min(e,t)+"e"+Math.max(e,t)}(A,r);void 0===f[a]&&(p.push([A-1,r-1,1]),f[a]=p.length-1)}}for(var s,i,o,c,l,u={h:[255,255,255],he:[217,255,255],li:[204,128,255],be:[194,255,0],b:[255,181,181],c:[144,144,144],n:[48,80,248],o:[255,13,13],f:[144,224,80],ne:[179,227,245],na:[171,92,242],mg:[138,255,0],al:[191,166,166],si:[240,200,160],p:[255,128,0],s:[255,255,48],cl:[31,240,31],ar:[128,209,227],k:[143,64,212],ca:[61,255,0],sc:[230,230,230],ti:[191,194,199],v:[166,166,171],cr:[138,153,199],mn:[156,122,199],fe:[224,102,51],co:[240,144,160],ni:[80,208,80],cu:[200,128,51],zn:[125,128,176],ga:[194,143,143],ge:[102,143,143],as:[189,128,227],se:[255,161,0],br:[166,41,41],kr:[92,184,209],rb:[112,46,176],sr:[0,255,0],y:[148,255,255],zr:[148,224,224],nb:[115,194,201],mo:[84,181,181],tc:[59,158,158],ru:[36,143,143],rh:[10,125,140],pd:[0,105,133],ag:[192,192,192],cd:[255,217,143],in:[166,117,115],sn:[102,128,128],sb:[158,99,181],te:[212,122,0],i:[148,0,148],xe:[66,158,176],cs:[87,23,143],ba:[0,201,0],la:[112,212,255],ce:[255,255,199],pr:[217,255,199],nd:[199,255,199],pm:[163,255,199],sm:[143,255,199],eu:[97,255,199],gd:[69,255,199],tb:[48,255,199],dy:[31,255,199],ho:[0,255,156],er:[0,230,117],tm:[0,212,82],yb:[0,191,56],lu:[0,171,36],hf:[77,194,255],ta:[77,166,255],w:[33,148,214],re:[38,125,171],os:[38,102,150],ir:[23,84,135],pt:[208,208,224],au:[255,209,35],hg:[184,184,208],tl:[166,84,77],pb:[87,89,97],bi:[158,79,181],po:[171,92,0],at:[117,79,69],rn:[66,130,150],fr:[66,0,102],ra:[0,125,0],ac:[112,171,250],th:[0,186,255],pa:[0,161,255],u:[0,143,255],np:[0,128,255],pu:[0,107,255],am:[84,92,242],cm:[120,92,227],bk:[138,79,227],cf:[161,54,212],es:[179,31,212],fm:[179,31,186],md:[179,13,166],no:[189,13,135],lr:[199,0,102],rf:[204,0,89],db:[209,0,79],sg:[217,0,69],bh:[224,0,56],hs:[230,0,46],mt:[235,0,38],ds:[235,0,38],rg:[235,0,38],cn:[235,0,38],uut:[235,0,38],uuq:[235,0,38],uup:[235,0,38],uuh:[235,0,38],uus:[235,0,38],uuo:[235,0,38]},h=[],p=[],f={},d={},g=t.split("\n"),m=0,v=g.length;m<v;m++)if("ATOM"===g[m].substr(0,4)||"HETATM"===g[m].substr(0,6)){s=parseFloat(g[m].substr(30,7)),i=parseFloat(g[m].substr(38,7)),o=parseFloat(g[m].substr(46,7)),c=parseInt(g[m].substr(6,5))-1,""===(l=r(g[m].substr(76,2)).toLowerCase())&&(l=r(g[m].substr(12,2)).toLowerCase());var y=[s,i,o,u[l],a(l)];h.push(y),d[c]=y}else if("CONECT"===g[m].substr(0,6)){var A=parseInt(g[m].substr(6,5));n(11,5),n(16,5),n(21,5),n(26,5)}return function(){var t,r,a,n,s,i={geometryAtoms:new e.BufferGeometry,geometryBonds:new e.BufferGeometry,json:{atoms:h}},o=i.geometryAtoms,c=i.geometryBonds,l=[],u=[],f=[];for(t=0,r=h.length;t<r;t++){var g=h[t];a=g[0],n=g[1],s=g[2],l.push(a,n,s);var m=g[3][0]/255,v=g[3][1]/255,y=g[3][2]/255;u.push(m,v,y)}for(t=0,r=p.length;t<r;t++){var A=p[t],b=A[0],B=A[1],C=d[b],x=d[B];a=C[0],n=C[1],s=C[2],f.push(a,n,s),a=x[0],n=x[1],s=x[2],f.push(a,n,s)}return o.setAttribute("position",new e.Float32BufferAttribute(l,3)),o.setAttribute("color",new e.Float32BufferAttribute(u,3)),c.setAttribute("position",new e.Float32BufferAttribute(f,3)),i}()}});var $,ee,te=function(t){e.Loader.call(this,t)};te.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:te,load:function(t,r,a,n){var s=this,i=new e.FileLoader(this.manager);i.setPath(this.path),i.setResponseType("arraybuffer"),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials),i.load(t,(function(e){try{r(s.parse(e))}catch(e){n?n(e):console.error(e),s.manager.itemError(t)}}),a,n)},parse:function(t){function r(e,t,r){for(var a=0,n=e.length;a<n;a++)if(e[a]!==t.getUint8(r+a,!1))return!1;return!0}var a,n=function(e){if("string"==typeof e){for(var t=new Uint8Array(e.length),r=0;r<e.length;r++)t[r]=255&e.charCodeAt(r);return t.buffer||t}return e}(t);return function(e){var t;if(50,84+50*(t=new DataView(e)).getUint32(80,!0)===t.byteLength)return!0;for(var a=[115,111,108,105,100],n=0;n<5;n++)if(r(a,t,n))return!1;return!0}(n)?function(t){for(var r,a,n,s,i,o,c,l,u=new DataView(t),h=u.getUint32(80,!0),p=!1,f=0;f<70;f++)1129270351==u.getUint32(f,!1)&&82==u.getUint8(f+4)&&61==u.getUint8(f+5)&&(p=!0,s=new Float32Array(3*h*3),i=u.getUint8(f+6)/255,o=u.getUint8(f+7)/255,c=u.getUint8(f+8)/255,l=u.getUint8(f+9)/255);for(var d=new e.BufferGeometry,g=new Float32Array(3*h*3),m=new Float32Array(3*h*3),v=0;v<h;v++){var y=84+50*v,A=u.getFloat32(y,!0),b=u.getFloat32(y+4,!0),B=u.getFloat32(y+8,!0);if(p){var C=u.getUint16(y+48,!0);0==(32768&C)?(r=(31&C)/31,a=(C>>5&31)/31,n=(C>>10&31)/31):(r=i,a=o,n=c)}for(var x=1;x<=3;x++){var F=y+12*x,w=3*v*3+3*(x-1);g[w]=u.getFloat32(F,!0),g[w+1]=u.getFloat32(F+4,!0),g[w+2]=u.getFloat32(F+8,!0),m[w]=A,m[w+1]=b,m[w+2]=B,p&&(s[w]=r,s[w+1]=a,s[w+2]=n)}}return d.setAttribute("position",new e.BufferAttribute(g,3)),d.setAttribute("normal",new e.BufferAttribute(m,3)),p&&(d.setAttribute("color",new e.BufferAttribute(s,3)),d.hasColors=!0,d.alpha=l),d}(n):function(t){for(var r,a=new e.BufferGeometry,n=/solid([\s\S]*?)endsolid/g,s=/facet([\s\S]*?)endfacet/g,i=0,o=/[\s]+([+-]?(?:\d*)(?:\.\d*)?(?:[eE][+-]?\d+)?)/.source,c=new RegExp("vertex"+o+o+o,"g"),l=new RegExp("normal"+o+o+o,"g"),u=[],h=[],p=new e.Vector3,f=0,d=0,g=0;null!==(r=n.exec(t));){d=g;for(var m=r[0];null!==(r=s.exec(m));){for(var v=0,y=0,A=r[0];null!==(r=l.exec(A));)p.x=parseFloat(r[1]),p.y=parseFloat(r[2]),p.z=parseFloat(r[3]),y++;for(;null!==(r=c.exec(A));)u.push(parseFloat(r[1]),parseFloat(r[2]),parseFloat(r[3])),h.push(p.x,p.y,p.z),v++,g++;1!==y&&console.error("THREE.STLLoader: Something isn't right with the normal of face number "+i),3!==v&&console.error("THREE.STLLoader: Something isn't right with the vertices of face number "+i),i++}var b=d,B=g-d;a.addGroup(b,B,f),f++}return a.setAttribute("position",new e.Float32BufferAttribute(u,3)),a.setAttribute("normal",new e.Float32BufferAttribute(h,3)),a}("string"!=typeof(a=t)?e.LoaderUtils.decodeText(new Uint8Array(a)):a)}});
/*! https://mths.be/codepointat v0.2.0 by @mathias */
String.prototype.codePointAt||($=function(){try{var e={},t=Object.defineProperty,r=t(e,e,e)&&t}catch(e){}return r}(),ee=function(e){if(null==this)throw TypeError();var t=String(this),r=t.length,a=e?Number(e):0;if(a!=a&&(a=0),!(a<0||a>=r)){var n,s=t.charCodeAt(a);return s>=55296&&s<=56319&&r>a+1&&(n=t.charCodeAt(a+1))>=56320&&n<=57343?1024*(s-55296)+n-56320+65536:s}},$?$(String.prototype,"codePointAt",{value:ee,configurable:!0,writable:!0}):String.prototype.codePointAt=ee);function re(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}function ae(e,t){this.source=e,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=t,this.destLen=0,this.ltree=new re,this.dtree=new re}var ne=new re,se=new re,ie=new Uint8Array(30),oe=new Uint16Array(30),ce=new Uint8Array(30),le=new Uint16Array(30),ue=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),he=new re,pe=new Uint8Array(320);function fe(e,t,r,a){var n,s;for(n=0;n<r;++n)e[n]=0;for(n=0;n<30-r;++n)e[n+r]=n/r|0;for(s=a,n=0;n<30;++n)t[n]=s,s+=1<<e[n]}var de=new Uint16Array(16);function ge(e,t,r,a){var n,s;for(n=0;n<16;++n)e.table[n]=0;for(n=0;n<a;++n)e.table[t[r+n]]++;for(e.table[0]=0,s=0,n=0;n<16;++n)de[n]=s,s+=e.table[n];for(n=0;n<a;++n)t[r+n]&&(e.trans[de[t[r+n]]++]=n)}function me(e){e.bitcount--||(e.tag=e.source[e.sourceIndex++],e.bitcount=7);var t=1&e.tag;return e.tag>>>=1,t}function ve(e,t,r){if(!t)return r;for(;e.bitcount<24;)e.tag|=e.source[e.sourceIndex++]<<e.bitcount,e.bitcount+=8;var a=e.tag&65535>>>16-t;return e.tag>>>=t,e.bitcount-=t,a+r}function ye(e,t){for(;e.bitcount<24;)e.tag|=e.source[e.sourceIndex++]<<e.bitcount,e.bitcount+=8;var r=0,a=0,n=0,s=e.tag;do{a=2*a+(1&s),s>>>=1,++n,r+=t.table[n],a-=t.table[n]}while(a>=0);return e.tag=s,e.bitcount-=n,t.trans[r+a]}function Ae(e,t,r){var a,n,s,i,o,c;for(a=ve(e,5,257),n=ve(e,5,1),s=ve(e,4,4),i=0;i<19;++i)pe[i]=0;for(i=0;i<s;++i){var l=ve(e,3,0);pe[ue[i]]=l}for(ge(he,pe,0,19),o=0;o<a+n;){var u=ye(e,he);switch(u){case 16:var h=pe[o-1];for(c=ve(e,2,3);c;--c)pe[o++]=h;break;case 17:for(c=ve(e,3,3);c;--c)pe[o++]=0;break;case 18:for(c=ve(e,7,11);c;--c)pe[o++]=0;break;default:pe[o++]=u}}ge(t,pe,0,a),ge(r,pe,a,n)}function be(e,t,r){for(;;){var a,n,s,i,o=ye(e,t);if(256===o)return 0;if(o<256)e.dest[e.destLen++]=o;else for(a=ve(e,ie[o-=257],oe[o]),n=ye(e,r),i=s=e.destLen-ve(e,ce[n],le[n]);i<s+a;++i)e.dest[e.destLen++]=e.dest[i]}}function Be(e){for(var t,r;e.bitcount>8;)e.sourceIndex--,e.bitcount-=8;if((t=256*(t=e.source[e.sourceIndex+1])+e.source[e.sourceIndex])!==(65535&~(256*e.source[e.sourceIndex+3]+e.source[e.sourceIndex+2])))return-3;for(e.sourceIndex+=4,r=t;r;--r)e.dest[e.destLen++]=e.source[e.sourceIndex++];return e.bitcount=0,0}!function(e,t){var r;for(r=0;r<7;++r)e.table[r]=0;for(e.table[7]=24,e.table[8]=152,e.table[9]=112,r=0;r<24;++r)e.trans[r]=256+r;for(r=0;r<144;++r)e.trans[24+r]=r;for(r=0;r<8;++r)e.trans[168+r]=280+r;for(r=0;r<112;++r)e.trans[176+r]=144+r;for(r=0;r<5;++r)t.table[r]=0;for(t.table[5]=32,r=0;r<32;++r)t.trans[r]=r}(ne,se),fe(ie,oe,4,3),fe(ce,le,2,1),ie[28]=0,oe[28]=258;var Ce=function(e,t){var r,a,n=new ae(e,t);do{switch(r=me(n),ve(n,2,0)){case 0:a=Be(n);break;case 1:a=be(n,ne,se);break;case 2:Ae(n,n.ltree,n.dtree),a=be(n,n.ltree,n.dtree);break;default:a=-3}if(0!==a)throw new Error("Data error")}while(!r);return n.destLen<n.dest.length?"function"==typeof n.dest.slice?n.dest.slice(0,n.destLen):n.dest.subarray(0,n.destLen):n.dest};function xe(e,t,r,a,n){return Math.pow(1-n,3)*e+3*Math.pow(1-n,2)*n*t+3*(1-n)*Math.pow(n,2)*r+Math.pow(n,3)*a}function Fe(){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN}function we(){this.commands=[],this.fill="black",this.stroke=null,this.strokeWidth=1}function Ee(e){throw new Error(e)}function Se(e,t){e||Ee(t)}Fe.prototype.isEmpty=function(){return isNaN(this.x1)||isNaN(this.y1)||isNaN(this.x2)||isNaN(this.y2)},Fe.prototype.addPoint=function(e,t){"number"==typeof e&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=e,this.x2=e),e<this.x1&&(this.x1=e),e>this.x2&&(this.x2=e)),"number"==typeof t&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=t,this.y2=t),t<this.y1&&(this.y1=t),t>this.y2&&(this.y2=t))},Fe.prototype.addX=function(e){this.addPoint(e,null)},Fe.prototype.addY=function(e){this.addPoint(null,e)},Fe.prototype.addBezier=function(e,t,r,a,n,s,i,o){var c=[e,t],l=[r,a],u=[n,s],h=[i,o];this.addPoint(e,t),this.addPoint(i,o);for(var p=0;p<=1;p++){var f=6*c[p]-12*l[p]+6*u[p],d=-3*c[p]+9*l[p]-9*u[p]+3*h[p],g=3*l[p]-3*c[p];if(0!==d){var m=Math.pow(f,2)-4*g*d;if(!(m<0)){var v=(-f+Math.sqrt(m))/(2*d);0<v&&v<1&&(0===p&&this.addX(xe(c[p],l[p],u[p],h[p],v)),1===p&&this.addY(xe(c[p],l[p],u[p],h[p],v)));var y=(-f-Math.sqrt(m))/(2*d);0<y&&y<1&&(0===p&&this.addX(xe(c[p],l[p],u[p],h[p],y)),1===p&&this.addY(xe(c[p],l[p],u[p],h[p],y)))}}else{if(0===f)continue;var A=-g/f;0<A&&A<1&&(0===p&&this.addX(xe(c[p],l[p],u[p],h[p],A)),1===p&&this.addY(xe(c[p],l[p],u[p],h[p],A)))}}},Fe.prototype.addQuad=function(e,t,r,a,n,s){var i=e+2/3*(r-e),o=t+2/3*(a-t),c=i+1/3*(n-e),l=o+1/3*(s-t);this.addBezier(e,t,i,o,c,l,n,s)},we.prototype.moveTo=function(e,t){this.commands.push({type:"M",x:e,y:t})},we.prototype.lineTo=function(e,t){this.commands.push({type:"L",x:e,y:t})},we.prototype.curveTo=we.prototype.bezierCurveTo=function(e,t,r,a,n,s){this.commands.push({type:"C",x1:e,y1:t,x2:r,y2:a,x:n,y:s})},we.prototype.quadTo=we.prototype.quadraticCurveTo=function(e,t,r,a){this.commands.push({type:"Q",x1:e,y1:t,x:r,y:a})},we.prototype.close=we.prototype.closePath=function(){this.commands.push({type:"Z"})},we.prototype.extend=function(e){if(e.commands)e=e.commands;else if(e instanceof Fe){var t=e;return this.moveTo(t.x1,t.y1),this.lineTo(t.x2,t.y1),this.lineTo(t.x2,t.y2),this.lineTo(t.x1,t.y2),void this.close()}Array.prototype.push.apply(this.commands,e)},we.prototype.getBoundingBox=function(){for(var e=new Fe,t=0,r=0,a=0,n=0,s=0;s<this.commands.length;s++){var i=this.commands[s];switch(i.type){case"M":e.addPoint(i.x,i.y),t=a=i.x,r=n=i.y;break;case"L":e.addPoint(i.x,i.y),a=i.x,n=i.y;break;case"Q":e.addQuad(a,n,i.x1,i.y1,i.x,i.y),a=i.x,n=i.y;break;case"C":e.addBezier(a,n,i.x1,i.y1,i.x2,i.y2,i.x,i.y),a=i.x,n=i.y;break;case"Z":a=t,n=r;break;default:throw new Error("Unexpected path command "+i.type)}}return e.isEmpty()&&e.addPoint(0,0),e},we.prototype.draw=function(e){e.beginPath();for(var t=0;t<this.commands.length;t+=1){var r=this.commands[t];"M"===r.type?e.moveTo(r.x,r.y):"L"===r.type?e.lineTo(r.x,r.y):"C"===r.type?e.bezierCurveTo(r.x1,r.y1,r.x2,r.y2,r.x,r.y):"Q"===r.type?e.quadraticCurveTo(r.x1,r.y1,r.x,r.y):"Z"===r.type&&e.closePath()}this.fill&&(e.fillStyle=this.fill,e.fill()),this.stroke&&(e.strokeStyle=this.stroke,e.lineWidth=this.strokeWidth,e.stroke())},we.prototype.toPathData=function(e){function t(t){return Math.round(t)===t?""+Math.round(t):t.toFixed(e)}function r(){for(var e=arguments,r="",a=0;a<arguments.length;a+=1){var n=e[a];n>=0&&a>0&&(r+=" "),r+=t(n)}return r}e=void 0!==e?e:2;for(var a="",n=0;n<this.commands.length;n+=1){var s=this.commands[n];"M"===s.type?a+="M"+r(s.x,s.y):"L"===s.type?a+="L"+r(s.x,s.y):"C"===s.type?a+="C"+r(s.x1,s.y1,s.x2,s.y2,s.x,s.y):"Q"===s.type?a+="Q"+r(s.x1,s.y1,s.x,s.y):"Z"===s.type&&(a+="Z")}return a},we.prototype.toSVG=function(e){var t='<path d="';return t+=this.toPathData(e),t+='"',this.fill&&"black"!==this.fill&&(null===this.fill?t+=' fill="none"':t+=' fill="'+this.fill+'"'),this.stroke&&(t+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"'),t+="/>"},we.prototype.toDOMElement=function(e){var t=this.toPathData(e),r=document.createElementNS("http://www.w3.org/2000/svg","path");return r.setAttribute("d",t),r};var Ie={fail:Ee,argument:Se,assert:Se},Me={},Te={},ke={};function Re(e){return function(){return e}}Te.BYTE=function(e){return Ie.argument(e>=0&&e<=255,"Byte value should be between 0 and 255."),[e]},ke.BYTE=Re(1),Te.CHAR=function(e){return[e.charCodeAt(0)]},ke.CHAR=Re(1),Te.CHARARRAY=function(e){for(var t=[],r=0;r<e.length;r+=1)t[r]=e.charCodeAt(r);return t},ke.CHARARRAY=function(e){return e.length},Te.USHORT=function(e){return[e>>8&255,255&e]},ke.USHORT=Re(2),Te.SHORT=function(e){return e>=32768&&(e=-(65536-e)),[e>>8&255,255&e]},ke.SHORT=Re(2),Te.UINT24=function(e){return[e>>16&255,e>>8&255,255&e]},ke.UINT24=Re(3),Te.ULONG=function(e){return[e>>24&255,e>>16&255,e>>8&255,255&e]},ke.ULONG=Re(4),Te.LONG=function(e){return e>=2147483648&&(e=-(4294967296-e)),[e>>24&255,e>>16&255,e>>8&255,255&e]},ke.LONG=Re(4),Te.FIXED=Te.ULONG,ke.FIXED=ke.ULONG,Te.FWORD=Te.SHORT,ke.FWORD=ke.SHORT,Te.UFWORD=Te.USHORT,ke.UFWORD=ke.USHORT,Te.LONGDATETIME=function(e){return[0,0,0,0,e>>24&255,e>>16&255,e>>8&255,255&e]},ke.LONGDATETIME=Re(8),Te.TAG=function(e){return Ie.argument(4===e.length,"Tag should be exactly 4 ASCII characters."),[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]},ke.TAG=Re(4),Te.Card8=Te.BYTE,ke.Card8=ke.BYTE,Te.Card16=Te.USHORT,ke.Card16=ke.USHORT,Te.OffSize=Te.BYTE,ke.OffSize=ke.BYTE,Te.SID=Te.USHORT,ke.SID=ke.USHORT,Te.NUMBER=function(e){return e>=-107&&e<=107?[e+139]:e>=108&&e<=1131?[247+((e-=108)>>8),255&e]:e>=-1131&&e<=-108?[251+((e=-e-108)>>8),255&e]:e>=-32768&&e<=32767?Te.NUMBER16(e):Te.NUMBER32(e)},ke.NUMBER=function(e){return Te.NUMBER(e).length},Te.NUMBER16=function(e){return[28,e>>8&255,255&e]},ke.NUMBER16=Re(3),Te.NUMBER32=function(e){return[29,e>>24&255,e>>16&255,e>>8&255,255&e]},ke.NUMBER32=Re(5),Te.REAL=function(e){var t=e.toString(),r=/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/.exec(t);if(r){var a=parseFloat("1e"+((r[2]?+r[2]:0)+r[1].length));t=(Math.round(e*a)/a).toString()}for(var n="",s=0,i=t.length;s<i;s+=1){var o=t[s];n+="e"===o?"-"===t[++s]?"c":"b":"."===o?"a":"-"===o?"e":o}for(var c=[30],l=0,u=(n+=1&n.length?"f":"ff").length;l<u;l+=2)c.push(parseInt(n.substr(l,2),16));return c},ke.REAL=function(e){return Te.REAL(e).length},Te.NAME=Te.CHARARRAY,ke.NAME=ke.CHARARRAY,Te.STRING=Te.CHARARRAY,ke.STRING=ke.CHARARRAY,Me.UTF8=function(e,t,r){for(var a=[],n=r,s=0;s<n;s++,t+=1)a[s]=e.getUint8(t);return String.fromCharCode.apply(null,a)},Me.UTF16=function(e,t,r){for(var a=[],n=r/2,s=0;s<n;s++,t+=2)a[s]=e.getUint16(t);return String.fromCharCode.apply(null,a)},Te.UTF16=function(e){for(var t=[],r=0;r<e.length;r+=1){var a=e.charCodeAt(r);t[t.length]=a>>8&255,t[t.length]=255&a}return t},ke.UTF16=function(e){return 2*e.length};var Le={"x-mac-croatian":"","x-mac-cyrillic":"","x-mac-gaelic":"","x-mac-greek":"","x-mac-icelandic":"","x-mac-inuit":"","x-mac-ce":"",macintosh:"","x-mac-romanian":"","x-mac-turkish":""};Me.MACSTRING=function(e,t,r,a){var n=Le[a];if(void 0!==n){for(var s="",i=0;i<r;i++){var o=e.getUint8(t+i);s+=o<=127?String.fromCharCode(o):n[127&o]}return s}};var De,Oe="function"==typeof WeakMap&&new WeakMap;function Ue(e){return e>=-128&&e<=127}function Ge(e,t,r){for(var a=0,n=e.length;t<n&&a<64&&0===e[t];)++t,++a;return r.push(128|a-1),t}function Ne(e,t,r){for(var a=0,n=e.length,s=t;s<n&&a<64;){var i=e[s];if(!Ue(i))break;if(0===i&&s+1<n&&0===e[s+1])break;++s,++a}r.push(a-1);for(var o=t;o<s;++o)r.push(e[o]+256&255);return s}function Pe(e,t,r){for(var a=0,n=e.length,s=t;s<n&&a<64;){var i=e[s];if(0===i)break;if(Ue(i)&&s+1<n&&Ue(e[s+1]))break;++s,++a}r.push(64|a-1);for(var o=t;o<s;++o){var c=e[o];r.push(c+65536>>8&255,c+256&255)}return s}Te.MACSTRING=function(e,t){var r=function(e){if(!De)for(var t in De={},Le)De[t]=new String(t);var r=De[e];if(void 0!==r){if(Oe){var a=Oe.get(r);if(void 0!==a)return a}var n=Le[e];if(void 0!==n){for(var s={},i=0;i<n.length;i++)s[n.charCodeAt(i)]=i+128;return Oe&&Oe.set(r,s),s}}}(t);if(void 0!==r){for(var a=[],n=0;n<e.length;n++){var s=e.charCodeAt(n);if(s>=128&&void 0===(s=r[s]))return;a[n]=s}return a}},ke.MACSTRING=function(e,t){var r=Te.MACSTRING(e,t);return void 0!==r?r.length:0},Te.VARDELTAS=function(e){for(var t=0,r=[];t<e.length;){var a=e[t];t=0===a?Ge(e,t,r):a>=-128&&a<=127?Ne(e,t,r):Pe(e,t,r)}return r},Te.INDEX=function(e){for(var t=1,r=[t],a=[],n=0;n<e.length;n+=1){var s=Te.OBJECT(e[n]);Array.prototype.push.apply(a,s),t+=s.length,r.push(t)}if(0===a.length)return[0,0];for(var i=[],o=1+Math.floor(Math.log(t)/Math.log(2))/8|0,c=[void 0,Te.BYTE,Te.USHORT,Te.UINT24,Te.ULONG][o],l=0;l<r.length;l+=1){var u=c(r[l]);Array.prototype.push.apply(i,u)}return Array.prototype.concat(Te.Card16(e.length),Te.OffSize(o),i,a)},ke.INDEX=function(e){return Te.INDEX(e).length},Te.DICT=function(e){for(var t=[],r=Object.keys(e),a=r.length,n=0;n<a;n+=1){var s=parseInt(r[n],0),i=e[s];t=(t=t.concat(Te.OPERAND(i.value,i.type))).concat(Te.OPERATOR(s))}return t},ke.DICT=function(e){return Te.DICT(e).length},Te.OPERATOR=function(e){return e<1200?[e]:[12,e-1200]},Te.OPERAND=function(e,t){var r=[];if(Array.isArray(t))for(var a=0;a<t.length;a+=1)Ie.argument(e.length===t.length,"Not enough arguments given for type"+t),r=r.concat(Te.OPERAND(e[a],t[a]));else if("SID"===t)r=r.concat(Te.NUMBER(e));else if("offset"===t)r=r.concat(Te.NUMBER32(e));else if("number"===t)r=r.concat(Te.NUMBER(e));else{if("real"!==t)throw new Error("Unknown operand type "+t);r=r.concat(Te.REAL(e))}return r},Te.OP=Te.BYTE,ke.OP=ke.BYTE;var He="function"==typeof WeakMap&&new WeakMap;function Je(e,t,r){for(var a=0;a<t.length;a+=1){var n=t[a];this[n.name]=n.value}if(this.tableName=e,this.fields=t,r)for(var s=Object.keys(r),i=0;i<s.length;i+=1){var o=s[i],c=r[o];void 0!==this[o]&&(this[o]=c)}}function _e(e,t,r){void 0===r&&(r=t.length);var a=new Array(t.length+1);a[0]={name:e+"Count",type:"USHORT",value:r};for(var n=0;n<t.length;n++)a[n+1]={name:e+n,type:"USHORT",value:t[n]};return a}function je(e,t,r){var a=t.length,n=new Array(a+1);n[0]={name:e+"Count",type:"USHORT",value:a};for(var s=0;s<a;s++)n[s+1]={name:e+s,type:"TABLE",value:r(t[s],s)};return n}function Ve(e,t,r){var a=t.length,n=[];n[0]={name:e+"Count",type:"USHORT",value:a};for(var s=0;s<a;s++)n=n.concat(r(t[s],s));return n}function Xe(e){1===e.format?Je.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:1}].concat(_e("glyph",e.glyphs))):Ie.assert(!1,"Can't create coverage table format 2 yet.")}function Ke(e){Je.call(this,"scriptListTable",Ve("scriptRecord",e,(function(e,t){var r=e.script,a=r.defaultLangSys;return Ie.assert(!!a,"Unable to write GSUB: script "+e.tag+" has no default language system."),[{name:"scriptTag"+t,type:"TAG",value:e.tag},{name:"script"+t,type:"TABLE",value:new Je("scriptTable",[{name:"defaultLangSys",type:"TABLE",value:new Je("defaultLangSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:a.reqFeatureIndex}].concat(_e("featureIndex",a.featureIndexes)))}].concat(Ve("langSys",r.langSysRecords,(function(e,t){var r=e.langSys;return[{name:"langSysTag"+t,type:"TAG",value:e.tag},{name:"langSys"+t,type:"TABLE",value:new Je("langSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:r.reqFeatureIndex}].concat(_e("featureIndex",r.featureIndexes)))}]}))))}]})))}function ze(e){Je.call(this,"featureListTable",Ve("featureRecord",e,(function(e,t){var r=e.feature;return[{name:"featureTag"+t,type:"TAG",value:e.tag},{name:"feature"+t,type:"TABLE",value:new Je("featureTable",[{name:"featureParams",type:"USHORT",value:r.featureParams}].concat(_e("lookupListIndex",r.lookupListIndexes)))}]})))}function We(e,t){Je.call(this,"lookupListTable",je("lookup",e,(function(e){var r=t[e.lookupType];return Ie.assert(!!r,"Unable to write GSUB lookup type "+e.lookupType+" tables."),new Je("lookupTable",[{name:"lookupType",type:"USHORT",value:e.lookupType},{name:"lookupFlag",type:"USHORT",value:e.lookupFlag}].concat(je("subtable",e.subtables,r)))})))}Te.CHARSTRING=function(e){if(He){var t=He.get(e);if(void 0!==t)return t}for(var r=[],a=e.length,n=0;n<a;n+=1){var s=e[n];r=r.concat(Te[s.type](s.value))}return He&&He.set(e,r),r},ke.CHARSTRING=function(e){return Te.CHARSTRING(e).length},Te.OBJECT=function(e){var t=Te[e.type];return Ie.argument(void 0!==t,"No encoding function for type "+e.type),t(e.value)},ke.OBJECT=function(e){var t=ke[e.type];return Ie.argument(void 0!==t,"No sizeOf function for type "+e.type),t(e.value)},Te.TABLE=function(e){for(var t=[],r=e.fields.length,a=[],n=[],s=0;s<r;s+=1){var i=e.fields[s],o=Te[i.type];Ie.argument(void 0!==o,"No encoding function for field type "+i.type+" ("+i.name+")");var c=e[i.name];void 0===c&&(c=i.value);var l=o(c);"TABLE"===i.type?(n.push(t.length),t=t.concat([0,0]),a.push(l)):t=t.concat(l)}for(var u=0;u<a.length;u+=1){var h=n[u],p=t.length;Ie.argument(p<65536,"Table "+e.tableName+" too big."),t[h]=p>>8,t[h+1]=255&p,t=t.concat(a[u])}return t},ke.TABLE=function(e){for(var t=0,r=e.fields.length,a=0;a<r;a+=1){var n=e.fields[a],s=ke[n.type];Ie.argument(void 0!==s,"No sizeOf function for field type "+n.type+" ("+n.name+")");var i=e[n.name];void 0===i&&(i=n.value),t+=s(i),"TABLE"===n.type&&(t+=2)}return t},Te.RECORD=Te.TABLE,ke.RECORD=ke.TABLE,Te.LITERAL=function(e){return e},ke.LITERAL=function(e){return e.length},Je.prototype.encode=function(){return Te.TABLE(this)},Je.prototype.sizeOf=function(){return ke.TABLE(this)},Xe.prototype=Object.create(Je.prototype),Xe.prototype.constructor=Xe,Ke.prototype=Object.create(Je.prototype),Ke.prototype.constructor=Ke,ze.prototype=Object.create(Je.prototype),ze.prototype.constructor=ze,We.prototype=Object.create(Je.prototype),We.prototype.constructor=We;var Ye={Table:Je,Record:Je,Coverage:Xe,ScriptList:Ke,FeatureList:ze,LookupList:We,ushortList:_e,tableList:je,recordList:Ve};function Qe(e,t){return e.getUint8(t)}function qe(e,t){return e.getUint16(t,!1)}function Ze(e,t){return e.getUint32(t,!1)}function $e(e,t){return e.getInt16(t,!1)+e.getUint16(t+2,!1)/65535}var et={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};function tt(e,t){this.data=e,this.offset=t,this.relativeOffset=0}tt.prototype.parseByte=function(){var e=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,e},tt.prototype.parseChar=function(){var e=this.data.getInt8(this.offset+this.relativeOffset);return this.relativeOffset+=1,e},tt.prototype.parseCard8=tt.prototype.parseByte,tt.prototype.parseUShort=function(){var e=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,e},tt.prototype.parseCard16=tt.prototype.parseUShort,tt.prototype.parseSID=tt.prototype.parseUShort,tt.prototype.parseOffset16=tt.prototype.parseUShort,tt.prototype.parseShort=function(){var e=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,e},tt.prototype.parseF2Dot14=function(){var e=this.data.getInt16(this.offset+this.relativeOffset)/16384;return this.relativeOffset+=2,e},tt.prototype.parseULong=function(){var e=Ze(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,e},tt.prototype.parseOffset32=tt.prototype.parseULong,tt.prototype.parseFixed=function(){var e=$e(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,e},tt.prototype.parseString=function(e){var t=this.data,r=this.offset+this.relativeOffset,a="";this.relativeOffset+=e;for(var n=0;n<e;n++)a+=String.fromCharCode(t.getUint8(r+n));return a},tt.prototype.parseTag=function(){return this.parseString(4)},tt.prototype.parseLongDateTime=function(){var e=Ze(this.data,this.offset+this.relativeOffset+4);return e-=2082844800,this.relativeOffset+=8,e},tt.prototype.parseVersion=function(e){var t=qe(this.data,this.offset+this.relativeOffset),r=qe(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,void 0===e&&(e=4096),t+r/e/10},tt.prototype.skip=function(e,t){void 0===t&&(t=1),this.relativeOffset+=et[e]*t},tt.prototype.parseULongList=function(e){void 0===e&&(e=this.parseULong());for(var t=new Array(e),r=this.data,a=this.offset+this.relativeOffset,n=0;n<e;n++)t[n]=r.getUint32(a),a+=4;return this.relativeOffset+=4*e,t},tt.prototype.parseOffset16List=tt.prototype.parseUShortList=function(e){void 0===e&&(e=this.parseUShort());for(var t=new Array(e),r=this.data,a=this.offset+this.relativeOffset,n=0;n<e;n++)t[n]=r.getUint16(a),a+=2;return this.relativeOffset+=2*e,t},tt.prototype.parseShortList=function(e){for(var t=new Array(e),r=this.data,a=this.offset+this.relativeOffset,n=0;n<e;n++)t[n]=r.getInt16(a),a+=2;return this.relativeOffset+=2*e,t},tt.prototype.parseByteList=function(e){for(var t=new Array(e),r=this.data,a=this.offset+this.relativeOffset,n=0;n<e;n++)t[n]=r.getUint8(a++);return this.relativeOffset+=e,t},tt.prototype.parseList=function(e,t){t||(t=e,e=this.parseUShort());for(var r=new Array(e),a=0;a<e;a++)r[a]=t.call(this);return r},tt.prototype.parseList32=function(e,t){t||(t=e,e=this.parseULong());for(var r=new Array(e),a=0;a<e;a++)r[a]=t.call(this);return r},tt.prototype.parseRecordList=function(e,t){t||(t=e,e=this.parseUShort());for(var r=new Array(e),a=Object.keys(t),n=0;n<e;n++){for(var s={},i=0;i<a.length;i++){var o=a[i],c=t[o];s[o]=c.call(this)}r[n]=s}return r},tt.prototype.parseRecordList32=function(e,t){t||(t=e,e=this.parseULong());for(var r=new Array(e),a=Object.keys(t),n=0;n<e;n++){for(var s={},i=0;i<a.length;i++){var o=a[i],c=t[o];s[o]=c.call(this)}r[n]=s}return r},tt.prototype.parseStruct=function(e){if("function"==typeof e)return e.call(this);for(var t=Object.keys(e),r={},a=0;a<t.length;a++){var n=t[a],s=e[n];r[n]=s.call(this)}return r},tt.prototype.parseValueRecord=function(e){if(void 0===e&&(e=this.parseUShort()),0!==e){var t={};return 1&e&&(t.xPlacement=this.parseShort()),2&e&&(t.yPlacement=this.parseShort()),4&e&&(t.xAdvance=this.parseShort()),8&e&&(t.yAdvance=this.parseShort()),16&e&&(t.xPlaDevice=void 0,this.parseShort()),32&e&&(t.yPlaDevice=void 0,this.parseShort()),64&e&&(t.xAdvDevice=void 0,this.parseShort()),128&e&&(t.yAdvDevice=void 0,this.parseShort()),t}},tt.prototype.parseValueRecordList=function(){for(var e=this.parseUShort(),t=this.parseUShort(),r=new Array(t),a=0;a<t;a++)r[a]=this.parseValueRecord(e);return r},tt.prototype.parsePointer=function(e){var t=this.parseOffset16();if(t>0)return new tt(this.data,this.offset+t).parseStruct(e)},tt.prototype.parsePointer32=function(e){var t=this.parseOffset32();if(t>0)return new tt(this.data,this.offset+t).parseStruct(e)},tt.prototype.parseListOfLists=function(e){for(var t=this.parseOffset16List(),r=t.length,a=this.relativeOffset,n=new Array(r),s=0;s<r;s++){var i=t[s];if(0!==i)if(this.relativeOffset=i,e){for(var o=this.parseOffset16List(),c=new Array(o.length),l=0;l<o.length;l++)this.relativeOffset=i+o[l],c[l]=e.call(this);n[s]=c}else n[s]=this.parseUShortList();else n[s]=void 0}return this.relativeOffset=a,n},tt.prototype.parseCoverage=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort(),r=this.parseUShort();if(1===t)return{format:1,glyphs:this.parseUShortList(r)};if(2===t){for(var a=new Array(r),n=0;n<r;n++)a[n]={start:this.parseUShort(),end:this.parseUShort(),index:this.parseUShort()};return{format:2,ranges:a}}throw new Error("0x"+e.toString(16)+": Coverage format must be 1 or 2.")},tt.prototype.parseClassDef=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort();if(1===t)return{format:1,startGlyph:this.parseUShort(),classes:this.parseUShortList()};if(2===t)return{format:2,ranges:this.parseRecordList({start:tt.uShort,end:tt.uShort,classId:tt.uShort})};throw new Error("0x"+e.toString(16)+": ClassDef format must be 1 or 2.")},tt.list=function(e,t){return function(){return this.parseList(e,t)}},tt.list32=function(e,t){return function(){return this.parseList32(e,t)}},tt.recordList=function(e,t){return function(){return this.parseRecordList(e,t)}},tt.recordList32=function(e,t){return function(){return this.parseRecordList32(e,t)}},tt.pointer=function(e){return function(){return this.parsePointer(e)}},tt.pointer32=function(e){return function(){return this.parsePointer32(e)}},tt.tag=tt.prototype.parseTag,tt.byte=tt.prototype.parseByte,tt.uShort=tt.offset16=tt.prototype.parseUShort,tt.uShortList=tt.prototype.parseUShortList,tt.uLong=tt.offset32=tt.prototype.parseULong,tt.uLongList=tt.prototype.parseULongList,tt.struct=tt.prototype.parseStruct,tt.coverage=tt.prototype.parseCoverage,tt.classDef=tt.prototype.parseClassDef;var rt={reserved:tt.uShort,reqFeatureIndex:tt.uShort,featureIndexes:tt.uShortList};tt.prototype.parseScriptList=function(){return this.parsePointer(tt.recordList({tag:tt.tag,script:tt.pointer({defaultLangSys:tt.pointer(rt),langSysRecords:tt.recordList({tag:tt.tag,langSys:tt.pointer(rt)})})}))||[]},tt.prototype.parseFeatureList=function(){return this.parsePointer(tt.recordList({tag:tt.tag,feature:tt.pointer({featureParams:tt.offset16,lookupListIndexes:tt.uShortList})}))||[]},tt.prototype.parseLookupList=function(e){return this.parsePointer(tt.list(tt.pointer((function(){var t=this.parseUShort();Ie.argument(1<=t&&t<=9,"GPOS/GSUB lookup type "+t+" unknown.");var r=this.parseUShort(),a=16&r;return{lookupType:t,lookupFlag:r,subtables:this.parseList(tt.pointer(e[t])),markFilteringSet:a?this.parseUShort():void 0}}))))||[]},tt.prototype.parseFeatureVariationsList=function(){return this.parsePointer32((function(){var e=this.parseUShort(),t=this.parseUShort();return Ie.argument(1===e&&t<1,"GPOS/GSUB feature variations table unknown."),this.parseRecordList32({conditionSetOffset:tt.offset32,featureTableSubstitutionOffset:tt.offset32})}))||[]};var at={getByte:Qe,getCard8:Qe,getUShort:qe,getCard16:qe,getShort:function(e,t){return e.getInt16(t,!1)},getULong:Ze,getFixed:$e,getTag:function(e,t){for(var r="",a=t;a<t+4;a+=1)r+=String.fromCharCode(e.getInt8(a));return r},getOffset:function(e,t,r){for(var a=0,n=0;n<r;n+=1)a<<=8,a+=e.getUint8(t+n);return a},getBytes:function(e,t,r){for(var a=[],n=t;n<r;n+=1)a.push(e.getUint8(n));return a},bytesToString:function(e){for(var t="",r=0;r<e.length;r+=1)t+=String.fromCharCode(e[r]);return t},Parser:tt};function nt(e,t,r){e.segments.push({end:t,start:t,delta:-(t-r),offset:0,glyphIndex:r})}var st={parse:function(e,t){var r={};r.version=at.getUShort(e,t),Ie.argument(0===r.version,"cmap table version should be 0."),r.numTables=at.getUShort(e,t+2);for(var a=-1,n=r.numTables-1;n>=0;n-=1){var s=at.getUShort(e,t+4+8*n),i=at.getUShort(e,t+4+8*n+2);if(3===s&&(0===i||1===i||10===i)||0===s&&(0===i||1===i||2===i||3===i||4===i)){a=at.getULong(e,t+4+8*n+4);break}}if(-1===a)throw new Error("No valid cmap sub-tables found.");var o=new at.Parser(e,t+a);if(r.format=o.parseUShort(),12===r.format)!function(e,t){var r;t.parseUShort(),e.length=t.parseULong(),e.language=t.parseULong(),e.groupCount=r=t.parseULong(),e.glyphIndexMap={};for(var a=0;a<r;a+=1)for(var n=t.parseULong(),s=t.parseULong(),i=t.parseULong(),o=n;o<=s;o+=1)e.glyphIndexMap[o]=i,i++}(r,o);else{if(4!==r.format)throw new Error("Only format 4 and 12 cmap tables are supported (found format "+r.format+").");!function(e,t,r,a,n){var s;e.length=t.parseUShort(),e.language=t.parseUShort(),e.segCount=s=t.parseUShort()>>1,t.skip("uShort",3),e.glyphIndexMap={};for(var i=new at.Parser(r,a+n+14),o=new at.Parser(r,a+n+16+2*s),c=new at.Parser(r,a+n+16+4*s),l=new at.Parser(r,a+n+16+6*s),u=a+n+16+8*s,h=0;h<s-1;h+=1)for(var p=void 0,f=i.parseUShort(),d=o.parseUShort(),g=c.parseShort(),m=l.parseUShort(),v=d;v<=f;v+=1)0!==m?(u=l.offset+l.relativeOffset-2,u+=m,u+=2*(v-d),0!==(p=at.getUShort(r,u))&&(p=p+g&65535)):p=v+g&65535,e.glyphIndexMap[v]=p}(r,o,e,t,a)}return r},make:function(e){var t,r=!0;for(t=e.length-1;t>0;t-=1){if(e.get(t).unicode>65535){console.log("Adding CMAP format 12 (needed!)"),r=!1;break}}var a=[{name:"version",type:"USHORT",value:0},{name:"numTables",type:"USHORT",value:r?1:2},{name:"platformID",type:"USHORT",value:3},{name:"encodingID",type:"USHORT",value:1},{name:"offset",type:"ULONG",value:r?12:20}];r||(a=a.concat([{name:"cmap12PlatformID",type:"USHORT",value:3},{name:"cmap12EncodingID",type:"USHORT",value:10},{name:"cmap12Offset",type:"ULONG",value:0}])),a=a.concat([{name:"format",type:"USHORT",value:4},{name:"cmap4Length",type:"USHORT",value:0},{name:"language",type:"USHORT",value:0},{name:"segCountX2",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);var n=new Ye.Table("cmap",a);for(n.segments=[],t=0;t<e.length;t+=1){for(var s=e.get(t),i=0;i<s.unicodes.length;i+=1)nt(n,s.unicodes[i],t);n.segments=n.segments.sort((function(e,t){return e.start-t.start}))}!function(e){e.segments.push({end:65535,start:65535,delta:1,offset:0})}(n);var o=n.segments.length,c=0,l=[],u=[],h=[],p=[],f=[],d=[];for(t=0;t<o;t+=1){var g=n.segments[t];g.end<=65535&&g.start<=65535?(l=l.concat({name:"end_"+t,type:"USHORT",value:g.end}),u=u.concat({name:"start_"+t,type:"USHORT",value:g.start}),h=h.concat({name:"idDelta_"+t,type:"SHORT",value:g.delta}),p=p.concat({name:"idRangeOffset_"+t,type:"USHORT",value:g.offset}),void 0!==g.glyphId&&(f=f.concat({name:"glyph_"+t,type:"USHORT",value:g.glyphId}))):c+=1,r||void 0===g.glyphIndex||(d=(d=(d=d.concat({name:"cmap12Start_"+t,type:"ULONG",value:g.start})).concat({name:"cmap12End_"+t,type:"ULONG",value:g.end})).concat({name:"cmap12Glyph_"+t,type:"ULONG",value:g.glyphIndex}))}if(n.segCountX2=2*(o-c),n.searchRange=2*Math.pow(2,Math.floor(Math.log(o-c)/Math.log(2))),n.entrySelector=Math.log(n.searchRange/2)/Math.log(2),n.rangeShift=n.segCountX2-n.searchRange,n.fields=n.fields.concat(l),n.fields.push({name:"reservedPad",type:"USHORT",value:0}),n.fields=n.fields.concat(u),n.fields=n.fields.concat(h),n.fields=n.fields.concat(p),n.fields=n.fields.concat(f),n.cmap4Length=14+2*l.length+2+2*u.length+2*h.length+2*p.length+2*f.length,!r){var m=16+4*d.length;n.cmap12Offset=20+n.cmap4Length,n.fields=n.fields.concat([{name:"cmap12Format",type:"USHORT",value:12},{name:"cmap12Reserved",type:"USHORT",value:0},{name:"cmap12Length",type:"ULONG",value:m},{name:"cmap12Language",type:"ULONG",value:0},{name:"cmap12nGroups",type:"ULONG",value:d.length/3}]),n.fields=n.fields.concat(d)}return n}},it=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","266 ff","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],ot=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls"],ct=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],lt=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"];function ut(e){this.font=e}function ht(e){this.cmap=e}function pt(e,t){this.encoding=e,this.charset=t}function ft(e){switch(e.version){case 1:this.names=lt.slice();break;case 2:this.names=new Array(e.numberOfGlyphs);for(var t=0;t<e.numberOfGlyphs;t++)e.glyphNameIndex[t]<lt.length?this.names[t]=lt[e.glyphNameIndex[t]]:this.names[t]=e.names[e.glyphNameIndex[t]-lt.length];break;case 2.5:this.names=new Array(e.numberOfGlyphs);for(var r=0;r<e.numberOfGlyphs;r++)this.names[r]=lt[r+e.glyphNameIndex[r]];break;case 3:default:this.names=[]}}function dt(e,t){t.lowMemory?function(e){e._IndexToUnicodeMap={};for(var t=e.tables.cmap.glyphIndexMap,r=Object.keys(t),a=0;a<r.length;a+=1){var n=r[a],s=t[n];void 0===e._IndexToUnicodeMap[s]?e._IndexToUnicodeMap[s]={unicodes:[parseInt(n)]}:e._IndexToUnicodeMap[s].unicodes.push(parseInt(n))}}(e):function(e){for(var t,r=e.tables.cmap.glyphIndexMap,a=Object.keys(r),n=0;n<a.length;n+=1){var s=a[n],i=r[s];(t=e.glyphs.get(i)).addUnicode(parseInt(s))}for(var o=0;o<e.glyphs.length;o+=1)t=e.glyphs.get(o),e.cffEncoding?e.isCIDFont?t.name="gid"+o:t.name=e.cffEncoding.charset[o]:e.glyphNames.names&&(t.name=e.glyphNames.glyphIndexToName(o))}(e)}ut.prototype.charToGlyphIndex=function(e){var t=e.codePointAt(0),r=this.font.glyphs;if(r)for(var a=0;a<r.length;a+=1)for(var n=r.get(a),s=0;s<n.unicodes.length;s+=1)if(n.unicodes[s]===t)return a;return null},ht.prototype.charToGlyphIndex=function(e){return this.cmap.glyphIndexMap[e.codePointAt(0)]||0},pt.prototype.charToGlyphIndex=function(e){var t=e.codePointAt(0),r=this.encoding[t];return this.charset.indexOf(r)},ft.prototype.nameToGlyphIndex=function(e){return this.names.indexOf(e)},ft.prototype.glyphIndexToName=function(e){return this.names[e]};var gt={line:function(e,t,r,a,n){e.beginPath(),e.moveTo(t,r),e.lineTo(a,n),e.stroke()}};function mt(e){this.bindConstructorValues(e)}function vt(e,t,r){Object.defineProperty(e,t,{get:function(){return e.path,e[r]},set:function(t){e[r]=t},enumerable:!0,configurable:!0})}function yt(e,t){if(this.font=e,this.glyphs={},Array.isArray(t))for(var r=0;r<t.length;r++){var a=t[r];a.path.unitsPerEm=e.unitsPerEm,this.glyphs[r]=a}this.length=t&&t.length||0}mt.prototype.bindConstructorValues=function(e){var t,r;this.index=e.index||0,this.name=e.name||null,this.unicode=e.unicode||void 0,this.unicodes=e.unicodes||void 0!==e.unicode?[e.unicode]:[],"xMin"in e&&(this.xMin=e.xMin),"yMin"in e&&(this.yMin=e.yMin),"xMax"in e&&(this.xMax=e.xMax),"yMax"in e&&(this.yMax=e.yMax),"advanceWidth"in e&&(this.advanceWidth=e.advanceWidth),Object.defineProperty(this,"path",(t=e.path,r=t||new we,{configurable:!0,get:function(){return"function"==typeof r&&(r=r()),r},set:function(e){r=e}}))},mt.prototype.addUnicode=function(e){0===this.unicodes.length&&(this.unicode=e),this.unicodes.push(e)},mt.prototype.getBoundingBox=function(){return this.path.getBoundingBox()},mt.prototype.getPath=function(e,t,r,a,n){var s,i;e=void 0!==e?e:0,t=void 0!==t?t:0,r=void 0!==r?r:72,a||(a={});var o=a.xScale,c=a.yScale;if(a.hinting&&n&&n.hinting&&(i=this.path&&n.hinting.exec(this,r)),i)s=n.hinting.getCommands(i),e=Math.round(e),t=Math.round(t),o=c=1;else{s=this.path.commands;var l=1/(this.path.unitsPerEm||1e3)*r;void 0===o&&(o=l),void 0===c&&(c=l)}for(var u=new we,h=0;h<s.length;h+=1){var p=s[h];"M"===p.type?u.moveTo(e+p.x*o,t+-p.y*c):"L"===p.type?u.lineTo(e+p.x*o,t+-p.y*c):"Q"===p.type?u.quadraticCurveTo(e+p.x1*o,t+-p.y1*c,e+p.x*o,t+-p.y*c):"C"===p.type?u.curveTo(e+p.x1*o,t+-p.y1*c,e+p.x2*o,t+-p.y2*c,e+p.x*o,t+-p.y*c):"Z"===p.type&&u.closePath()}return u},mt.prototype.getContours=function(){if(void 0===this.points)return[];for(var e=[],t=[],r=0;r<this.points.length;r+=1){var a=this.points[r];t.push(a),a.lastPointOfContour&&(e.push(t),t=[])}return Ie.argument(0===t.length,"There are still points left in the current contour."),e},mt.prototype.getMetrics=function(){for(var e=this.path.commands,t=[],r=[],a=0;a<e.length;a+=1){var n=e[a];"Z"!==n.type&&(t.push(n.x),r.push(n.y)),"Q"!==n.type&&"C"!==n.type||(t.push(n.x1),r.push(n.y1)),"C"===n.type&&(t.push(n.x2),r.push(n.y2))}var s={xMin:Math.min.apply(null,t),yMin:Math.min.apply(null,r),xMax:Math.max.apply(null,t),yMax:Math.max.apply(null,r),leftSideBearing:this.leftSideBearing};return isFinite(s.xMin)||(s.xMin=0),isFinite(s.xMax)||(s.xMax=this.advanceWidth),isFinite(s.yMin)||(s.yMin=0),isFinite(s.yMax)||(s.yMax=0),s.rightSideBearing=this.advanceWidth-s.leftSideBearing-(s.xMax-s.xMin),s},mt.prototype.draw=function(e,t,r,a,n){this.getPath(t,r,a,n).draw(e)},mt.prototype.drawPoints=function(e,t,r,a){function n(t,r,a,n){e.beginPath();for(var s=0;s<t.length;s+=1)e.moveTo(r+t[s].x*n,a+t[s].y*n),e.arc(r+t[s].x*n,a+t[s].y*n,2,0,2*Math.PI,!1);e.closePath(),e.fill()}t=void 0!==t?t:0,r=void 0!==r?r:0,a=void 0!==a?a:24;for(var s=1/this.path.unitsPerEm*a,i=[],o=[],c=this.path,l=0;l<c.commands.length;l+=1){var u=c.commands[l];void 0!==u.x&&i.push({x:u.x,y:-u.y}),void 0!==u.x1&&o.push({x:u.x1,y:-u.y1}),void 0!==u.x2&&o.push({x:u.x2,y:-u.y2})}e.fillStyle="blue",n(i,t,r,s),e.fillStyle="red",n(o,t,r,s)},mt.prototype.drawMetrics=function(e,t,r,a){var n;t=void 0!==t?t:0,r=void 0!==r?r:0,a=void 0!==a?a:24,n=1/this.path.unitsPerEm*a,e.lineWidth=1,e.strokeStyle="black",gt.line(e,t,-1e4,t,1e4),gt.line(e,-1e4,r,1e4,r);var s=this.xMin||0,i=this.yMin||0,o=this.xMax||0,c=this.yMax||0,l=this.advanceWidth||0;e.strokeStyle="blue",gt.line(e,t+s*n,-1e4,t+s*n,1e4),gt.line(e,t+o*n,-1e4,t+o*n,1e4),gt.line(e,-1e4,r+-i*n,1e4,r+-i*n),gt.line(e,-1e4,r+-c*n,1e4,r+-c*n),e.strokeStyle="green",gt.line(e,t+l*n,-1e4,t+l*n,1e4)},yt.prototype.get=function(e){if(void 0===this.glyphs[e]){this.font._push(e),"function"==typeof this.glyphs[e]&&(this.glyphs[e]=this.glyphs[e]());var t=this.glyphs[e],r=this.font._IndexToUnicodeMap[e];if(r)for(var a=0;a<r.unicodes.length;a++)t.addUnicode(r.unicodes[a]);this.font.cffEncoding?this.font.isCIDFont?t.name="gid"+e:t.name=this.font.cffEncoding.charset[e]:this.font.glyphNames.names&&(t.name=this.font.glyphNames.glyphIndexToName(e)),this.glyphs[e].advanceWidth=this.font._hmtxTableData[e].advanceWidth,this.glyphs[e].leftSideBearing=this.font._hmtxTableData[e].leftSideBearing}else"function"==typeof this.glyphs[e]&&(this.glyphs[e]=this.glyphs[e]());return this.glyphs[e]},yt.prototype.push=function(e,t){this.glyphs[e]=t,this.length++};var At={GlyphSet:yt,glyphLoader:function(e,t){return new mt({index:t,font:e})},ttfGlyphLoader:function(e,t,r,a,n,s){return function(){var i=new mt({index:t,font:e});return i.path=function(){r(i,a,n);var t=s(e.glyphs,i);return t.unitsPerEm=e.unitsPerEm,t},vt(i,"xMin","_xMin"),vt(i,"xMax","_xMax"),vt(i,"yMin","_yMin"),vt(i,"yMax","_yMax"),i}},cffGlyphLoader:function(e,t,r,a){return function(){var n=new mt({index:t,font:e});return n.path=function(){var t=r(e,n,a);return t.unitsPerEm=e.unitsPerEm,t},n}}};function bt(e,t){if(e===t)return!0;if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r+=1)if(!bt(e[r],t[r]))return!1;return!0}return!1}function Bt(e){return e.length<1240?107:e.length<33900?1131:32768}function Ct(e,t,r){var a,n,s=[],i=[],o=at.getCard16(e,t);if(0!==o){var c=at.getByte(e,t+2);a=t+(o+1)*c+2;for(var l=t+3,u=0;u<o+1;u+=1)s.push(at.getOffset(e,l,c)),l+=c;n=a+s[o]}else n=t+2;for(var h=0;h<s.length-1;h+=1){var p=at.getBytes(e,a+s[h],a+s[h+1]);r&&(p=r(p)),i.push(p)}return{objects:i,startOffset:t,endOffset:n}}function xt(e,t){if(28===t)return e.parseByte()<<8|e.parseByte();if(29===t)return e.parseByte()<<24|e.parseByte()<<16|e.parseByte()<<8|e.parseByte();if(30===t)return function(e){for(var t="",r=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];;){var a=e.parseByte(),n=a>>4,s=15&a;if(15===n)break;if(t+=r[n],15===s)break;t+=r[s]}return parseFloat(t)}(e);if(t>=32&&t<=246)return t-139;if(t>=247&&t<=250)return 256*(t-247)+e.parseByte()+108;if(t>=251&&t<=254)return 256*-(t-251)-e.parseByte()-108;throw new Error("Invalid b0 "+t)}function Ft(e,t,r){t=void 0!==t?t:0;var a=new at.Parser(e,t),n=[],s=[];for(r=void 0!==r?r:e.length;a.relativeOffset<r;){var i=a.parseByte();i<=21?(12===i&&(i=1200+a.parseByte()),n.push([i,s]),s=[]):s.push(xt(a,i))}return function(e){for(var t={},r=0;r<e.length;r+=1){var a=e[r][0],n=e[r][1],s=void 0;if(s=1===n.length?n[0]:n,t.hasOwnProperty(a)&&!isNaN(t[a]))throw new Error("Object "+t+" already has key "+a);t[a]=s}return t}(n)}function wt(e,t){return t=t<=390?it[t]:e[t-391]}function Et(e,t,r){for(var a,n={},s=0;s<t.length;s+=1){var i=t[s];if(Array.isArray(i.type)){var o=[];o.length=i.type.length;for(var c=0;c<i.type.length;c++)void 0===(a=void 0!==e[i.op]?e[i.op][c]:void 0)&&(a=void 0!==i.value&&void 0!==i.value[c]?i.value[c]:null),"SID"===i.type[c]&&(a=wt(r,a)),o[c]=a;n[i.name]=o}else void 0===(a=e[i.op])&&(a=void 0!==i.value?i.value:null),"SID"===i.type&&(a=wt(r,a)),n[i.name]=a}return n}var St=[{name:"version",op:0,type:"SID"},{name:"notice",op:1,type:"SID"},{name:"copyright",op:1200,type:"SID"},{name:"fullName",op:2,type:"SID"},{name:"familyName",op:3,type:"SID"},{name:"weight",op:4,type:"SID"},{name:"isFixedPitch",op:1201,type:"number",value:0},{name:"italicAngle",op:1202,type:"number",value:0},{name:"underlinePosition",op:1203,type:"number",value:-100},{name:"underlineThickness",op:1204,type:"number",value:50},{name:"paintType",op:1205,type:"number",value:0},{name:"charstringType",op:1206,type:"number",value:2},{name:"fontMatrix",op:1207,type:["real","real","real","real","real","real"],value:[.001,0,0,.001,0,0]},{name:"uniqueId",op:13,type:"number"},{name:"fontBBox",op:5,type:["number","number","number","number"],value:[0,0,0,0]},{name:"strokeWidth",op:1208,type:"number",value:0},{name:"xuid",op:14,type:[],value:null},{name:"charset",op:15,type:"offset",value:0},{name:"encoding",op:16,type:"offset",value:0},{name:"charStrings",op:17,type:"offset",value:0},{name:"private",op:18,type:["number","offset"],value:[0,0]},{name:"ros",op:1230,type:["SID","SID","number"]},{name:"cidFontVersion",op:1231,type:"number",value:0},{name:"cidFontRevision",op:1232,type:"number",value:0},{name:"cidFontType",op:1233,type:"number",value:0},{name:"cidCount",op:1234,type:"number",value:8720},{name:"uidBase",op:1235,type:"number"},{name:"fdArray",op:1236,type:"offset"},{name:"fdSelect",op:1237,type:"offset"},{name:"fontName",op:1238,type:"SID"}],It=[{name:"subrs",op:19,type:"offset",value:0},{name:"defaultWidthX",op:20,type:"number",value:0},{name:"nominalWidthX",op:21,type:"number",value:0}];function Mt(e,t){return Et(Ft(e,0,e.byteLength),St,t)}function Tt(e,t,r,a){return Et(Ft(e,t,r),It,a)}function kt(e,t,r,a){for(var n=[],s=0;s<r.length;s+=1){var i=Mt(new DataView(new Uint8Array(r[s]).buffer),a);i._subrs=[],i._subrsBias=0;var o=i.private[0],c=i.private[1];if(0!==o&&0!==c){var l=Tt(e,c+t,o,a);if(i._defaultWidthX=l.defaultWidthX,i._nominalWidthX=l.nominalWidthX,0!==l.subrs){var u=Ct(e,c+l.subrs+t);i._subrs=u.objects,i._subrsBias=Bt(i._subrs)}i._privateDict=l}n.push(i)}return n}function Rt(e,t,r){var a,n,s,i,o,c,l,u,h=new we,p=[],f=0,d=!1,g=!1,m=0,v=0;if(e.isCIDFont){var y=e.tables.cff.topDict._fdSelect[t.index],A=e.tables.cff.topDict._fdArray[y];o=A._subrs,c=A._subrsBias,l=A._defaultWidthX,u=A._nominalWidthX}else o=e.tables.cff.topDict._subrs,c=e.tables.cff.topDict._subrsBias,l=e.tables.cff.topDict._defaultWidthX,u=e.tables.cff.topDict._nominalWidthX;var b=l;function B(e,t){g&&h.closePath(),h.moveTo(e,t),g=!0}function C(){p.length%2!=0&&!d&&(b=p.shift()+u),f+=p.length>>1,p.length=0,d=!0}return function r(l){for(var y,A,x,F,w,E,S,I,M,T,k,R,L=0;L<l.length;){var D=l[L];switch(L+=1,D){case 1:case 3:C();break;case 4:p.length>1&&!d&&(b=p.shift()+u,d=!0),v+=p.pop(),B(m,v);break;case 5:for(;p.length>0;)m+=p.shift(),v+=p.shift(),h.lineTo(m,v);break;case 6:for(;p.length>0&&(m+=p.shift(),h.lineTo(m,v),0!==p.length);)v+=p.shift(),h.lineTo(m,v);break;case 7:for(;p.length>0&&(v+=p.shift(),h.lineTo(m,v),0!==p.length);)m+=p.shift(),h.lineTo(m,v);break;case 8:for(;p.length>0;)a=m+p.shift(),n=v+p.shift(),s=a+p.shift(),i=n+p.shift(),m=s+p.shift(),v=i+p.shift(),h.curveTo(a,n,s,i,m,v);break;case 10:w=p.pop()+c,(E=o[w])&&r(E);break;case 11:return;case 12:switch(D=l[L],L+=1,D){case 35:a=m+p.shift(),n=v+p.shift(),s=a+p.shift(),i=n+p.shift(),S=s+p.shift(),I=i+p.shift(),M=S+p.shift(),T=I+p.shift(),k=M+p.shift(),R=T+p.shift(),m=k+p.shift(),v=R+p.shift(),p.shift(),h.curveTo(a,n,s,i,S,I),h.curveTo(M,T,k,R,m,v);break;case 34:a=m+p.shift(),n=v,s=a+p.shift(),i=n+p.shift(),S=s+p.shift(),I=i,M=S+p.shift(),T=i,k=M+p.shift(),R=v,m=k+p.shift(),h.curveTo(a,n,s,i,S,I),h.curveTo(M,T,k,R,m,v);break;case 36:a=m+p.shift(),n=v+p.shift(),s=a+p.shift(),i=n+p.shift(),S=s+p.shift(),I=i,M=S+p.shift(),T=i,k=M+p.shift(),R=T+p.shift(),m=k+p.shift(),h.curveTo(a,n,s,i,S,I),h.curveTo(M,T,k,R,m,v);break;case 37:a=m+p.shift(),n=v+p.shift(),s=a+p.shift(),i=n+p.shift(),S=s+p.shift(),I=i+p.shift(),M=S+p.shift(),T=I+p.shift(),k=M+p.shift(),R=T+p.shift(),Math.abs(k-m)>Math.abs(R-v)?m=k+p.shift():v=R+p.shift(),h.curveTo(a,n,s,i,S,I),h.curveTo(M,T,k,R,m,v);break;default:console.log("Glyph "+t.index+": unknown operator 1200"+D),p.length=0}break;case 14:p.length>0&&!d&&(b=p.shift()+u,d=!0),g&&(h.closePath(),g=!1);break;case 18:C();break;case 19:case 20:C(),L+=f+7>>3;break;case 21:p.length>2&&!d&&(b=p.shift()+u,d=!0),v+=p.pop(),B(m+=p.pop(),v);break;case 22:p.length>1&&!d&&(b=p.shift()+u,d=!0),B(m+=p.pop(),v);break;case 23:C();break;case 24:for(;p.length>2;)a=m+p.shift(),n=v+p.shift(),s=a+p.shift(),i=n+p.shift(),m=s+p.shift(),v=i+p.shift(),h.curveTo(a,n,s,i,m,v);m+=p.shift(),v+=p.shift(),h.lineTo(m,v);break;case 25:for(;p.length>6;)m+=p.shift(),v+=p.shift(),h.lineTo(m,v);a=m+p.shift(),n=v+p.shift(),s=a+p.shift(),i=n+p.shift(),m=s+p.shift(),v=i+p.shift(),h.curveTo(a,n,s,i,m,v);break;case 26:for(p.length%2&&(m+=p.shift());p.length>0;)a=m,n=v+p.shift(),s=a+p.shift(),i=n+p.shift(),m=s,v=i+p.shift(),h.curveTo(a,n,s,i,m,v);break;case 27:for(p.length%2&&(v+=p.shift());p.length>0;)a=m+p.shift(),n=v,s=a+p.shift(),i=n+p.shift(),m=s+p.shift(),v=i,h.curveTo(a,n,s,i,m,v);break;case 28:y=l[L],A=l[L+1],p.push((y<<24|A<<16)>>16),L+=2;break;case 29:w=p.pop()+e.gsubrsBias,(E=e.gsubrs[w])&&r(E);break;case 30:for(;p.length>0&&(a=m,n=v+p.shift(),s=a+p.shift(),i=n+p.shift(),m=s+p.shift(),v=i+(1===p.length?p.shift():0),h.curveTo(a,n,s,i,m,v),0!==p.length);)a=m+p.shift(),n=v,s=a+p.shift(),i=n+p.shift(),v=i+p.shift(),m=s+(1===p.length?p.shift():0),h.curveTo(a,n,s,i,m,v);break;case 31:for(;p.length>0&&(a=m+p.shift(),n=v,s=a+p.shift(),i=n+p.shift(),v=i+p.shift(),m=s+(1===p.length?p.shift():0),h.curveTo(a,n,s,i,m,v),0!==p.length);)a=m,n=v+p.shift(),s=a+p.shift(),i=n+p.shift(),m=s+p.shift(),v=i+(1===p.length?p.shift():0),h.curveTo(a,n,s,i,m,v);break;default:D<32?console.log("Glyph "+t.index+": unknown operator "+D):D<247?p.push(D-139):D<251?(y=l[L],L+=1,p.push(256*(D-247)+y+108)):D<255?(y=l[L],L+=1,p.push(256*-(D-251)-y-108)):(y=l[L],A=l[L+1],x=l[L+2],F=l[L+3],L+=4,p.push((y<<24|A<<16|x<<8|F)/65536))}}}(r),t.advanceWidth=b,h}function Lt(e,t){var r,a=it.indexOf(e);return a>=0&&(r=a),(a=t.indexOf(e))>=0?r=a+it.length:(r=it.length+t.length,t.push(e)),r}function Dt(e,t,r){for(var a={},n=0;n<e.length;n+=1){var s=e[n],i=t[s.name];void 0===i||bt(i,s.value)||("SID"===s.type&&(i=Lt(i,r)),a[s.op]={name:s.name,type:s.type,value:i})}return a}function Ot(e,t){var r=new Ye.Record("Top DICT",[{name:"dict",type:"DICT",value:{}}]);return r.dict=Dt(St,e,t),r}function Ut(e){var t=new Ye.Record("Top DICT INDEX",[{name:"topDicts",type:"INDEX",value:[]}]);return t.topDicts=[{name:"topDict_0",type:"TABLE",value:e}],t}function Gt(e){var t=[],r=e.path;t.push({name:"width",type:"NUMBER",value:e.advanceWidth});for(var a=0,n=0,s=0;s<r.commands.length;s+=1){var i=void 0,o=void 0,c=r.commands[s];if("Q"===c.type){var l=1/3,u=2/3;c={type:"C",x:c.x,y:c.y,x1:l*a+u*c.x1,y1:l*n+u*c.y1,x2:l*c.x+u*c.x1,y2:l*c.y+u*c.y1}}if("M"===c.type)i=Math.round(c.x-a),o=Math.round(c.y-n),t.push({name:"dx",type:"NUMBER",value:i}),t.push({name:"dy",type:"NUMBER",value:o}),t.push({name:"rmoveto",type:"OP",value:21}),a=Math.round(c.x),n=Math.round(c.y);else if("L"===c.type)i=Math.round(c.x-a),o=Math.round(c.y-n),t.push({name:"dx",type:"NUMBER",value:i}),t.push({name:"dy",type:"NUMBER",value:o}),t.push({name:"rlineto",type:"OP",value:5}),a=Math.round(c.x),n=Math.round(c.y);else if("C"===c.type){var h=Math.round(c.x1-a),p=Math.round(c.y1-n),f=Math.round(c.x2-c.x1),d=Math.round(c.y2-c.y1);i=Math.round(c.x-c.x2),o=Math.round(c.y-c.y2),t.push({name:"dx1",type:"NUMBER",value:h}),t.push({name:"dy1",type:"NUMBER",value:p}),t.push({name:"dx2",type:"NUMBER",value:f}),t.push({name:"dy2",type:"NUMBER",value:d}),t.push({name:"dx",type:"NUMBER",value:i}),t.push({name:"dy",type:"NUMBER",value:o}),t.push({name:"rrcurveto",type:"OP",value:8}),a=Math.round(c.x),n=Math.round(c.y)}}return t.push({name:"endchar",type:"OP",value:14}),t}var Nt={parse:function(e,t,r,a){r.tables.cff={};var n=function(e,t){var r={};return r.formatMajor=at.getCard8(e,t),r.formatMinor=at.getCard8(e,t+1),r.size=at.getCard8(e,t+2),r.offsetSize=at.getCard8(e,t+3),r.startOffset=t,r.endOffset=t+4,r}(e,t),s=Ct(e,n.endOffset,at.bytesToString),i=Ct(e,s.endOffset),o=Ct(e,i.endOffset,at.bytesToString),c=Ct(e,o.endOffset);r.gsubrs=c.objects,r.gsubrsBias=Bt(r.gsubrs);var l=kt(e,t,i.objects,o.objects);if(1!==l.length)throw new Error("CFF table has too many fonts in 'FontSet' - count of fonts NameIndex.length = "+l.length);var u=l[0];if(r.tables.cff.topDict=u,u._privateDict&&(r.defaultWidthX=u._privateDict.defaultWidthX,r.nominalWidthX=u._privateDict.nominalWidthX),void 0!==u.ros[0]&&void 0!==u.ros[1]&&(r.isCIDFont=!0),r.isCIDFont){var h=u.fdArray,p=u.fdSelect;if(0===h||0===p)throw new Error("Font is marked as a CID font, but FDArray and/or FDSelect information is missing");var f=Ct(e,h+=t),d=kt(e,t,f.objects,o.objects);u._fdArray=d,p+=t,u._fdSelect=function(e,t,r,a){var n,s=[],i=new at.Parser(e,t),o=i.parseCard8();if(0===o)for(var c=0;c<r;c++){if((n=i.parseCard8())>=a)throw new Error("CFF table CID Font FDSelect has bad FD index value "+n+" (FD count "+a+")");s.push(n)}else{if(3!==o)throw new Error("CFF Table CID Font FDSelect table has unsupported format "+o);var l,u=i.parseCard16(),h=i.parseCard16();if(0!==h)throw new Error("CFF Table CID Font FDSelect format 3 range has bad initial GID "+h);for(var p=0;p<u;p++){if(n=i.parseCard8(),l=i.parseCard16(),n>=a)throw new Error("CFF table CID Font FDSelect has bad FD index value "+n+" (FD count "+a+")");if(l>r)throw new Error("CFF Table CID Font FDSelect format 3 range has bad GID "+l);for(;h<l;h++)s.push(n);h=l}if(l!==r)throw new Error("CFF Table CID Font FDSelect format 3 range has bad final GID "+l)}return s}(e,p,r.numGlyphs,d.length)}var g,m=t+u.private[1],v=Tt(e,m,u.private[0],o.objects);if(r.defaultWidthX=v.defaultWidthX,r.nominalWidthX=v.nominalWidthX,0!==v.subrs){var y=m+v.subrs,A=Ct(e,y);r.subrs=A.objects,r.subrsBias=Bt(r.subrs)}else r.subrs=[],r.subrsBias=0;a.lowMemory?(g=function(e,t){var r,a,n=[],s=at.getCard16(e,t);if(0!==s){var i=at.getByte(e,t+2);r=t+(s+1)*i+2;for(var o=t+3,c=0;c<s+1;c+=1)n.push(at.getOffset(e,o,i)),o+=i;a=r+n[s]}else a=t+2;return{offsets:n,startOffset:t,endOffset:a}}(e,t+u.charStrings),r.nGlyphs=g.offsets.length):(g=Ct(e,t+u.charStrings),r.nGlyphs=g.objects.length);var b=function(e,t,r,a){var n,s,i=new at.Parser(e,t);r-=1;var o=[".notdef"],c=i.parseCard8();if(0===c)for(var l=0;l<r;l+=1)n=i.parseSID(),o.push(wt(a,n));else if(1===c)for(;o.length<=r;){n=i.parseSID(),s=i.parseCard8();for(var u=0;u<=s;u+=1)o.push(wt(a,n)),n+=1}else{if(2!==c)throw new Error("Unknown charset format "+c);for(;o.length<=r;){n=i.parseSID(),s=i.parseCard16();for(var h=0;h<=s;h+=1)o.push(wt(a,n)),n+=1}}return o}(e,t+u.charset,r.nGlyphs,o.objects);if(0===u.encoding?r.cffEncoding=new pt(ot,b):1===u.encoding?r.cffEncoding=new pt(ct,b):r.cffEncoding=function(e,t,r){var a,n={},s=new at.Parser(e,t),i=s.parseCard8();if(0===i)for(var o=s.parseCard8(),c=0;c<o;c+=1)n[a=s.parseCard8()]=c;else{if(1!==i)throw new Error("Unknown encoding format "+i);var l=s.parseCard8();a=1;for(var u=0;u<l;u+=1)for(var h=s.parseCard8(),p=s.parseCard8(),f=h;f<=h+p;f+=1)n[f]=a,a+=1}return new pt(n,r)}(e,t+u.encoding,b),r.encoding=r.encoding||r.cffEncoding,r.glyphs=new At.GlyphSet(r),a.lowMemory)r._push=function(a){var n=function(e,t,r,a,n){var s=at.getCard16(r,a),i=0;0!==s&&(i=a+(s+1)*at.getByte(r,a+2)+2);var o=at.getBytes(r,i+t[e],i+t[e+1]);return n&&(o=n(o)),o}(a,g.offsets,e,t+u.charStrings);r.glyphs.push(a,At.cffGlyphLoader(r,a,Rt,n))};else for(var B=0;B<r.nGlyphs;B+=1){var C=g.objects[B];r.glyphs.push(B,At.cffGlyphLoader(r,B,Rt,C))}},make:function(e,t){for(var r,a=new Ye.Table("CFF ",[{name:"header",type:"RECORD"},{name:"nameIndex",type:"RECORD"},{name:"topDictIndex",type:"RECORD"},{name:"stringIndex",type:"RECORD"},{name:"globalSubrIndex",type:"RECORD"},{name:"charsets",type:"RECORD"},{name:"charStringsIndex",type:"RECORD"},{name:"privateDict",type:"RECORD"}]),n=1/t.unitsPerEm,s={version:t.version,fullName:t.fullName,familyName:t.familyName,weight:t.weightName,fontBBox:t.fontBBox||[0,0,0,0],fontMatrix:[n,0,0,n,0,0],charset:999,encoding:0,charStrings:999,private:[0,999]},i=[],o=1;o<e.length;o+=1)r=e.get(o),i.push(r.name);var c=[];a.header=new Ye.Record("Header",[{name:"major",type:"Card8",value:1},{name:"minor",type:"Card8",value:0},{name:"hdrSize",type:"Card8",value:4},{name:"major",type:"Card8",value:1}]),a.nameIndex=function(e){var t=new Ye.Record("Name INDEX",[{name:"names",type:"INDEX",value:[]}]);t.names=[];for(var r=0;r<e.length;r+=1)t.names.push({name:"name_"+r,type:"NAME",value:e[r]});return t}([t.postScriptName]);var l=Ot(s,c);a.topDictIndex=Ut(l),a.globalSubrIndex=new Ye.Record("Global Subr INDEX",[{name:"subrs",type:"INDEX",value:[]}]),a.charsets=function(e,t){for(var r=new Ye.Record("Charsets",[{name:"format",type:"Card8",value:0}]),a=0;a<e.length;a+=1){var n=Lt(e[a],t);r.fields.push({name:"glyph_"+a,type:"SID",value:n})}return r}(i,c),a.charStringsIndex=function(e){for(var t=new Ye.Record("CharStrings INDEX",[{name:"charStrings",type:"INDEX",value:[]}]),r=0;r<e.length;r+=1){var a=e.get(r),n=Gt(a);t.charStrings.push({name:a.name,type:"CHARSTRING",value:n})}return t}(e),a.privateDict=function(e,t){var r=new Ye.Record("Private DICT",[{name:"dict",type:"DICT",value:{}}]);return r.dict=Dt(It,e,t),r}({},c),a.stringIndex=function(e){var t=new Ye.Record("String INDEX",[{name:"strings",type:"INDEX",value:[]}]);t.strings=[];for(var r=0;r<e.length;r+=1)t.strings.push({name:"string_"+r,type:"STRING",value:e[r]});return t}(c);var u=a.header.sizeOf()+a.nameIndex.sizeOf()+a.topDictIndex.sizeOf()+a.stringIndex.sizeOf()+a.globalSubrIndex.sizeOf();return s.charset=u,s.encoding=0,s.charStrings=s.charset+a.charsets.sizeOf(),s.private[1]=s.charStrings+a.charStringsIndex.sizeOf(),l=Ot(s,c),a.topDictIndex=Ut(l),a}};var Pt={parse:function(e,t){var r={},a=new at.Parser(e,t);return r.version=a.parseVersion(),r.fontRevision=Math.round(1e3*a.parseFixed())/1e3,r.checkSumAdjustment=a.parseULong(),r.magicNumber=a.parseULong(),Ie.argument(1594834165===r.magicNumber,"Font header has wrong magic number."),r.flags=a.parseUShort(),r.unitsPerEm=a.parseUShort(),r.created=a.parseLongDateTime(),r.modified=a.parseLongDateTime(),r.xMin=a.parseShort(),r.yMin=a.parseShort(),r.xMax=a.parseShort(),r.yMax=a.parseShort(),r.macStyle=a.parseUShort(),r.lowestRecPPEM=a.parseUShort(),r.fontDirectionHint=a.parseShort(),r.indexToLocFormat=a.parseShort(),r.glyphDataFormat=a.parseShort(),r},make:function(e){var t=Math.round((new Date).getTime()/1e3)+2082844800,r=t;return e.createdTimestamp&&(r=e.createdTimestamp+2082844800),new Ye.Table("head",[{name:"version",type:"FIXED",value:65536},{name:"fontRevision",type:"FIXED",value:65536},{name:"checkSumAdjustment",type:"ULONG",value:0},{name:"magicNumber",type:"ULONG",value:1594834165},{name:"flags",type:"USHORT",value:0},{name:"unitsPerEm",type:"USHORT",value:1e3},{name:"created",type:"LONGDATETIME",value:r},{name:"modified",type:"LONGDATETIME",value:t},{name:"xMin",type:"SHORT",value:0},{name:"yMin",type:"SHORT",value:0},{name:"xMax",type:"SHORT",value:0},{name:"yMax",type:"SHORT",value:0},{name:"macStyle",type:"USHORT",value:0},{name:"lowestRecPPEM",type:"USHORT",value:0},{name:"fontDirectionHint",type:"SHORT",value:2},{name:"indexToLocFormat",type:"SHORT",value:0},{name:"glyphDataFormat",type:"SHORT",value:0}],e)}};var Ht={parse:function(e,t){var r={},a=new at.Parser(e,t);return r.version=a.parseVersion(),r.ascender=a.parseShort(),r.descender=a.parseShort(),r.lineGap=a.parseShort(),r.advanceWidthMax=a.parseUShort(),r.minLeftSideBearing=a.parseShort(),r.minRightSideBearing=a.parseShort(),r.xMaxExtent=a.parseShort(),r.caretSlopeRise=a.parseShort(),r.caretSlopeRun=a.parseShort(),r.caretOffset=a.parseShort(),a.relativeOffset+=8,r.metricDataFormat=a.parseShort(),r.numberOfHMetrics=a.parseUShort(),r},make:function(e){return new Ye.Table("hhea",[{name:"version",type:"FIXED",value:65536},{name:"ascender",type:"FWORD",value:0},{name:"descender",type:"FWORD",value:0},{name:"lineGap",type:"FWORD",value:0},{name:"advanceWidthMax",type:"UFWORD",value:0},{name:"minLeftSideBearing",type:"FWORD",value:0},{name:"minRightSideBearing",type:"FWORD",value:0},{name:"xMaxExtent",type:"FWORD",value:0},{name:"caretSlopeRise",type:"SHORT",value:1},{name:"caretSlopeRun",type:"SHORT",value:0},{name:"caretOffset",type:"SHORT",value:0},{name:"reserved1",type:"SHORT",value:0},{name:"reserved2",type:"SHORT",value:0},{name:"reserved3",type:"SHORT",value:0},{name:"reserved4",type:"SHORT",value:0},{name:"metricDataFormat",type:"SHORT",value:0},{name:"numberOfHMetrics",type:"USHORT",value:0}],e)}};var Jt={parse:function(e,t,r,a,n,s,i){i.lowMemory?function(e,t,r,a,n){var s,i;e._hmtxTableData={};for(var o=new at.Parser(t,r),c=0;c<n;c+=1)c<a&&(s=o.parseUShort(),i=o.parseShort()),e._hmtxTableData[c]={advanceWidth:s,leftSideBearing:i}}(e,t,r,a,n):function(e,t,r,a,n){for(var s,i,o=new at.Parser(e,t),c=0;c<a;c+=1){c<r&&(s=o.parseUShort(),i=o.parseShort());var l=n.get(c);l.advanceWidth=s,l.leftSideBearing=i}}(t,r,a,n,s)},make:function(e){for(var t=new Ye.Table("hmtx",[]),r=0;r<e.length;r+=1){var a=e.get(r),n=a.advanceWidth||0,s=a.leftSideBearing||0;t.fields.push({name:"advanceWidth_"+r,type:"USHORT",value:n}),t.fields.push({name:"leftSideBearing_"+r,type:"SHORT",value:s})}return t}};var _t={make:function(e){for(var t=new Ye.Table("ltag",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"numTags",type:"ULONG",value:e.length}]),r="",a=12+4*e.length,n=0;n<e.length;++n){var s=r.indexOf(e[n]);s<0&&(s=r.length,r+=e[n]),t.fields.push({name:"offset "+n,type:"USHORT",value:a+s}),t.fields.push({name:"length "+n,type:"USHORT",value:e[n].length})}return t.fields.push({name:"stringPool",type:"CHARARRAY",value:r}),t},parse:function(e,t){var r=new at.Parser(e,t),a=r.parseULong();Ie.argument(1===a,"Unsupported ltag table version."),r.skip("uLong",1);for(var n=r.parseULong(),s=[],i=0;i<n;i++){for(var o="",c=t+r.parseUShort(),l=r.parseUShort(),u=c;u<c+l;++u)o+=String.fromCharCode(e.getInt8(u));s.push(o)}return s}};var jt={parse:function(e,t){var r={},a=new at.Parser(e,t);return r.version=a.parseVersion(),r.numGlyphs=a.parseUShort(),1===r.version&&(r.maxPoints=a.parseUShort(),r.maxContours=a.parseUShort(),r.maxCompositePoints=a.parseUShort(),r.maxCompositeContours=a.parseUShort(),r.maxZones=a.parseUShort(),r.maxTwilightPoints=a.parseUShort(),r.maxStorage=a.parseUShort(),r.maxFunctionDefs=a.parseUShort(),r.maxInstructionDefs=a.parseUShort(),r.maxStackElements=a.parseUShort(),r.maxSizeOfInstructions=a.parseUShort(),r.maxComponentElements=a.parseUShort(),r.maxComponentDepth=a.parseUShort()),r},make:function(e){return new Ye.Table("maxp",[{name:"version",type:"FIXED",value:20480},{name:"numGlyphs",type:"USHORT",value:e}])}},Vt=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],Xt={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},Kt={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:5,11:1,12:4,13:0,14:6,15:0,16:0,17:0,18:0,19:2,20:4,21:9,22:21,23:3,24:29,25:29,26:29,27:29,28:29,29:0,30:0,31:4,32:7,33:25,34:0,35:0,36:0,37:0,38:29,39:29,40:0,41:5,42:7,43:7,44:7,45:7,46:7,47:7,48:7,49:7,50:4,51:24,52:23,53:7,54:7,55:7,56:7,57:27,58:7,59:4,60:4,61:4,62:4,63:26,64:9,65:9,66:9,67:13,68:13,69:11,70:10,71:12,72:17,73:16,74:14,75:15,76:18,77:19,78:20,79:22,80:30,81:0,82:0,83:0,84:4,85:28,86:28,87:28,88:0,89:0,90:0,91:0,92:0,93:0,94:0,128:0,129:0,130:0,131:0,132:0,133:0,134:0,135:7,136:4,137:26,138:0,139:0,140:0,141:0,142:0,143:28,144:0,145:0,146:0,147:0,148:6,149:0,150:0,151:0},zt={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"};function Wt(e,t,r){switch(e){case 0:if(65535===t)return"und";if(r)return r[t];break;case 1:return Xt[t];case 3:return zt[t]}}var Yt={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},Qt={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"};function qt(e,t,r){switch(e){case 0:return"utf-16";case 1:return Qt[r]||Yt[t];case 3:if(1===t||10===t)return"utf-16"}}function Zt(e){var t={};for(var r in e)t[e[r]]=parseInt(r);return t}function $t(e,t,r,a,n,s){return new Ye.Record("NameRecord",[{name:"platformID",type:"USHORT",value:e},{name:"encodingID",type:"USHORT",value:t},{name:"languageID",type:"USHORT",value:r},{name:"nameID",type:"USHORT",value:a},{name:"length",type:"USHORT",value:n},{name:"offset",type:"USHORT",value:s}])}function er(e,t){var r=function(e,t){var r=e.length,a=t.length-r+1;e:for(var n=0;n<a;n++)for(;n<a;n++){for(var s=0;s<r;s++)if(t[n+s]!==e[s])continue e;return n}return-1}(e,t);if(r<0){r=t.length;for(var a=0,n=e.length;a<n;++a)t.push(e[a])}return r}var tr={parse:function(e,t,r){for(var a={},n=new at.Parser(e,t),s=n.parseUShort(),i=n.parseUShort(),o=n.offset+n.parseUShort(),c=0;c<i;c++){var l=n.parseUShort(),u=n.parseUShort(),h=n.parseUShort(),p=n.parseUShort(),f=Vt[p]||p,d=n.parseUShort(),g=n.parseUShort(),m=Wt(l,h,r),v=qt(l,u,h);if(void 0!==v&&void 0!==m){var y=void 0;if(y="utf-16"===v?Me.UTF16(e,o+g,d):Me.MACSTRING(e,o+g,d,v)){var A=a[f];void 0===A&&(A=a[f]={}),A[m]=y}}}return 1===s&&n.parseUShort(),a},make:function(e,t){var r,a=[],n={},s=Zt(Vt);for(var i in e){var o=s[i];if(void 0===o&&(o=i),r=parseInt(o),isNaN(r))throw new Error('Name table entry "'+i+'" does not exist, see nameTableNames for complete list.');n[r]=e[i],a.push(r)}for(var c=Zt(Xt),l=Zt(zt),u=[],h=[],p=0;p<a.length;p++){var f=n[r=a[p]];for(var d in f){var g=f[d],m=1,v=c[d],y=Kt[v],A=qt(m,y,v),b=Te.MACSTRING(g,A);void 0===b&&(m=0,(v=t.indexOf(d))<0&&(v=t.length,t.push(d)),y=4,b=Te.UTF16(g));var B=er(b,h);u.push($t(m,y,v,r,b.length,B));var C=l[d];if(void 0!==C){var x=Te.UTF16(g),F=er(x,h);u.push($t(3,1,C,r,x.length,F))}}}u.sort((function(e,t){return e.platformID-t.platformID||e.encodingID-t.encodingID||e.languageID-t.languageID||e.nameID-t.nameID}));for(var w=new Ye.Table("name",[{name:"format",type:"USHORT",value:0},{name:"count",type:"USHORT",value:u.length},{name:"stringOffset",type:"USHORT",value:6+12*u.length}]),E=0;E<u.length;E++)w.fields.push({name:"record_"+E,type:"RECORD",value:u[E]});return w.fields.push({name:"strings",type:"LITERAL",value:h}),w}},rr=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}];var ar={parse:function(e,t){var r={},a=new at.Parser(e,t);r.version=a.parseUShort(),r.xAvgCharWidth=a.parseShort(),r.usWeightClass=a.parseUShort(),r.usWidthClass=a.parseUShort(),r.fsType=a.parseUShort(),r.ySubscriptXSize=a.parseShort(),r.ySubscriptYSize=a.parseShort(),r.ySubscriptXOffset=a.parseShort(),r.ySubscriptYOffset=a.parseShort(),r.ySuperscriptXSize=a.parseShort(),r.ySuperscriptYSize=a.parseShort(),r.ySuperscriptXOffset=a.parseShort(),r.ySuperscriptYOffset=a.parseShort(),r.yStrikeoutSize=a.parseShort(),r.yStrikeoutPosition=a.parseShort(),r.sFamilyClass=a.parseShort(),r.panose=[];for(var n=0;n<10;n++)r.panose[n]=a.parseByte();return r.ulUnicodeRange1=a.parseULong(),r.ulUnicodeRange2=a.parseULong(),r.ulUnicodeRange3=a.parseULong(),r.ulUnicodeRange4=a.parseULong(),r.achVendID=String.fromCharCode(a.parseByte(),a.parseByte(),a.parseByte(),a.parseByte()),r.fsSelection=a.parseUShort(),r.usFirstCharIndex=a.parseUShort(),r.usLastCharIndex=a.parseUShort(),r.sTypoAscender=a.parseShort(),r.sTypoDescender=a.parseShort(),r.sTypoLineGap=a.parseShort(),r.usWinAscent=a.parseUShort(),r.usWinDescent=a.parseUShort(),r.version>=1&&(r.ulCodePageRange1=a.parseULong(),r.ulCodePageRange2=a.parseULong()),r.version>=2&&(r.sxHeight=a.parseShort(),r.sCapHeight=a.parseShort(),r.usDefaultChar=a.parseUShort(),r.usBreakChar=a.parseUShort(),r.usMaxContent=a.parseUShort()),r},make:function(e){return new Ye.Table("OS/2",[{name:"version",type:"USHORT",value:3},{name:"xAvgCharWidth",type:"SHORT",value:0},{name:"usWeightClass",type:"USHORT",value:0},{name:"usWidthClass",type:"USHORT",value:0},{name:"fsType",type:"USHORT",value:0},{name:"ySubscriptXSize",type:"SHORT",value:650},{name:"ySubscriptYSize",type:"SHORT",value:699},{name:"ySubscriptXOffset",type:"SHORT",value:0},{name:"ySubscriptYOffset",type:"SHORT",value:140},{name:"ySuperscriptXSize",type:"SHORT",value:650},{name:"ySuperscriptYSize",type:"SHORT",value:699},{name:"ySuperscriptXOffset",type:"SHORT",value:0},{name:"ySuperscriptYOffset",type:"SHORT",value:479},{name:"yStrikeoutSize",type:"SHORT",value:49},{name:"yStrikeoutPosition",type:"SHORT",value:258},{name:"sFamilyClass",type:"SHORT",value:0},{name:"bFamilyType",type:"BYTE",value:0},{name:"bSerifStyle",type:"BYTE",value:0},{name:"bWeight",type:"BYTE",value:0},{name:"bProportion",type:"BYTE",value:0},{name:"bContrast",type:"BYTE",value:0},{name:"bStrokeVariation",type:"BYTE",value:0},{name:"bArmStyle",type:"BYTE",value:0},{name:"bLetterform",type:"BYTE",value:0},{name:"bMidline",type:"BYTE",value:0},{name:"bXHeight",type:"BYTE",value:0},{name:"ulUnicodeRange1",type:"ULONG",value:0},{name:"ulUnicodeRange2",type:"ULONG",value:0},{name:"ulUnicodeRange3",type:"ULONG",value:0},{name:"ulUnicodeRange4",type:"ULONG",value:0},{name:"achVendID",type:"CHARARRAY",value:"XXXX"},{name:"fsSelection",type:"USHORT",value:0},{name:"usFirstCharIndex",type:"USHORT",value:0},{name:"usLastCharIndex",type:"USHORT",value:0},{name:"sTypoAscender",type:"SHORT",value:0},{name:"sTypoDescender",type:"SHORT",value:0},{name:"sTypoLineGap",type:"SHORT",value:0},{name:"usWinAscent",type:"USHORT",value:0},{name:"usWinDescent",type:"USHORT",value:0},{name:"ulCodePageRange1",type:"ULONG",value:0},{name:"ulCodePageRange2",type:"ULONG",value:0},{name:"sxHeight",type:"SHORT",value:0},{name:"sCapHeight",type:"SHORT",value:0},{name:"usDefaultChar",type:"USHORT",value:0},{name:"usBreakChar",type:"USHORT",value:0},{name:"usMaxContext",type:"USHORT",value:0}],e)},unicodeRanges:rr,getUnicodeRange:function(e){for(var t=0;t<rr.length;t+=1){var r=rr[t];if(e>=r.begin&&e<r.end)return t}return-1}};var nr={parse:function(e,t){var r={},a=new at.Parser(e,t);switch(r.version=a.parseVersion(),r.italicAngle=a.parseFixed(),r.underlinePosition=a.parseShort(),r.underlineThickness=a.parseShort(),r.isFixedPitch=a.parseULong(),r.minMemType42=a.parseULong(),r.maxMemType42=a.parseULong(),r.minMemType1=a.parseULong(),r.maxMemType1=a.parseULong(),r.version){case 1:r.names=lt.slice();break;case 2:r.numberOfGlyphs=a.parseUShort(),r.glyphNameIndex=new Array(r.numberOfGlyphs);for(var n=0;n<r.numberOfGlyphs;n++)r.glyphNameIndex[n]=a.parseUShort();r.names=[];for(var s=0;s<r.numberOfGlyphs;s++)if(r.glyphNameIndex[s]>=lt.length){var i=a.parseChar();r.names.push(a.parseString(i))}break;case 2.5:r.numberOfGlyphs=a.parseUShort(),r.offset=new Array(r.numberOfGlyphs);for(var o=0;o<r.numberOfGlyphs;o++)r.offset[o]=a.parseChar()}return r},make:function(){return new Ye.Table("post",[{name:"version",type:"FIXED",value:196608},{name:"italicAngle",type:"FIXED",value:0},{name:"underlinePosition",type:"FWORD",value:0},{name:"underlineThickness",type:"FWORD",value:0},{name:"isFixedPitch",type:"ULONG",value:0},{name:"minMemType42",type:"ULONG",value:0},{name:"maxMemType42",type:"ULONG",value:0},{name:"minMemType1",type:"ULONG",value:0},{name:"maxMemType1",type:"ULONG",value:0}])}},sr=new Array(9);sr[1]=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort();return 1===t?{substFormat:1,coverage:this.parsePointer(tt.coverage),deltaGlyphId:this.parseUShort()}:2===t?{substFormat:2,coverage:this.parsePointer(tt.coverage),substitute:this.parseOffset16List()}:void Ie.assert(!1,"0x"+e.toString(16)+": lookup type 1 format must be 1 or 2.")},sr[2]=function(){var e=this.parseUShort();return Ie.argument(1===e,"GSUB Multiple Substitution Subtable identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(tt.coverage),sequences:this.parseListOfLists()}},sr[3]=function(){var e=this.parseUShort();return Ie.argument(1===e,"GSUB Alternate Substitution Subtable identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(tt.coverage),alternateSets:this.parseListOfLists()}},sr[4]=function(){var e=this.parseUShort();return Ie.argument(1===e,"GSUB ligature table identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(tt.coverage),ligatureSets:this.parseListOfLists((function(){return{ligGlyph:this.parseUShort(),components:this.parseUShortList(this.parseUShort()-1)}}))}};var ir={sequenceIndex:tt.uShort,lookupListIndex:tt.uShort};sr[5]=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort();if(1===t)return{substFormat:t,coverage:this.parsePointer(tt.coverage),ruleSets:this.parseListOfLists((function(){var e=this.parseUShort(),t=this.parseUShort();return{input:this.parseUShortList(e-1),lookupRecords:this.parseRecordList(t,ir)}}))};if(2===t)return{substFormat:t,coverage:this.parsePointer(tt.coverage),classDef:this.parsePointer(tt.classDef),classSets:this.parseListOfLists((function(){var e=this.parseUShort(),t=this.parseUShort();return{classes:this.parseUShortList(e-1),lookupRecords:this.parseRecordList(t,ir)}}))};if(3===t){var r=this.parseUShort(),a=this.parseUShort();return{substFormat:t,coverages:this.parseList(r,tt.pointer(tt.coverage)),lookupRecords:this.parseRecordList(a,ir)}}Ie.assert(!1,"0x"+e.toString(16)+": lookup type 5 format must be 1, 2 or 3.")},sr[6]=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort();return 1===t?{substFormat:1,coverage:this.parsePointer(tt.coverage),chainRuleSets:this.parseListOfLists((function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(ir)}}))}:2===t?{substFormat:2,coverage:this.parsePointer(tt.coverage),backtrackClassDef:this.parsePointer(tt.classDef),inputClassDef:this.parsePointer(tt.classDef),lookaheadClassDef:this.parsePointer(tt.classDef),chainClassSet:this.parseListOfLists((function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(ir)}}))}:3===t?{substFormat:3,backtrackCoverage:this.parseList(tt.pointer(tt.coverage)),inputCoverage:this.parseList(tt.pointer(tt.coverage)),lookaheadCoverage:this.parseList(tt.pointer(tt.coverage)),lookupRecords:this.parseRecordList(ir)}:void Ie.assert(!1,"0x"+e.toString(16)+": lookup type 6 format must be 1, 2 or 3.")},sr[7]=function(){var e=this.parseUShort();Ie.argument(1===e,"GSUB Extension Substitution subtable identifier-format must be 1");var t=this.parseUShort(),r=new tt(this.data,this.offset+this.parseULong());return{substFormat:1,lookupType:t,extension:sr[t].call(r)}},sr[8]=function(){var e=this.parseUShort();return Ie.argument(1===e,"GSUB Reverse Chaining Contextual Single Substitution Subtable identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(tt.coverage),backtrackCoverage:this.parseList(tt.pointer(tt.coverage)),lookaheadCoverage:this.parseList(tt.pointer(tt.coverage)),substitutes:this.parseUShortList()}};var or=new Array(9);or[1]=function(e){return 1===e.substFormat?new Ye.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new Ye.Coverage(e.coverage)},{name:"deltaGlyphID",type:"USHORT",value:e.deltaGlyphId}]):new Ye.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:2},{name:"coverage",type:"TABLE",value:new Ye.Coverage(e.coverage)}].concat(Ye.ushortList("substitute",e.substitute)))},or[3]=function(e){return Ie.assert(1===e.substFormat,"Lookup type 3 substFormat must be 1."),new Ye.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new Ye.Coverage(e.coverage)}].concat(Ye.tableList("altSet",e.alternateSets,(function(e){return new Ye.Table("alternateSetTable",Ye.ushortList("alternate",e))}))))},or[4]=function(e){return Ie.assert(1===e.substFormat,"Lookup type 4 substFormat must be 1."),new Ye.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new Ye.Coverage(e.coverage)}].concat(Ye.tableList("ligSet",e.ligatureSets,(function(e){return new Ye.Table("ligatureSetTable",Ye.tableList("ligature",e,(function(e){return new Ye.Table("ligatureTable",[{name:"ligGlyph",type:"USHORT",value:e.ligGlyph}].concat(Ye.ushortList("component",e.components,e.components.length+1)))})))}))))};var cr={parse:function(e,t){var r=new tt(e,t=t||0),a=r.parseVersion(1);return Ie.argument(1===a||1.1===a,"Unsupported GSUB table version."),1===a?{version:a,scripts:r.parseScriptList(),features:r.parseFeatureList(),lookups:r.parseLookupList(sr)}:{version:a,scripts:r.parseScriptList(),features:r.parseFeatureList(),lookups:r.parseLookupList(sr),variations:r.parseFeatureVariationsList()}},make:function(e){return new Ye.Table("GSUB",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new Ye.ScriptList(e.scripts)},{name:"features",type:"TABLE",value:new Ye.FeatureList(e.features)},{name:"lookups",type:"TABLE",value:new Ye.LookupList(e.lookups,or)}])}};var lr={parse:function(e,t){var r=new at.Parser(e,t),a=r.parseULong();Ie.argument(1===a,"Unsupported META table version."),r.parseULong(),r.parseULong();for(var n=r.parseULong(),s={},i=0;i<n;i++){var o=r.parseTag(),c=r.parseULong(),l=r.parseULong(),u=Me.UTF8(e,t+c,l);s[o]=u}return s},make:function(e){var t=Object.keys(e).length,r="",a=16+12*t,n=new Ye.Table("meta",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"offset",type:"ULONG",value:a},{name:"numTags",type:"ULONG",value:t}]);for(var s in e){var i=r.length;r+=e[s],n.fields.push({name:"tag "+s,type:"TAG",value:s}),n.fields.push({name:"offset "+s,type:"ULONG",value:a+i}),n.fields.push({name:"length "+s,type:"ULONG",value:e[s].length})}return n.fields.push({name:"stringPool",type:"CHARARRAY",value:r}),n}};function ur(e){return Math.log(e)/Math.log(2)|0}function hr(e){for(;e.length%4!=0;)e.push(0);for(var t=0,r=0;r<e.length;r+=4)t+=(e[r]<<24)+(e[r+1]<<16)+(e[r+2]<<8)+e[r+3];return t%=Math.pow(2,32)}function pr(e,t,r,a){return new Ye.Record("Table Record",[{name:"tag",type:"TAG",value:void 0!==e?e:""},{name:"checkSum",type:"ULONG",value:void 0!==t?t:0},{name:"offset",type:"ULONG",value:void 0!==r?r:0},{name:"length",type:"ULONG",value:void 0!==a?a:0}])}function fr(e){var t=new Ye.Table("sfnt",[{name:"version",type:"TAG",value:"OTTO"},{name:"numTables",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);t.tables=e,t.numTables=e.length;var r=Math.pow(2,ur(t.numTables));t.searchRange=16*r,t.entrySelector=ur(r),t.rangeShift=16*t.numTables-t.searchRange;for(var a=[],n=[],s=t.sizeOf()+pr().sizeOf()*t.numTables;s%4!=0;)s+=1,n.push({name:"padding",type:"BYTE",value:0});for(var i=0;i<e.length;i+=1){var o=e[i];Ie.argument(4===o.tableName.length,"Table name"+o.tableName+" is invalid.");var c=o.sizeOf(),l=pr(o.tableName,hr(o.encode()),s,c);for(a.push({name:l.tag+" Table Record",type:"RECORD",value:l}),n.push({name:o.tableName+" table",type:"RECORD",value:o}),s+=c,Ie.argument(!isNaN(s),"Something went wrong calculating the offset.");s%4!=0;)s+=1,n.push({name:"padding",type:"BYTE",value:0})}return a.sort((function(e,t){return e.value.tag>t.value.tag?1:-1})),t.fields=t.fields.concat(a),t.fields=t.fields.concat(n),t}function dr(e,t,r){for(var a=0;a<t.length;a+=1){var n=e.charToGlyphIndex(t[a]);if(n>0)return e.glyphs.get(n).getMetrics()}return r}function gr(e){for(var t=0,r=0;r<e.length;r+=1)t+=e[r];return t/e.length}var mr={make:fr,fontToTable:function(e){for(var t,r=[],a=[],n=[],s=[],i=[],o=[],c=[],l=0,u=0,h=0,p=0,f=0,d=0;d<e.glyphs.length;d+=1){var g=e.glyphs.get(d),m=0|g.unicode;if(isNaN(g.advanceWidth))throw new Error("Glyph "+g.name+" ("+d+"): advanceWidth is not a number.");(t>m||void 0===t)&&m>0&&(t=m),l<m&&(l=m);var v=ar.getUnicodeRange(m);if(v<32)u|=1<<v;else if(v<64)h|=1<<v-32;else if(v<96)p|=1<<v-64;else{if(!(v<123))throw new Error("Unicode ranges bits > 123 are reserved for internal usage");f|=1<<v-96}if(".notdef"!==g.name){var y=g.getMetrics();r.push(y.xMin),a.push(y.yMin),n.push(y.xMax),s.push(y.yMax),o.push(y.leftSideBearing),c.push(y.rightSideBearing),i.push(g.advanceWidth)}}var A={xMin:Math.min.apply(null,r),yMin:Math.min.apply(null,a),xMax:Math.max.apply(null,n),yMax:Math.max.apply(null,s),advanceWidthMax:Math.max.apply(null,i),advanceWidthAvg:gr(i),minLeftSideBearing:Math.min.apply(null,o),maxLeftSideBearing:Math.max.apply(null,o),minRightSideBearing:Math.min.apply(null,c)};A.ascender=e.ascender,A.descender=e.descender;var b=Pt.make({flags:3,unitsPerEm:e.unitsPerEm,xMin:A.xMin,yMin:A.yMin,xMax:A.xMax,yMax:A.yMax,lowestRecPPEM:3,createdTimestamp:e.createdTimestamp}),B=Ht.make({ascender:A.ascender,descender:A.descender,advanceWidthMax:A.advanceWidthMax,minLeftSideBearing:A.minLeftSideBearing,minRightSideBearing:A.minRightSideBearing,xMaxExtent:A.maxLeftSideBearing+(A.xMax-A.xMin),numberOfHMetrics:e.glyphs.length}),C=jt.make(e.glyphs.length),x=ar.make(Object.assign({xAvgCharWidth:Math.round(A.advanceWidthAvg),usFirstCharIndex:t,usLastCharIndex:l,ulUnicodeRange1:u,ulUnicodeRange2:h,ulUnicodeRange3:p,ulUnicodeRange4:f,sTypoAscender:A.ascender,sTypoDescender:A.descender,sTypoLineGap:0,usWinAscent:A.yMax,usWinDescent:Math.abs(A.yMin),ulCodePageRange1:1,sxHeight:dr(e,"xyvw",{yMax:Math.round(A.ascender/2)}).yMax,sCapHeight:dr(e,"HIKLEFJMNTZBDPRAGOQSUVWXY",A).yMax,usDefaultChar:e.hasChar(" ")?32:0,usBreakChar:e.hasChar(" ")?32:0},e.tables.os2)),F=Jt.make(e.glyphs),w=st.make(e.glyphs),E=e.getEnglishName("fontFamily"),S=e.getEnglishName("fontSubfamily"),I=E+" "+S,M=e.getEnglishName("postScriptName");M||(M=E.replace(/\s/g,"")+"-"+S);var T={};for(var k in e.names)T[k]=e.names[k];T.uniqueID||(T.uniqueID={en:e.getEnglishName("manufacturer")+":"+I}),T.postScriptName||(T.postScriptName={en:M}),T.preferredFamily||(T.preferredFamily=e.names.fontFamily),T.preferredSubfamily||(T.preferredSubfamily=e.names.fontSubfamily);var R=[],L=tr.make(T,R),D=R.length>0?_t.make(R):void 0,O=nr.make(),U=Nt.make(e.glyphs,{version:e.getEnglishName("version"),fullName:I,familyName:E,weightName:S,postScriptName:M,unitsPerEm:e.unitsPerEm,fontBBox:[0,A.yMin,A.ascender,A.advanceWidthMax]}),G=e.metas&&Object.keys(e.metas).length>0?lr.make(e.metas):void 0,N=[b,B,C,x,L,w,O,U,F];D&&N.push(D),e.tables.gsub&&N.push(cr.make(e.tables.gsub)),G&&N.push(G);for(var P=fr(N),H=hr(P.encode()),J=P.fields,_=!1,j=0;j<J.length;j+=1)if("head table"===J[j].name){J[j].value.checkSumAdjustment=2981146554-H,_=!0;break}if(!_)throw new Error("Could not find head table with checkSum to adjust.");return P},computeCheckSum:hr};function vr(e,t){for(var r=0,a=e.length-1;r<=a;){var n=r+a>>>1,s=e[n].tag;if(s===t)return n;s<t?r=n+1:a=n-1}return-r-1}function yr(e,t){for(var r=0,a=e.length-1;r<=a;){var n=r+a>>>1,s=e[n];if(s===t)return n;s<t?r=n+1:a=n-1}return-r-1}function Ar(e,t){for(var r,a=0,n=e.length-1;a<=n;){var s=a+n>>>1,i=(r=e[s]).start;if(i===t)return r;i<t?a=s+1:n=s-1}if(a>0)return t>(r=e[a-1]).end?0:r}function br(e,t){this.font=e,this.tableName=t}function Br(e){br.call(this,e,"gpos")}function Cr(e){br.call(this,e,"gsub")}function xr(e,t){var r=e.length;if(r!==t.length)return!1;for(var a=0;a<r;a++)if(e[a]!==t[a])return!1;return!0}function Fr(e,t,r){for(var a=e.subtables,n=0;n<a.length;n++){var s=a[n];if(s.substFormat===t)return s}if(r)return a.push(r),r}function wr(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a<e.length;++a)r[a]=e[a];return t}function Er(e,t){if(!e)throw t}function Sr(e,t,r,a,n){var s;return(t&a)>0?(s=e.parseByte(),0==(t&n)&&(s=-s),s=r+s):s=(t&n)>0?r:r+e.parseShort(),s}function Ir(e,t,r){var a,n,s=new at.Parser(t,r);if(e.numberOfContours=s.parseShort(),e._xMin=s.parseShort(),e._yMin=s.parseShort(),e._xMax=s.parseShort(),e._yMax=s.parseShort(),e.numberOfContours>0){for(var i=e.endPointIndices=[],o=0;o<e.numberOfContours;o+=1)i.push(s.parseUShort());e.instructionLength=s.parseUShort(),e.instructions=[];for(var c=0;c<e.instructionLength;c+=1)e.instructions.push(s.parseByte());var l=i[i.length-1]+1;a=[];for(var u=0;u<l;u+=1)if(n=s.parseByte(),a.push(n),(8&n)>0)for(var h=s.parseByte(),p=0;p<h;p+=1)a.push(n),u+=1;if(Ie.argument(a.length===l,"Bad flags."),i.length>0){var f,d=[];if(l>0){for(var g=0;g<l;g+=1)n=a[g],(f={}).onCurve=!!(1&n),f.lastPointOfContour=i.indexOf(g)>=0,d.push(f);for(var m=0,v=0;v<l;v+=1)n=a[v],(f=d[v]).x=Sr(s,n,m,2,16),m=f.x;for(var y=0,A=0;A<l;A+=1)n=a[A],(f=d[A]).y=Sr(s,n,y,4,32),y=f.y}e.points=d}else e.points=[]}else if(0===e.numberOfContours)e.points=[];else{e.isComposite=!0,e.points=[],e.components=[];for(var b=!0;b;){a=s.parseUShort();var B={glyphIndex:s.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0};(1&a)>0?(2&a)>0?(B.dx=s.parseShort(),B.dy=s.parseShort()):B.matchedPoints=[s.parseUShort(),s.parseUShort()]:(2&a)>0?(B.dx=s.parseChar(),B.dy=s.parseChar()):B.matchedPoints=[s.parseByte(),s.parseByte()],(8&a)>0?B.xScale=B.yScale=s.parseF2Dot14():(64&a)>0?(B.xScale=s.parseF2Dot14(),B.yScale=s.parseF2Dot14()):(128&a)>0&&(B.xScale=s.parseF2Dot14(),B.scale01=s.parseF2Dot14(),B.scale10=s.parseF2Dot14(),B.yScale=s.parseF2Dot14()),e.components.push(B),b=!!(32&a)}if(256&a){e.instructionLength=s.parseUShort(),e.instructions=[];for(var C=0;C<e.instructionLength;C+=1)e.instructions.push(s.parseByte())}}}function Mr(e,t){for(var r=[],a=0;a<e.length;a+=1){var n=e[a],s={x:t.xScale*n.x+t.scale01*n.y+t.dx,y:t.scale10*n.x+t.yScale*n.y+t.dy,onCurve:n.onCurve,lastPointOfContour:n.lastPointOfContour};r.push(s)}return r}function Tr(e){var t=new we;if(!e)return t;for(var r=function(e){for(var t=[],r=[],a=0;a<e.length;a+=1){var n=e[a];r.push(n),n.lastPointOfContour&&(t.push(r),r=[])}return Ie.argument(0===r.length,"There are still points left in the current contour."),t}(e),a=0;a<r.length;++a){var n=r[a],s=null,i=n[n.length-1],o=n[0];if(i.onCurve)t.moveTo(i.x,i.y);else if(o.onCurve)t.moveTo(o.x,o.y);else{var c={x:.5*(i.x+o.x),y:.5*(i.y+o.y)};t.moveTo(c.x,c.y)}for(var l=0;l<n.length;++l)if(s=i,i=o,o=n[(l+1)%n.length],i.onCurve)t.lineTo(i.x,i.y);else{var u=o;s.onCurve||(i.x,s.x,i.y,s.y),o.onCurve||(u={x:.5*(i.x+o.x),y:.5*(i.y+o.y)}),t.quadraticCurveTo(i.x,i.y,u.x,u.y)}t.closePath()}return t}function kr(e,t){if(t.isComposite)for(var r=0;r<t.components.length;r+=1){var a=t.components[r],n=e.get(a.glyphIndex);if(n.getPath(),n.points){var s=void 0;if(void 0===a.matchedPoints)s=Mr(n.points,a);else{if(a.matchedPoints[0]>t.points.length-1||a.matchedPoints[1]>n.points.length-1)throw Error("Matched points out of range in "+t.name);var i=t.points[a.matchedPoints[0]],o=n.points[a.matchedPoints[1]],c={xScale:a.xScale,scale01:a.scale01,scale10:a.scale10,yScale:a.yScale,dx:0,dy:0};o=Mr([o],c)[0],c.dx=i.x-o.x,c.dy=i.y-o.y,s=Mr(n.points,c)}t.points=t.points.concat(s)}}return Tr(t.points)}br.prototype={searchTag:vr,binSearch:yr,getTable:function(e){var t=this.font.tables[this.tableName];return!t&&e&&(t=this.font.tables[this.tableName]=this.createDefaultTable()),t},getScriptNames:function(){var e=this.getTable();return e?e.scripts.map((function(e){return e.tag})):[]},getDefaultScriptName:function(){var e=this.getTable();if(e){for(var t=!1,r=0;r<e.scripts.length;r++){var a=e.scripts[r].tag;if("DFLT"===a)return a;"latn"===a&&(t=!0)}return t?"latn":void 0}},getScriptTable:function(e,t){var r=this.getTable(t);if(r){e=e||"DFLT";var a=r.scripts,n=vr(r.scripts,e);if(n>=0)return a[n].script;if(t){var s={tag:e,script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}};return a.splice(-1-n,0,s),s.script}}},getLangSysTable:function(e,t,r){var a=this.getScriptTable(e,r);if(a){if(!t||"dflt"===t||"DFLT"===t)return a.defaultLangSys;var n=vr(a.langSysRecords,t);if(n>=0)return a.langSysRecords[n].langSys;if(r){var s={tag:t,langSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]}};return a.langSysRecords.splice(-1-n,0,s),s.langSys}}},getFeatureTable:function(e,t,r,a){var n=this.getLangSysTable(e,t,a);if(n){for(var s,i=n.featureIndexes,o=this.font.tables[this.tableName].features,c=0;c<i.length;c++)if((s=o[i[c]]).tag===r)return s.feature;if(a){var l=o.length;return Ie.assert(0===l||r>=o[l-1].tag,"Features must be added in alphabetical order."),s={tag:r,feature:{params:0,lookupListIndexes:[]}},o.push(s),i.push(l),s.feature}}},getLookupTables:function(e,t,r,a,n){var s=this.getFeatureTable(e,t,r,n),i=[];if(s){for(var o,c=s.lookupListIndexes,l=this.font.tables[this.tableName].lookups,u=0;u<c.length;u++)(o=l[c[u]]).lookupType===a&&i.push(o);if(0===i.length&&n){o={lookupType:a,lookupFlag:0,subtables:[],markFilteringSet:void 0};var h=l.length;return l.push(o),c.push(h),[o]}}return i},getGlyphClass:function(e,t){switch(e.format){case 1:return e.startGlyph<=t&&t<e.startGlyph+e.classes.length?e.classes[t-e.startGlyph]:0;case 2:var r=Ar(e.ranges,t);return r?r.classId:0}},getCoverageIndex:function(e,t){switch(e.format){case 1:var r=yr(e.glyphs,t);return r>=0?r:-1;case 2:var a=Ar(e.ranges,t);return a?a.index+t-a.start:-1}},expandCoverage:function(e){if(1===e.format)return e.glyphs;for(var t=[],r=e.ranges,a=0;a<r.length;a++)for(var n=r[a],s=n.start,i=n.end,o=s;o<=i;o++)t.push(o);return t}},Br.prototype=br.prototype,Br.prototype.init=function(){var e=this.getDefaultScriptName();this.defaultKerningTables=this.getKerningTables(e)},Br.prototype.getKerningValue=function(e,t,r){for(var a=0;a<e.length;a++)for(var n=e[a].subtables,s=0;s<n.length;s++){var i=n[s],o=this.getCoverageIndex(i.coverage,t);if(!(o<0))switch(i.posFormat){case 1:for(var c=i.pairSets[o],l=0;l<c.length;l++){var u=c[l];if(u.secondGlyph===r)return u.value1&&u.value1.xAdvance||0}break;case 2:var h=this.getGlyphClass(i.classDef1,t),p=this.getGlyphClass(i.classDef2,r),f=i.classRecords[h][p];return f.value1&&f.value1.xAdvance||0}}return 0},Br.prototype.getKerningTables=function(e,t){if(this.font.tables.gpos)return this.getLookupTables(e,t,"kern",2)},Cr.prototype=br.prototype,Cr.prototype.createDefaultTable=function(){return{version:1,scripts:[{tag:"DFLT",script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}}],features:[],lookups:[]}},Cr.prototype.getSingle=function(e,t,r){for(var a=[],n=this.getLookupTables(t,r,e,1),s=0;s<n.length;s++)for(var i=n[s].subtables,o=0;o<i.length;o++){var c=i[o],l=this.expandCoverage(c.coverage),u=void 0;if(1===c.substFormat){var h=c.deltaGlyphId;for(u=0;u<l.length;u++){var p=l[u];a.push({sub:p,by:p+h})}}else{var f=c.substitute;for(u=0;u<l.length;u++)a.push({sub:l[u],by:f[u]})}}return a},Cr.prototype.getAlternates=function(e,t,r){for(var a=[],n=this.getLookupTables(t,r,e,3),s=0;s<n.length;s++)for(var i=n[s].subtables,o=0;o<i.length;o++)for(var c=i[o],l=this.expandCoverage(c.coverage),u=c.alternateSets,h=0;h<l.length;h++)a.push({sub:l[h],by:u[h]});return a},Cr.prototype.getLigatures=function(e,t,r){for(var a=[],n=this.getLookupTables(t,r,e,4),s=0;s<n.length;s++)for(var i=n[s].subtables,o=0;o<i.length;o++)for(var c=i[o],l=this.expandCoverage(c.coverage),u=c.ligatureSets,h=0;h<l.length;h++)for(var p=l[h],f=u[h],d=0;d<f.length;d++){var g=f[d];a.push({sub:[p].concat(g.components),by:g.ligGlyph})}return a},Cr.prototype.addSingle=function(e,t,r,a){var n=Fr(this.getLookupTables(r,a,e,1,!0)[0],2,{substFormat:2,coverage:{format:1,glyphs:[]},substitute:[]});Ie.assert(1===n.coverage.format,"Ligature: unable to modify coverage table format "+n.coverage.format);var s=t.sub,i=this.binSearch(n.coverage.glyphs,s);i<0&&(i=-1-i,n.coverage.glyphs.splice(i,0,s),n.substitute.splice(i,0,0)),n.substitute[i]=t.by},Cr.prototype.addAlternate=function(e,t,r,a){var n=Fr(this.getLookupTables(r,a,e,3,!0)[0],1,{substFormat:1,coverage:{format:1,glyphs:[]},alternateSets:[]});Ie.assert(1===n.coverage.format,"Ligature: unable to modify coverage table format "+n.coverage.format);var s=t.sub,i=this.binSearch(n.coverage.glyphs,s);i<0&&(i=-1-i,n.coverage.glyphs.splice(i,0,s),n.alternateSets.splice(i,0,0)),n.alternateSets[i]=t.by},Cr.prototype.addLigature=function(e,t,r,a){var n=this.getLookupTables(r,a,e,4,!0)[0],s=n.subtables[0];s||(s={substFormat:1,coverage:{format:1,glyphs:[]},ligatureSets:[]},n.subtables[0]=s),Ie.assert(1===s.coverage.format,"Ligature: unable to modify coverage table format "+s.coverage.format);var i=t.sub[0],o=t.sub.slice(1),c={ligGlyph:t.by,components:o},l=this.binSearch(s.coverage.glyphs,i);if(l>=0){for(var u=s.ligatureSets[l],h=0;h<u.length;h++)if(xr(u[h].components,o))return;u.push(c)}else l=-1-l,s.coverage.glyphs.splice(l,0,i),s.ligatureSets.splice(l,0,[c])},Cr.prototype.getFeature=function(e,t,r){if(/ss\d\d/.test(e))return this.getSingle(e,t,r);switch(e){case"aalt":case"salt":return this.getSingle(e,t,r).concat(this.getAlternates(e,t,r));case"dlig":case"liga":case"rlig":return this.getLigatures(e,t,r)}},Cr.prototype.add=function(e,t,r,a){if(/ss\d\d/.test(e))return this.addSingle(e,t,r,a);switch(e){case"aalt":case"salt":return"number"==typeof t.by?this.addSingle(e,t,r,a):this.addAlternate(e,t,r,a);case"dlig":case"liga":case"rlig":return this.addLigature(e,t,r,a)}};var Rr,Lr,Dr,Or,Ur={getPath:Tr,parse:function(e,t,r,a,n){return n.lowMemory?function(e,t,r,a){var n=new At.GlyphSet(a);return a._push=function(s){var i=r[s];i!==r[s+1]?n.push(s,At.ttfGlyphLoader(a,s,Ir,e,t+i,kr)):n.push(s,At.glyphLoader(a,s))},n}(e,t,r,a):function(e,t,r,a){for(var n=new At.GlyphSet(a),s=0;s<r.length-1;s+=1){var i=r[s];i!==r[s+1]?n.push(s,At.ttfGlyphLoader(a,s,Ir,e,t+i,kr)):n.push(s,At.glyphLoader(a,s))}return n}(e,t,r,a)}};function Gr(e){this.font=e,this.getCommands=function(e){return Ur.getPath(e).commands},this._fpgmState=this._prepState=void 0,this._errorState=0}function Nr(e){return e}function Pr(e){return Math.sign(e)*Math.round(Math.abs(e))}function Hr(e){return Math.sign(e)*Math.round(Math.abs(2*e))/2}function Jr(e){return Math.sign(e)*(Math.round(Math.abs(e)+.5)-.5)}function _r(e){return Math.sign(e)*Math.ceil(Math.abs(e))}function jr(e){return Math.sign(e)*Math.floor(Math.abs(e))}var Vr=function(e){var t=this.srPeriod,r=this.srPhase,a=1;return e<0&&(e=-e,a=-1),e+=this.srThreshold-r,e=Math.trunc(e/t)*t,(e+=r)<0?r*a:e*a},Xr={x:1,y:0,axis:"x",distance:function(e,t,r,a){return(r?e.xo:e.x)-(a?t.xo:t.x)},interpolate:function(e,t,r,a){var n,s,i,o,c,l,u;if(!a||a===this)return n=e.xo-t.xo,s=e.xo-r.xo,c=t.x-t.xo,l=r.x-r.xo,0===(u=(i=Math.abs(n))+(o=Math.abs(s)))?void(e.x=e.xo+(c+l)/2):void(e.x=e.xo+(c*o+l*i)/u);n=a.distance(e,t,!0,!0),s=a.distance(e,r,!0,!0),c=a.distance(t,t,!1,!0),l=a.distance(r,r,!1,!0),0!==(u=(i=Math.abs(n))+(o=Math.abs(s)))?Xr.setRelative(e,e,(c*o+l*i)/u,a,!0):Xr.setRelative(e,e,(c+l)/2,a,!0)},normalSlope:Number.NEGATIVE_INFINITY,setRelative:function(e,t,r,a,n){if(a&&a!==this){var s=n?t.xo:t.x,i=n?t.yo:t.y,o=s+r*a.x,c=i+r*a.y;e.x=o+(e.y-c)/a.normalSlope}else e.x=(n?t.xo:t.x)+r},slope:0,touch:function(e){e.xTouched=!0},touched:function(e){return e.xTouched},untouch:function(e){e.xTouched=!1}},Kr={x:0,y:1,axis:"y",distance:function(e,t,r,a){return(r?e.yo:e.y)-(a?t.yo:t.y)},interpolate:function(e,t,r,a){var n,s,i,o,c,l,u;if(!a||a===this)return n=e.yo-t.yo,s=e.yo-r.yo,c=t.y-t.yo,l=r.y-r.yo,0===(u=(i=Math.abs(n))+(o=Math.abs(s)))?void(e.y=e.yo+(c+l)/2):void(e.y=e.yo+(c*o+l*i)/u);n=a.distance(e,t,!0,!0),s=a.distance(e,r,!0,!0),c=a.distance(t,t,!1,!0),l=a.distance(r,r,!1,!0),0!==(u=(i=Math.abs(n))+(o=Math.abs(s)))?Kr.setRelative(e,e,(c*o+l*i)/u,a,!0):Kr.setRelative(e,e,(c+l)/2,a,!0)},normalSlope:0,setRelative:function(e,t,r,a,n){if(a&&a!==this){var s=n?t.xo:t.x,i=n?t.yo:t.y,o=s+r*a.x,c=i+r*a.y;e.y=c+a.normalSlope*(e.x-o)}else e.y=(n?t.yo:t.y)+r},slope:Number.POSITIVE_INFINITY,touch:function(e){e.yTouched=!0},touched:function(e){return e.yTouched},untouch:function(e){e.yTouched=!1}};function zr(e,t){this.x=e,this.y=t,this.axis=void 0,this.slope=t/e,this.normalSlope=-e/t,Object.freeze(this)}function Wr(e,t){var r=Math.sqrt(e*e+t*t);return t/=r,1===(e/=r)&&0===t?Xr:0===e&&1===t?Kr:new zr(e,t)}function Yr(e,t,r,a){this.x=this.xo=Math.round(64*e)/64,this.y=this.yo=Math.round(64*t)/64,this.lastPointOfContour=r,this.onCurve=a,this.prevPointOnContour=void 0,this.nextPointOnContour=void 0,this.xTouched=!1,this.yTouched=!1,Object.preventExtensions(this)}Object.freeze(Xr),Object.freeze(Kr),zr.prototype.distance=function(e,t,r,a){return this.x*Xr.distance(e,t,r,a)+this.y*Kr.distance(e,t,r,a)},zr.prototype.interpolate=function(e,t,r,a){var n,s,i,o,c,l,u;i=a.distance(e,t,!0,!0),o=a.distance(e,r,!0,!0),n=a.distance(t,t,!1,!0),s=a.distance(r,r,!1,!0),0!==(u=(c=Math.abs(i))+(l=Math.abs(o)))?this.setRelative(e,e,(n*l+s*c)/u,a,!0):this.setRelative(e,e,(n+s)/2,a,!0)},zr.prototype.setRelative=function(e,t,r,a,n){a=a||this;var s=n?t.xo:t.x,i=n?t.yo:t.y,o=s+r*a.x,c=i+r*a.y,l=a.normalSlope,u=this.slope,h=e.x,p=e.y;e.x=(u*h-l*o+c-p)/(u-l),e.y=u*(e.x-h)+p},zr.prototype.touch=function(e){e.xTouched=!0,e.yTouched=!0},Yr.prototype.nextTouched=function(e){for(var t=this.nextPointOnContour;!e.touched(t)&&t!==this;)t=t.nextPointOnContour;return t},Yr.prototype.prevTouched=function(e){for(var t=this.prevPointOnContour;!e.touched(t)&&t!==this;)t=t.prevPointOnContour;return t};var Qr=Object.freeze(new Yr(0,0)),qr={cvCutIn:17/16,deltaBase:9,deltaShift:.125,loop:1,minDis:1,autoFlip:!0};function Zr(e,t){switch(this.env=e,this.stack=[],this.prog=t,e){case"glyf":this.zp0=this.zp1=this.zp2=1,this.rp0=this.rp1=this.rp2=0;case"prep":this.fv=this.pv=this.dpv=Xr,this.round=Pr}}function $r(e){for(var t=e.tZone=new Array(e.gZone.length),r=0;r<t.length;r++)t[r]=new Yr(0,0)}function ea(e,t){var r,a=e.prog,n=e.ip,s=1;do{if(88===(r=a[++n]))s++;else if(89===r)s--;else if(64===r)n+=a[n+1]+1;else if(65===r)n+=2*a[n+1]+1;else if(r>=176&&r<=183)n+=r-176+1;else if(r>=184&&r<=191)n+=2*(r-184+1);else if(t&&1===s&&27===r)break}while(s>0);e.ip=n}function ta(e,t){exports.DEBUG&&console.log(t.step,"SVTCA["+e.axis+"]"),t.fv=t.pv=t.dpv=e}function ra(e,t){exports.DEBUG&&console.log(t.step,"SPVTCA["+e.axis+"]"),t.pv=t.dpv=e}function aa(e,t){exports.DEBUG&&console.log(t.step,"SFVTCA["+e.axis+"]"),t.fv=e}function na(e,t){var r,a,n=t.stack,s=n.pop(),i=n.pop(),o=t.z2[s],c=t.z1[i];exports.DEBUG&&console.log("SPVTL["+e+"]",s,i),e?(r=o.y-c.y,a=c.x-o.x):(r=c.x-o.x,a=c.y-o.y),t.pv=t.dpv=Wr(r,a)}function sa(e,t){var r,a,n=t.stack,s=n.pop(),i=n.pop(),o=t.z2[s],c=t.z1[i];exports.DEBUG&&console.log("SFVTL["+e+"]",s,i),e?(r=o.y-c.y,a=c.x-o.x):(r=c.x-o.x,a=c.y-o.y),t.fv=Wr(r,a)}function ia(e){exports.DEBUG&&console.log(e.step,"POP[]"),e.stack.pop()}function oa(e,t){var r=t.stack.pop(),a=t.z0[r],n=t.fv,s=t.pv;exports.DEBUG&&console.log(t.step,"MDAP["+e+"]",r);var i=s.distance(a,Qr);e&&(i=t.round(i)),n.setRelative(a,Qr,i,s),n.touch(a),t.rp0=t.rp1=r}function ca(e,t){var r,a,n,s=t.z2,i=s.length-2;exports.DEBUG&&console.log(t.step,"IUP["+e.axis+"]");for(var o=0;o<i;o++)r=s[o],e.touched(r)||(a=r.prevTouched(e))!==r&&(a===(n=r.nextTouched(e))&&e.setRelative(r,r,e.distance(a,a,!1,!0),e,!0),e.interpolate(r,a,n,e))}function la(e,t){for(var r=t.stack,a=e?t.rp1:t.rp2,n=(e?t.z0:t.z1)[a],s=t.fv,i=t.pv,o=t.loop,c=t.z2;o--;){var l=r.pop(),u=c[l],h=i.distance(n,n,!1,!0);s.setRelative(u,u,h,i),s.touch(u),exports.DEBUG&&console.log(t.step,(t.loop>1?"loop "+(t.loop-o)+": ":"")+"SHP["+(e?"rp1":"rp2")+"]",l)}t.loop=1}function ua(e,t){var r=t.stack,a=e?t.rp1:t.rp2,n=(e?t.z0:t.z1)[a],s=t.fv,i=t.pv,o=r.pop(),c=t.z2[t.contours[o]],l=c;exports.DEBUG&&console.log(t.step,"SHC["+e+"]",o);var u=i.distance(n,n,!1,!0);do{l!==n&&s.setRelative(l,l,u,i),l=l.nextPointOnContour}while(l!==c)}function ha(e,t){var r,a,n=t.stack,s=e?t.rp1:t.rp2,i=(e?t.z0:t.z1)[s],o=t.fv,c=t.pv,l=n.pop();switch(exports.DEBUG&&console.log(t.step,"SHZ["+e+"]",l),l){case 0:r=t.tZone;break;case 1:r=t.gZone;break;default:throw new Error("Invalid zone")}for(var u=c.distance(i,i,!1,!0),h=r.length-2,p=0;p<h;p++)a=r[p],o.setRelative(a,a,u,c)}function pa(e,t){var r=t.stack,a=r.pop()/64,n=r.pop(),s=t.z1[n],i=t.z0[t.rp0],o=t.fv,c=t.pv;o.setRelative(s,i,a,c),o.touch(s),exports.DEBUG&&console.log(t.step,"MSIRP["+e+"]",a,n),t.rp1=t.rp0,t.rp2=n,e&&(t.rp0=n)}function fa(e,t){var r=t.stack,a=r.pop(),n=r.pop(),s=t.z0[n],i=t.fv,o=t.pv,c=t.cvt[a];exports.DEBUG&&console.log(t.step,"MIAP["+e+"]",a,"(",c,")",n);var l=o.distance(s,Qr);e&&(Math.abs(l-c)<t.cvCutIn&&(l=c),l=t.round(l)),i.setRelative(s,Qr,l,o),0===t.zp0&&(s.xo=s.x,s.yo=s.y),i.touch(s),t.rp0=t.rp1=n}function da(e,t){var r=t.stack,a=r.pop(),n=t.z2[a];exports.DEBUG&&console.log(t.step,"GC["+e+"]",a),r.push(64*t.dpv.distance(n,Qr,e,!1))}function ga(e,t){var r=t.stack,a=r.pop(),n=r.pop(),s=t.z1[a],i=t.z0[n],o=t.dpv.distance(i,s,e,e);exports.DEBUG&&console.log(t.step,"MD["+e+"]",a,n,"->",o),t.stack.push(Math.round(64*o))}function ma(e,t){var r=t.stack,a=r.pop(),n=t.fv,s=t.pv,i=t.ppem,o=t.deltaBase+16*(e-1),c=t.deltaShift,l=t.z0;exports.DEBUG&&console.log(t.step,"DELTAP["+e+"]",a,r);for(var u=0;u<a;u++){var h=r.pop(),p=r.pop();if(o+((240&p)>>4)===i){var f=(15&p)-8;f>=0&&f++,exports.DEBUG&&console.log(t.step,"DELTAPFIX",h,"by",f*c);var d=l[h];n.setRelative(d,d,f*c,s)}}}function va(e,t){var r=t.stack,a=r.pop();exports.DEBUG&&console.log(t.step,"ROUND[]"),r.push(64*t.round(a/64))}function ya(e,t){var r=t.stack,a=r.pop(),n=t.ppem,s=t.deltaBase+16*(e-1),i=t.deltaShift;exports.DEBUG&&console.log(t.step,"DELTAC["+e+"]",a,r);for(var o=0;o<a;o++){var c=r.pop(),l=r.pop();if(s+((240&l)>>4)===n){var u=(15&l)-8;u>=0&&u++;var h=u*i;exports.DEBUG&&console.log(t.step,"DELTACFIX",c,"by",h),t.cvt[c]+=h}}}function Aa(e,t){var r,a,n=t.stack,s=n.pop(),i=n.pop(),o=t.z2[s],c=t.z1[i];exports.DEBUG&&console.log(t.step,"SDPVTL["+e+"]",s,i),e?(r=o.y-c.y,a=c.x-o.x):(r=c.x-o.x,a=c.y-o.y),t.dpv=Wr(r,a)}function ba(e,t){var r=t.stack,a=t.prog,n=t.ip;exports.DEBUG&&console.log(t.step,"PUSHB["+e+"]");for(var s=0;s<e;s++)r.push(a[++n]);t.ip=n}function Ba(e,t){var r=t.ip,a=t.prog,n=t.stack;exports.DEBUG&&console.log(t.ip,"PUSHW["+e+"]");for(var s=0;s<e;s++){var i=a[++r]<<8|a[++r];32768&i&&(i=-(1+(65535^i))),n.push(i)}t.ip=r}function Ca(e,t,r,a,n,s){var i,o,c,l,u=s.stack,h=e&&u.pop(),p=u.pop(),f=s.rp0,d=s.z0[f],g=s.z1[p],m=s.minDis,v=s.fv,y=s.dpv;c=(o=i=y.distance(g,d,!0,!0))>=0?1:-1,o=Math.abs(o),e&&(l=s.cvt[h],a&&Math.abs(o-l)<s.cvCutIn&&(o=l)),r&&o<m&&(o=m),a&&(o=s.round(o)),v.setRelative(g,d,c*o,y),v.touch(g),exports.DEBUG&&console.log(s.step,(e?"MIRP[":"MDRP[")+(t?"M":"m")+(r?">":"_")+(a?"R":"_")+(0===n?"Gr":1===n?"Bl":2===n?"Wh":"")+"]",e?h+"("+s.cvt[h]+","+l+")":"",p,"(d =",i,"->",c*o,")"),s.rp1=s.rp0,s.rp2=p,t&&(s.rp0=p)}function xa(e){this.char=e,this.state={},this.activeState=null}function Fa(e,t,r){this.contextName=r,this.startIndex=e,this.endOffset=t}function wa(e,t,r){this.contextName=e,this.openRange=null,this.ranges=[],this.checkStart=t,this.checkEnd=r}function Ea(e,t){this.context=e,this.index=t,this.length=e.length,this.current=e[t],this.backtrack=e.slice(0,t),this.lookahead=e.slice(t+1)}function Sa(e){this.eventId=e,this.subscribers=[]}function Ia(e){var t=this,r=["start","end","next","newToken","contextStart","contextEnd","insertToken","removeToken","removeRange","replaceToken","replaceRange","composeRUD","updateContextsRanges"];r.forEach((function(e){Object.defineProperty(t.events,e,{value:new Sa(e)})})),e&&r.forEach((function(r){var a=e[r];"function"==typeof a&&t.events[r].subscribe(a)}));["insertToken","removeToken","removeRange","replaceToken","replaceRange","composeRUD"].forEach((function(e){t.events[e].subscribe(t.updateContextsRanges)}))}function Ma(e){this.tokens=[],this.registeredContexts={},this.contextCheckers=[],this.events={},this.registeredModifiers=[],Ia.call(this,e)}function Ta(e){return/[\u0600-\u065F\u066A-\u06D2\u06FA-\u06FF]/.test(e)}function ka(e){return/[\u0630\u0690\u0621\u0631\u0661\u0671\u0622\u0632\u0672\u0692\u06C2\u0623\u0673\u0693\u06C3\u0624\u0694\u06C4\u0625\u0675\u0695\u06C5\u06E5\u0676\u0696\u06C6\u0627\u0677\u0697\u06C7\u0648\u0688\u0698\u06C8\u0689\u0699\u06C9\u068A\u06CA\u066B\u068B\u06CB\u068C\u068D\u06CD\u06FD\u068E\u06EE\u06FE\u062F\u068F\u06CF\u06EF]/.test(e)}function Ra(e){return/[\u0600-\u0605\u060C-\u060E\u0610-\u061B\u061E\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED]/.test(e)}function La(e){return/[A-z]/.test(e)}function Da(e){this.font=e,this.features={}}function Oa(e){this.id=e.id,this.tag=e.tag,this.substitution=e.substitution}function Ua(e,t){if(!e)return-1;switch(t.format){case 1:return t.glyphs.indexOf(e);case 2:for(var r=t.ranges,a=0;a<r.length;a++){var n=r[a];if(e>=n.start&&e<=n.end){var s=e-n.start;return n.index+s}}break;default:return-1}return-1}function Ga(e,t){return-1===Ua(e,t.coverage)?null:e+t.deltaGlyphId}function Na(e,t){var r=Ua(e,t.coverage);return-1===r?null:t.substitute[r]}function Pa(e,t){for(var r=[],a=0;a<e.length;a++){var n=e[a],s=t.current,i=Ua(s=Array.isArray(s)?s[0]:s,n);-1!==i&&r.push(i)}return r.length!==e.length?-1:r}function Ha(e,t){var r=t.inputCoverage.length+t.lookaheadCoverage.length+t.backtrackCoverage.length;if(e.context.length<r)return[];var a=Pa(t.inputCoverage,e);if(-1===a)return[];var n=t.inputCoverage.length-1;if(e.lookahead.length<t.lookaheadCoverage.length)return[];for(var s=e.lookahead.slice(n);s.length&&Ra(s[0].char);)s.shift();var i=new Ea(s,0),o=Pa(t.lookaheadCoverage,i),c=[].concat(e.backtrack);for(c.reverse();c.length&&Ra(c[0].char);)c.shift();if(c.length<t.backtrackCoverage.length)return[];var l=new Ea(c,0),u=Pa(t.backtrackCoverage,l),h=[];if(a.length===t.inputCoverage.length&&o.length===t.lookaheadCoverage.length&&u.length===t.backtrackCoverage.length)for(var p=0;p<t.lookupRecords.length;p++)for(var f=t.lookupRecords[p].lookupListIndex,d=this.getLookupByIndex(f),g=0;g<d.subtables.length;g++){var m=d.subtables[g],v=this.getLookupMethod(d,m);if("12"===this.getSubstitutionType(d,m))for(var y=0;y<a.length;y++){var A=v(e.get(y));A&&h.push(A)}}return h}function Ja(e,t){var r,a=Ua(e.current,t.coverage);if(-1===a)return null;for(var n=t.ligatureSets[a],s=0;s<n.length;s++){r=n[s];for(var i=0;i<r.components.length;i++){if(e.lookahead[i]!==r.components[i])break;if(i===r.components.length-1)return r}}return null}function _a(e,t){var r=Ua(e,t.coverage);return-1===r?null:t.sequences[r]}Gr.prototype.exec=function(e,t){if("number"!=typeof t)throw new Error("Point size is not a number!");if(!(this._errorState>2)){var r=this.font,a=this._prepState;if(!a||a.ppem!==t){var n=this._fpgmState;if(!n){Zr.prototype=qr,(n=this._fpgmState=new Zr("fpgm",r.tables.fpgm)).funcs=[],n.font=r,exports.DEBUG&&(console.log("---EXEC FPGM---"),n.step=-1);try{Lr(n)}catch(e){return console.log("Hinting error in FPGM:"+e),void(this._errorState=3)}}Zr.prototype=n,(a=this._prepState=new Zr("prep",r.tables.prep)).ppem=t;var s=r.tables.cvt;if(s)for(var i=a.cvt=new Array(s.length),o=t/r.unitsPerEm,c=0;c<s.length;c++)i[c]=s[c]*o;else a.cvt=[];exports.DEBUG&&(console.log("---EXEC PREP---"),a.step=-1);try{Lr(a)}catch(e){this._errorState<2&&console.log("Hinting error in PREP:"+e),this._errorState=2}}if(!(this._errorState>1))try{return Dr(e,a)}catch(e){return this._errorState<1&&(console.log("Hinting error:"+e),console.log("Note: further hinting errors are silenced")),void(this._errorState=1)}}},Dr=function(e,t){var r,a,n,s=t.ppem/t.font.unitsPerEm,i=s,o=e.components;if(Zr.prototype=t,o){var c=t.font;a=[],r=[];for(var l=0;l<o.length;l++){var u=o[l],h=c.glyphs.get(u.glyphIndex);n=new Zr("glyf",h.instructions),exports.DEBUG&&(console.log("---EXEC COMP "+l+"---"),n.step=-1),Or(h,n,s,i);for(var p=Math.round(u.dx*s),f=Math.round(u.dy*i),d=n.gZone,g=n.contours,m=0;m<d.length;m++){var v=d[m];v.xTouched=v.yTouched=!1,v.xo=v.x=v.x+p,v.yo=v.y=v.y+f}var y=a.length;a.push.apply(a,d);for(var A=0;A<g.length;A++)r.push(g[A]+y)}e.instructions&&!n.inhibitGridFit&&((n=new Zr("glyf",e.instructions)).gZone=n.z0=n.z1=n.z2=a,n.contours=r,a.push(new Yr(0,0),new Yr(Math.round(e.advanceWidth*s),0)),exports.DEBUG&&(console.log("---EXEC COMPOSITE---"),n.step=-1),Lr(n),a.length-=2)}else n=new Zr("glyf",e.instructions),exports.DEBUG&&(console.log("---EXEC GLYPH---"),n.step=-1),Or(e,n,s,i),a=n.gZone;return a},Or=function(e,t,r,a){for(var n,s,i,o=e.points||[],c=o.length,l=t.gZone=t.z0=t.z1=t.z2=[],u=t.contours=[],h=0;h<c;h++)n=o[h],l[h]=new Yr(n.x*r,n.y*a,n.lastPointOfContour,n.onCurve);for(var p=0;p<c;p++)n=l[p],s||(s=n,u.push(p)),n.lastPointOfContour?(n.nextPointOnContour=s,s.prevPointOnContour=n,s=void 0):(i=l[p+1],n.nextPointOnContour=i,i.prevPointOnContour=n);if(!t.inhibitGridFit){if(exports.DEBUG){console.log("PROCESSING GLYPH",t.stack);for(var f=0;f<c;f++)console.log(f,l[f].x,l[f].y)}if(l.push(new Yr(0,0),new Yr(Math.round(e.advanceWidth*r),0)),Lr(t),l.length-=2,exports.DEBUG){console.log("FINISHED GLYPH",t.stack);for(var d=0;d<c;d++)console.log(d,l[d].x,l[d].y)}}},Lr=function(e){var t=e.prog;if(t){var r,a=t.length;for(e.ip=0;e.ip<a;e.ip++){if(exports.DEBUG&&e.step++,!(r=Rr[t[e.ip]]))throw new Error("unknown instruction: 0x"+Number(t[e.ip]).toString(16));r(e)}}},Rr=[ta.bind(void 0,Kr),ta.bind(void 0,Xr),ra.bind(void 0,Kr),ra.bind(void 0,Xr),aa.bind(void 0,Kr),aa.bind(void 0,Xr),na.bind(void 0,0),na.bind(void 0,1),sa.bind(void 0,0),sa.bind(void 0,1),function(e){var t=e.stack,r=t.pop(),a=t.pop();exports.DEBUG&&console.log(e.step,"SPVFS[]",r,a),e.pv=e.dpv=Wr(a,r)},function(e){var t=e.stack,r=t.pop(),a=t.pop();exports.DEBUG&&console.log(e.step,"SPVFS[]",r,a),e.fv=Wr(a,r)},function(e){var t=e.stack,r=e.pv;exports.DEBUG&&console.log(e.step,"GPV[]"),t.push(16384*r.x),t.push(16384*r.y)},function(e){var t=e.stack,r=e.fv;exports.DEBUG&&console.log(e.step,"GFV[]"),t.push(16384*r.x),t.push(16384*r.y)},function(e){e.fv=e.pv,exports.DEBUG&&console.log(e.step,"SFVTPV[]")},function(e){var t=e.stack,r=t.pop(),a=t.pop(),n=t.pop(),s=t.pop(),i=t.pop(),o=e.z0,c=e.z1,l=o[r],u=o[a],h=c[n],p=c[s],f=e.z2[i];exports.DEBUG&&console.log("ISECT[], ",r,a,n,s,i);var d=l.x,g=l.y,m=u.x,v=u.y,y=h.x,A=h.y,b=p.x,B=p.y,C=(d-m)*(A-B)-(g-v)*(y-b),x=d*v-g*m,F=y*B-A*b;f.x=(x*(y-b)-F*(d-m))/C,f.y=(x*(A-B)-F*(g-v))/C},function(e){e.rp0=e.stack.pop(),exports.DEBUG&&console.log(e.step,"SRP0[]",e.rp0)},function(e){e.rp1=e.stack.pop(),exports.DEBUG&&console.log(e.step,"SRP1[]",e.rp1)},function(e){e.rp2=e.stack.pop(),exports.DEBUG&&console.log(e.step,"SRP2[]",e.rp2)},function(e){var t=e.stack.pop();switch(exports.DEBUG&&console.log(e.step,"SZP0[]",t),e.zp0=t,t){case 0:e.tZone||$r(e),e.z0=e.tZone;break;case 1:e.z0=e.gZone;break;default:throw new Error("Invalid zone pointer")}},function(e){var t=e.stack.pop();switch(exports.DEBUG&&console.log(e.step,"SZP1[]",t),e.zp1=t,t){case 0:e.tZone||$r(e),e.z1=e.tZone;break;case 1:e.z1=e.gZone;break;default:throw new Error("Invalid zone pointer")}},function(e){var t=e.stack.pop();switch(exports.DEBUG&&console.log(e.step,"SZP2[]",t),e.zp2=t,t){case 0:e.tZone||$r(e),e.z2=e.tZone;break;case 1:e.z2=e.gZone;break;default:throw new Error("Invalid zone pointer")}},function(e){var t=e.stack.pop();switch(exports.DEBUG&&console.log(e.step,"SZPS[]",t),e.zp0=e.zp1=e.zp2=t,t){case 0:e.tZone||$r(e),e.z0=e.z1=e.z2=e.tZone;break;case 1:e.z0=e.z1=e.z2=e.gZone;break;default:throw new Error("Invalid zone pointer")}},function(e){e.loop=e.stack.pop(),exports.DEBUG&&console.log(e.step,"SLOOP[]",e.loop)},function(e){exports.DEBUG&&console.log(e.step,"RTG[]"),e.round=Pr},function(e){exports.DEBUG&&console.log(e.step,"RTHG[]"),e.round=Jr},function(e){var t=e.stack.pop();exports.DEBUG&&console.log(e.step,"SMD[]",t),e.minDis=t/64},function(e){exports.DEBUG&&console.log(e.step,"ELSE[]"),ea(e,!1)},function(e){var t=e.stack.pop();exports.DEBUG&&console.log(e.step,"JMPR[]",t),e.ip+=t-1},function(e){var t=e.stack.pop();exports.DEBUG&&console.log(e.step,"SCVTCI[]",t),e.cvCutIn=t/64},void 0,void 0,function(e){var t=e.stack;exports.DEBUG&&console.log(e.step,"DUP[]"),t.push(t[t.length-1])},ia,function(e){exports.DEBUG&&console.log(e.step,"CLEAR[]"),e.stack.length=0},function(e){var t=e.stack,r=t.pop(),a=t.pop();exports.DEBUG&&console.log(e.step,"SWAP[]"),t.push(r),t.push(a)},function(e){var t=e.stack;exports.DEBUG&&console.log(e.step,"DEPTH[]"),t.push(t.length)},function(e){var t=e.stack,r=t.pop();exports.DEBUG&&console.log(e.step,"CINDEX[]",r),t.push(t[t.length-r])},function(e){var t=e.stack,r=t.pop();exports.DEBUG&&console.log(e.step,"MINDEX[]",r),t.push(t.splice(t.length-r,1)[0])},void 0,void 0,void 0,function(e){var t=e.stack,r=t.pop(),a=t.pop();exports.DEBUG&&console.log(e.step,"LOOPCALL[]",r,a);var n=e.ip,s=e.prog;e.prog=e.funcs[r];for(var i=0;i<a;i++)Lr(e),exports.DEBUG&&console.log(++e.step,i+1<a?"next loopcall":"done loopcall",i);e.ip=n,e.prog=s},function(e){var t=e.stack.pop();exports.DEBUG&&console.log(e.step,"CALL[]",t);var r=e.ip,a=e.prog;e.prog=e.funcs[t],Lr(e),e.ip=r,e.prog=a,exports.DEBUG&&console.log(++e.step,"returning from",t)},function(e){if("fpgm"!==e.env)throw new Error("FDEF not allowed here");var t=e.stack,r=e.prog,a=e.ip,n=t.pop(),s=a;for(exports.DEBUG&&console.log(e.step,"FDEF[]",n);45!==r[++a];);e.ip=a,e.funcs[n]=r.slice(s+1,a)},void 0,oa.bind(void 0,0),oa.bind(void 0,1),ca.bind(void 0,Kr),ca.bind(void 0,Xr),la.bind(void 0,0),la.bind(void 0,1),ua.bind(void 0,0),ua.bind(void 0,1),ha.bind(void 0,0),ha.bind(void 0,1),function(e){for(var t=e.stack,r=e.loop,a=e.fv,n=t.pop()/64,s=e.z2;r--;){var i=t.pop(),o=s[i];exports.DEBUG&&console.log(e.step,(e.loop>1?"loop "+(e.loop-r)+": ":"")+"SHPIX[]",i,n),a.setRelative(o,o,n),a.touch(o)}e.loop=1},function(e){for(var t=e.stack,r=e.rp1,a=e.rp2,n=e.loop,s=e.z0[r],i=e.z1[a],o=e.fv,c=e.dpv,l=e.z2;n--;){var u=t.pop(),h=l[u];exports.DEBUG&&console.log(e.step,(e.loop>1?"loop "+(e.loop-n)+": ":"")+"IP[]",u,r,"<->",a),o.interpolate(h,s,i,c),o.touch(h)}e.loop=1},pa.bind(void 0,0),pa.bind(void 0,1),function(e){for(var t=e.stack,r=e.rp0,a=e.z0[r],n=e.loop,s=e.fv,i=e.pv,o=e.z1;n--;){var c=t.pop(),l=o[c];exports.DEBUG&&console.log(e.step,(e.loop>1?"loop "+(e.loop-n)+": ":"")+"ALIGNRP[]",c),s.setRelative(l,a,0,i),s.touch(l)}e.loop=1},function(e){exports.DEBUG&&console.log(e.step,"RTDG[]"),e.round=Hr},fa.bind(void 0,0),fa.bind(void 0,1),function(e){var t=e.prog,r=e.ip,a=e.stack,n=t[++r];exports.DEBUG&&console.log(e.step,"NPUSHB[]",n);for(var s=0;s<n;s++)a.push(t[++r]);e.ip=r},function(e){var t=e.ip,r=e.prog,a=e.stack,n=r[++t];exports.DEBUG&&console.log(e.step,"NPUSHW[]",n);for(var s=0;s<n;s++){var i=r[++t]<<8|r[++t];32768&i&&(i=-(1+(65535^i))),a.push(i)}e.ip=t},function(e){var t=e.stack,r=e.store;r||(r=e.store=[]);var a=t.pop(),n=t.pop();exports.DEBUG&&console.log(e.step,"WS",a,n),r[n]=a},function(e){var t=e.stack,r=e.store,a=t.pop();exports.DEBUG&&console.log(e.step,"RS",a);var n=r&&r[a]||0;t.push(n)},function(e){var t=e.stack,r=t.pop(),a=t.pop();exports.DEBUG&&console.log(e.step,"WCVTP",r,a),e.cvt[a]=r/64},function(e){var t=e.stack,r=t.pop();exports.DEBUG&&console.log(e.step,"RCVT",r),t.push(64*e.cvt[r])},da.bind(void 0,0),da.bind(void 0,1),void 0,ga.bind(void 0,0),ga.bind(void 0,1),function(e){exports.DEBUG&&console.log(e.step,"MPPEM[]"),e.stack.push(e.ppem)},void 0,function(e){exports.DEBUG&&console.log(e.step,"FLIPON[]"),e.autoFlip=!0},void 0,void 0,function(e){var t=e.stack,r=t.pop(),a=t.pop();exports.DEBUG&&console.log(e.step,"LT[]",r,a),t.push(a<r?1:0)},function(e){var t=e.stack,r=t.pop(),a=t.pop();exports.DEBUG&&console.log(e.step,"LTEQ[]",r,a),t.push(a<=r?1:0)},function(e){var t=e.stack,r=t.pop(),a=t.pop();exports.DEBUG&&console.log(e.step,"GT[]",r,a),t.push(a>r?1:0)},function(e){var t=e.stack,r=t.pop(),a=t.pop();exports.DEBUG&&console.log(e.step,"GTEQ[]",r,a),t.push(a>=r?1:0)},function(e){var t=e.stack,r=t.pop(),a=t.pop();exports.DEBUG&&console.log(e.step,"EQ[]",r,a),t.push(r===a?1:0)},function(e){var t=e.stack,r=t.pop(),a=t.pop();exports.DEBUG&&console.log(e.step,"NEQ[]",r,a),t.push(r!==a?1:0)},function(e){var t=e.stack,r=t.pop();exports.DEBUG&&console.log(e.step,"ODD[]",r),t.push(Math.trunc(r)%2?1:0)},function(e){var t=e.stack,r=t.pop();exports.DEBUG&&console.log(e.step,"EVEN[]",r),t.push(Math.trunc(r)%2?0:1)},function(e){var t=e.stack.pop();exports.DEBUG&&console.log(e.step,"IF[]",t),t||(ea(e,!0),exports.DEBUG&&console.log(e.step,"EIF[]"))},function(e){exports.DEBUG&&console.log(e.step,"EIF[]")},function(e){var t=e.stack,r=t.pop(),a=t.pop();exports.DEBUG&&console.log(e.step,"AND[]",r,a),t.push(r&&a?1:0)},function(e){var t=e.stack,r=t.pop(),a=t.pop();exports.DEBUG&&console.log(e.step,"OR[]",r,a),t.push(r||a?1:0)},function(e){var t=e.stack,r=t.pop();exports.DEBUG&&console.log(e.step,"NOT[]",r),t.push(r?0:1)},ma.bind(void 0,1),function(e){var t=e.stack.pop();exports.DEBUG&&console.log(e.step,"SDB[]",t),e.deltaBase=t},function(e){var t=e.stack.pop();exports.DEBUG&&console.log(e.step,"SDS[]",t),e.deltaShift=Math.pow(.5,t)},function(e){var t=e.stack,r=t.pop(),a=t.pop();exports.DEBUG&&console.log(e.step,"ADD[]",r,a),t.push(a+r)},function(e){var t=e.stack,r=t.pop(),a=t.pop();exports.DEBUG&&console.log(e.step,"SUB[]",r,a),t.push(a-r)},function(e){var t=e.stack,r=t.pop(),a=t.pop();exports.DEBUG&&console.log(e.step,"DIV[]",r,a),t.push(64*a/r)},function(e){var t=e.stack,r=t.pop(),a=t.pop();exports.DEBUG&&console.log(e.step,"MUL[]",r,a),t.push(a*r/64)},function(e){var t=e.stack,r=t.pop();exports.DEBUG&&console.log(e.step,"ABS[]",r),t.push(Math.abs(r))},function(e){var t=e.stack,r=t.pop();exports.DEBUG&&console.log(e.step,"NEG[]",r),t.push(-r)},function(e){var t=e.stack,r=t.pop();exports.DEBUG&&console.log(e.step,"FLOOR[]",r),t.push(64*Math.floor(r/64))},function(e){var t=e.stack,r=t.pop();exports.DEBUG&&console.log(e.step,"CEILING[]",r),t.push(64*Math.ceil(r/64))},va.bind(void 0,0),va.bind(void 0,1),va.bind(void 0,2),va.bind(void 0,3),void 0,void 0,void 0,void 0,function(e){var t=e.stack,r=t.pop(),a=t.pop();exports.DEBUG&&console.log(e.step,"WCVTF[]",r,a),e.cvt[a]=r*e.ppem/e.font.unitsPerEm},ma.bind(void 0,2),ma.bind(void 0,3),ya.bind(void 0,1),ya.bind(void 0,2),ya.bind(void 0,3),function(e){var t,r=e.stack.pop();switch(exports.DEBUG&&console.log(e.step,"SROUND[]",r),e.round=Vr,192&r){case 0:t=.5;break;case 64:t=1;break;case 128:t=2;break;default:throw new Error("invalid SROUND value")}switch(e.srPeriod=t,48&r){case 0:e.srPhase=0;break;case 16:e.srPhase=.25*t;break;case 32:e.srPhase=.5*t;break;case 48:e.srPhase=.75*t;break;default:throw new Error("invalid SROUND value")}r&=15,e.srThreshold=0===r?0:(r/8-.5)*t},function(e){var t,r=e.stack.pop();switch(exports.DEBUG&&console.log(e.step,"S45ROUND[]",r),e.round=Vr,192&r){case 0:t=Math.sqrt(2)/2;break;case 64:t=Math.sqrt(2);break;case 128:t=2*Math.sqrt(2);break;default:throw new Error("invalid S45ROUND value")}switch(e.srPeriod=t,48&r){case 0:e.srPhase=0;break;case 16:e.srPhase=.25*t;break;case 32:e.srPhase=.5*t;break;case 48:e.srPhase=.75*t;break;default:throw new Error("invalid S45ROUND value")}r&=15,e.srThreshold=0===r?0:(r/8-.5)*t},void 0,void 0,function(e){exports.DEBUG&&console.log(e.step,"ROFF[]"),e.round=Nr},void 0,function(e){exports.DEBUG&&console.log(e.step,"RUTG[]"),e.round=_r},function(e){exports.DEBUG&&console.log(e.step,"RDTG[]"),e.round=jr},ia,ia,void 0,void 0,void 0,void 0,void 0,function(e){var t=e.stack.pop();exports.DEBUG&&console.log(e.step,"SCANCTRL[]",t)},Aa.bind(void 0,0),Aa.bind(void 0,1),function(e){var t=e.stack,r=t.pop(),a=0;exports.DEBUG&&console.log(e.step,"GETINFO[]",r),1&r&&(a=35),32&r&&(a|=4096),t.push(a)},void 0,function(e){var t=e.stack,r=t.pop(),a=t.pop(),n=t.pop();exports.DEBUG&&console.log(e.step,"ROLL[]"),t.push(a),t.push(r),t.push(n)},function(e){var t=e.stack,r=t.pop(),a=t.pop();exports.DEBUG&&console.log(e.step,"MAX[]",r,a),t.push(Math.max(a,r))},function(e){var t=e.stack,r=t.pop(),a=t.pop();exports.DEBUG&&console.log(e.step,"MIN[]",r,a),t.push(Math.min(a,r))},function(e){var t=e.stack.pop();exports.DEBUG&&console.log(e.step,"SCANTYPE[]",t)},function(e){var t=e.stack.pop(),r=e.stack.pop();switch(exports.DEBUG&&console.log(e.step,"INSTCTRL[]",t,r),t){case 1:return void(e.inhibitGridFit=!!r);case 2:return void(e.ignoreCvt=!!r);default:throw new Error("invalid INSTCTRL[] selector")}},void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,ba.bind(void 0,1),ba.bind(void 0,2),ba.bind(void 0,3),ba.bind(void 0,4),ba.bind(void 0,5),ba.bind(void 0,6),ba.bind(void 0,7),ba.bind(void 0,8),Ba.bind(void 0,1),Ba.bind(void 0,2),Ba.bind(void 0,3),Ba.bind(void 0,4),Ba.bind(void 0,5),Ba.bind(void 0,6),Ba.bind(void 0,7),Ba.bind(void 0,8),Ca.bind(void 0,0,0,0,0,0),Ca.bind(void 0,0,0,0,0,1),Ca.bind(void 0,0,0,0,0,2),Ca.bind(void 0,0,0,0,0,3),Ca.bind(void 0,0,0,0,1,0),Ca.bind(void 0,0,0,0,1,1),Ca.bind(void 0,0,0,0,1,2),Ca.bind(void 0,0,0,0,1,3),Ca.bind(void 0,0,0,1,0,0),Ca.bind(void 0,0,0,1,0,1),Ca.bind(void 0,0,0,1,0,2),Ca.bind(void 0,0,0,1,0,3),Ca.bind(void 0,0,0,1,1,0),Ca.bind(void 0,0,0,1,1,1),Ca.bind(void 0,0,0,1,1,2),Ca.bind(void 0,0,0,1,1,3),Ca.bind(void 0,0,1,0,0,0),Ca.bind(void 0,0,1,0,0,1),Ca.bind(void 0,0,1,0,0,2),Ca.bind(void 0,0,1,0,0,3),Ca.bind(void 0,0,1,0,1,0),Ca.bind(void 0,0,1,0,1,1),Ca.bind(void 0,0,1,0,1,2),Ca.bind(void 0,0,1,0,1,3),Ca.bind(void 0,0,1,1,0,0),Ca.bind(void 0,0,1,1,0,1),Ca.bind(void 0,0,1,1,0,2),Ca.bind(void 0,0,1,1,0,3),Ca.bind(void 0,0,1,1,1,0),Ca.bind(void 0,0,1,1,1,1),Ca.bind(void 0,0,1,1,1,2),Ca.bind(void 0,0,1,1,1,3),Ca.bind(void 0,1,0,0,0,0),Ca.bind(void 0,1,0,0,0,1),Ca.bind(void 0,1,0,0,0,2),Ca.bind(void 0,1,0,0,0,3),Ca.bind(void 0,1,0,0,1,0),Ca.bind(void 0,1,0,0,1,1),Ca.bind(void 0,1,0,0,1,2),Ca.bind(void 0,1,0,0,1,3),Ca.bind(void 0,1,0,1,0,0),Ca.bind(void 0,1,0,1,0,1),Ca.bind(void 0,1,0,1,0,2),Ca.bind(void 0,1,0,1,0,3),Ca.bind(void 0,1,0,1,1,0),Ca.bind(void 0,1,0,1,1,1),Ca.bind(void 0,1,0,1,1,2),Ca.bind(void 0,1,0,1,1,3),Ca.bind(void 0,1,1,0,0,0),Ca.bind(void 0,1,1,0,0,1),Ca.bind(void 0,1,1,0,0,2),Ca.bind(void 0,1,1,0,0,3),Ca.bind(void 0,1,1,0,1,0),Ca.bind(void 0,1,1,0,1,1),Ca.bind(void 0,1,1,0,1,2),Ca.bind(void 0,1,1,0,1,3),Ca.bind(void 0,1,1,1,0,0),Ca.bind(void 0,1,1,1,0,1),Ca.bind(void 0,1,1,1,0,2),Ca.bind(void 0,1,1,1,0,3),Ca.bind(void 0,1,1,1,1,0),Ca.bind(void 0,1,1,1,1,1),Ca.bind(void 0,1,1,1,1,2),Ca.bind(void 0,1,1,1,1,3)],xa.prototype.setState=function(e,t){return this.state[e]=t,this.activeState={key:e,value:this.state[e]},this.activeState},xa.prototype.getState=function(e){return this.state[e]||null},Ma.prototype.inboundIndex=function(e){return e>=0&&e<this.tokens.length},Ma.prototype.composeRUD=function(e){var t=this,r=e.map((function(e){return t[e[0]].apply(t,e.slice(1).concat(true))})),a=function(e){return"object"==typeof e&&e.hasOwnProperty("FAIL")};if(r.every(a))return{FAIL:"composeRUD: one or more operations hasn't completed successfully",report:r.filter(a)};this.dispatch("composeRUD",[r.filter((function(e){return!a(e)}))])},Ma.prototype.replaceRange=function(e,t,r,a){t=null!==t?t:this.tokens.length;var n=r.every((function(e){return e instanceof xa}));if(!isNaN(e)&&this.inboundIndex(e)&&n){var s=this.tokens.splice.apply(this.tokens,[e,t].concat(r));return a||this.dispatch("replaceToken",[e,t,r]),[s,r]}return{FAIL:"replaceRange: invalid tokens or startIndex."}},Ma.prototype.replaceToken=function(e,t,r){if(!isNaN(e)&&this.inboundIndex(e)&&t instanceof xa){var a=this.tokens.splice(e,1,t);return r||this.dispatch("replaceToken",[e,t]),[a[0],t]}return{FAIL:"replaceToken: invalid token or index."}},Ma.prototype.removeRange=function(e,t,r){t=isNaN(t)?this.tokens.length:t;var a=this.tokens.splice(e,t);return r||this.dispatch("removeRange",[a,e,t]),a},Ma.prototype.removeToken=function(e,t){if(!isNaN(e)&&this.inboundIndex(e)){var r=this.tokens.splice(e,1);return t||this.dispatch("removeToken",[r,e]),r}return{FAIL:"removeToken: invalid token index."}},Ma.prototype.insertToken=function(e,t,r){return e.every((function(e){return e instanceof xa}))?(this.tokens.splice.apply(this.tokens,[t,0].concat(e)),r||this.dispatch("insertToken",[e,t]),e):{FAIL:"insertToken: invalid token(s)."}},Ma.prototype.registerModifier=function(e,t,r){this.events.newToken.subscribe((function(a,n){var s=[a,n],i=[a,n];if(null===t||!0===t.apply(this,s)){var o=r.apply(this,i);a.setState(e,o)}})),this.registeredModifiers.push(e)},Sa.prototype.subscribe=function(e){return"function"==typeof e?this.subscribers.push(e)-1:{FAIL:"invalid '"+this.eventId+"' event handler"}},Sa.prototype.unsubscribe=function(e){this.subscribers.splice(e,1)},Ea.prototype.setCurrentIndex=function(e){this.index=e,this.current=this.context[e],this.backtrack=this.context.slice(0,e),this.lookahead=this.context.slice(e+1)},Ea.prototype.get=function(e){switch(!0){case 0===e:return this.current;case e<0&&Math.abs(e)<=this.backtrack.length:return this.backtrack.slice(e)[0];case e>0&&e<=this.lookahead.length:return this.lookahead[e-1];default:return null}},Ma.prototype.rangeToText=function(e){if(e instanceof Fa)return this.getRangeTokens(e).map((function(e){return e.char})).join("")},Ma.prototype.getText=function(){return this.tokens.map((function(e){return e.char})).join("")},Ma.prototype.getContext=function(e){var t=this.registeredContexts[e];return t||null},Ma.prototype.on=function(e,t){var r=this.events[e];return r?r.subscribe(t):null},Ma.prototype.dispatch=function(e,t){var r=this,a=this.events[e];a instanceof Sa&&a.subscribers.forEach((function(e){e.apply(r,t||[])}))},Ma.prototype.registerContextChecker=function(e,t,r){if(this.getContext(e))return{FAIL:"context name '"+e+"' is already registered."};if("function"!=typeof t)return{FAIL:"missing context start check."};if("function"!=typeof r)return{FAIL:"missing context end check."};var a=new wa(e,t,r);return this.registeredContexts[e]=a,this.contextCheckers.push(a),a},Ma.prototype.getRangeTokens=function(e){var t=e.startIndex+e.endOffset;return[].concat(this.tokens.slice(e.startIndex,t))},Ma.prototype.getContextRanges=function(e){var t=this.getContext(e);return t?t.ranges:{FAIL:"context checker '"+e+"' is not registered."}},Ma.prototype.resetContextsRanges=function(){var e=this.registeredContexts;for(var t in e){if(e.hasOwnProperty(t))e[t].ranges=[]}},Ma.prototype.updateContextsRanges=function(){this.resetContextsRanges();for(var e=this.tokens.map((function(e){return e.char})),t=0;t<e.length;t++){var r=new Ea(e,t);this.runContextCheck(r)}this.dispatch("updateContextsRanges",[this.registeredContexts])},Ma.prototype.setEndOffset=function(e,t){var r=new Fa(this.getContext(t).openRange.startIndex,e,t),a=this.getContext(t).ranges;return r.rangeId=t+"."+a.length,a.push(r),this.getContext(t).openRange=null,r},Ma.prototype.runContextCheck=function(e){var t=this,r=e.index;this.contextCheckers.forEach((function(a){var n=a.contextName,s=t.getContext(n).openRange;if(!s&&a.checkStart(e)&&(s=new Fa(r,null,n),t.getContext(n).openRange=s,t.dispatch("contextStart",[n,r])),s&&a.checkEnd(e)){var i=r-s.startIndex+1,o=t.setEndOffset(i,n);t.dispatch("contextEnd",[n,o])}}))},Ma.prototype.tokenize=function(e){this.tokens=[],this.resetContextsRanges();var t=Array.from(e);this.dispatch("start");for(var r=0;r<t.length;r++){var a=t[r],n=new Ea(t,r);this.dispatch("next",[n]),this.runContextCheck(n);var s=new xa(a);this.tokens.push(s),this.dispatch("newToken",[s,n])}return this.dispatch("end",[this.tokens]),this.tokens},Da.prototype.getDefaultScriptFeaturesIndexes=function(){for(var e=this.font.tables.gsub.scripts,t=0;t<e.length;t++){var r=e[t];if("DFLT"===r.tag)return r.script.defaultLangSys.featureIndexes}return[]},Da.prototype.getScriptFeaturesIndexes=function(e){if(!this.font.tables.gsub)return[];if(!e)return this.getDefaultScriptFeaturesIndexes();for(var t=this.font.tables.gsub.scripts,r=0;r<t.length;r++){var a=t[r];if(a.tag===e&&a.script.defaultLangSys)return a.script.defaultLangSys.featureIndexes;var n=a.langSysRecords;if(n)for(var s=0;s<n.length;s++){var i=n[s];if(i.tag===e)return i.langSys.featureIndexes}}return this.getDefaultScriptFeaturesIndexes()},Da.prototype.mapTagsToFeatures=function(e,t){for(var r={},a=0;a<e.length;a++){var n=e[a].tag,s=e[a].feature;r[n]=s}this.features[t].tags=r},Da.prototype.getScriptFeatures=function(e){var t=this.features[e];if(this.features.hasOwnProperty(e))return t;var r=this.getScriptFeaturesIndexes(e);if(!r)return null;var a=this.font.tables.gsub;return t=r.map((function(e){return a.features[e]})),this.features[e]=t,this.mapTagsToFeatures(t,e),t},Da.prototype.getSubstitutionType=function(e,t){return e.lookupType.toString()+t.substFormat.toString()},Da.prototype.getLookupMethod=function(e,t){var r=this;switch(this.getSubstitutionType(e,t)){case"11":return function(e){return Ga.apply(r,[e,t])};case"12":return function(e){return Na.apply(r,[e,t])};case"63":return function(e){return Ha.apply(r,[e,t])};case"41":return function(e){return Ja.apply(r,[e,t])};case"21":return function(e){return _a.apply(r,[e,t])};default:throw new Error("lookupType: "+e.lookupType+" - substFormat: "+t.substFormat+" is not yet supported")}},Da.prototype.lookupFeature=function(e){var t=e.contextParams,r=t.index,a=this.getFeature({tag:e.tag,script:e.script});if(!a)return new Error("font '"+this.font.names.fullName.en+"' doesn't support feature '"+e.tag+"' for script '"+e.script+"'.");for(var n=this.getFeatureLookups(a),s=[].concat(t.context),i=0;i<n.length;i++)for(var o=n[i],c=this.getLookupSubtables(o),l=0;l<c.length;l++){var u=c[l],h=this.getSubstitutionType(o,u),p=this.getLookupMethod(o,u),f=void 0;switch(h){case"11":(f=p(t.current))&&s.splice(r,1,new Oa({id:11,tag:e.tag,substitution:f}));break;case"12":(f=p(t.current))&&s.splice(r,1,new Oa({id:12,tag:e.tag,substitution:f}));break;case"63":f=p(t),Array.isArray(f)&&f.length&&s.splice(r,1,new Oa({id:63,tag:e.tag,substitution:f}));break;case"41":(f=p(t))&&s.splice(r,1,new Oa({id:41,tag:e.tag,substitution:f}));break;case"21":(f=p(t.current))&&s.splice(r,1,new Oa({id:21,tag:e.tag,substitution:f}))}t=new Ea(s,r),Array.isArray(f)&&!f.length||(f=null)}return s.length?s:null},Da.prototype.supports=function(e){if(!e.script)return!1;this.getScriptFeatures(e.script);var t=this.features.hasOwnProperty(e.script);if(!e.tag)return t;var r=this.features[e.script].some((function(t){return t.tag===e.tag}));return t&&r},Da.prototype.getLookupSubtables=function(e){return e.subtables||null},Da.prototype.getLookupByIndex=function(e){return this.font.tables.gsub.lookups[e]||null},Da.prototype.getFeatureLookups=function(e){return e.lookupListIndexes.map(this.getLookupByIndex.bind(this))},Da.prototype.getFeature=function(e){if(!this.font)return{FAIL:"No font was found"};this.features.hasOwnProperty(e.script)||this.getScriptFeatures(e.script);var t=this.features[e.script];return t?t.tags[e.tag]?this.features[e.script].tags[e.tag]:null:{FAIL:"No feature for script "+e.script}};var ja={startCheck:function(e){var t=e.current,r=e.get(-1);return null===r&&Ta(t)||!Ta(r)&&Ta(t)},endCheck:function(e){var t=e.get(1);return null===t||!Ta(t)}};var Va={startCheck:function(e){var t=e.current,r=e.get(-1);return(Ta(t)||Ra(t))&&!Ta(r)},endCheck:function(e){var t=e.get(1);switch(!0){case null===t:return!0;case!Ta(t)&&!Ra(t):var r=/\s/.test(t);if(!r)return!0;if(r){if(!e.lookahead.some((function(e){return Ta(e)||Ra(e)})))return!0}break;default:return!1}}};var Xa={11:function(e,t,r){t[r].setState(e.tag,e.substitution)},12:function(e,t,r){t[r].setState(e.tag,e.substitution)},63:function(e,t,r){e.substitution.forEach((function(a,n){t[r+n].setState(e.tag,a)}))},41:function(e,t,r){var a=t[r];a.setState(e.tag,e.substitution.ligGlyph);for(var n=e.substitution.components.length,s=0;s<n;s++)(a=t[r+s+1]).setState("deleted",!0)}};function Ka(e,t,r){e instanceof Oa&&Xa[e.id]&&Xa[e.id](e,t,r)}function za(e){var t=this,r="arab",a=this.featuresTags.arab,n=this.tokenizer.getRangeTokens(e);if(1!==n.length){var s=new Ea(n.map((function(e){return e.getState("glyphIndex")})),0),i=new Ea(n.map((function(e){return e.char})),0);n.forEach((function(e,o){if(!Ra(e.char)){s.setCurrentIndex(o),i.setCurrentIndex(o);var c,l=0;switch(function(e){for(var t=[].concat(e.backtrack),r=t.length-1;r>=0;r--){var a=t[r],n=ka(a),s=Ra(a);if(!n&&!s)return!0;if(n)return!1}return!1}(i)&&(l|=1),function(e){if(ka(e.current))return!1;for(var t=0;t<e.lookahead.length;t++)if(!Ra(e.lookahead[t]))return!0;return!1}(i)&&(l|=2),l){case 1:c="fina";break;case 2:c="init";break;case 3:c="medi"}if(-1!==a.indexOf(c)){var u=t.query.lookupFeature({tag:c,script:r,contextParams:s});if(u instanceof Error)return console.info(u.message);u.forEach((function(e,t){e instanceof Oa&&(Ka(e,n,t),s.context[t]=e.substitution)}))}}}))}}function Wa(e,t){return new Ea(e.map((function(e){return e.activeState.value})),t||0)}function Ya(e){var t=this,r=this.tokenizer.getRangeTokens(e),a=Wa(r);a.context.forEach((function(e,n){a.setCurrentIndex(n);var s=t.query.lookupFeature({tag:"rlig",script:"arab",contextParams:a});s.length&&(s.forEach((function(e){return Ka(e,r,n)})),a=Wa(r))}))}var Qa={startCheck:function(e){var t=e.current,r=e.get(-1);return null===r&&La(t)||!La(r)&&La(t)},endCheck:function(e){var t=e.get(1);return null===t||!La(t)}};function qa(e,t){return new Ea(e.map((function(e){return e.activeState.value})),t||0)}function Za(e){var t=this,r=this.tokenizer.getRangeTokens(e),a=qa(r);a.context.forEach((function(e,n){a.setCurrentIndex(n);var s=t.query.lookupFeature({tag:"liga",script:"latn",contextParams:a});s.length&&(s.forEach((function(e){return Ka(e,r,n)})),a=qa(r))}))}function $a(e){this.baseDir=e||"ltr",this.tokenizer=new Ma,this.featuresTags={}}function en(e){var t=this.contextChecks[e+"Check"];return this.tokenizer.registerContextChecker(e,t.startCheck,t.endCheck)}function tn(){return en.call(this,"latinWord"),en.call(this,"arabicWord"),en.call(this,"arabicSentence"),this.tokenizer.tokenize(this.text)}function rn(){var e=this;this.tokenizer.getContextRanges("arabicSentence").forEach((function(t){var r=e.tokenizer.getRangeTokens(t);e.tokenizer.replaceRange(t.startIndex,t.endOffset,r.reverse())}))}function an(){if(-1===this.tokenizer.registeredModifiers.indexOf("glyphIndex"))throw new Error("glyphIndex modifier is required to apply arabic presentation features.")}function nn(){var e=this;this.featuresTags.hasOwnProperty("arab")&&(an.call(this),this.tokenizer.getContextRanges("arabicWord").forEach((function(t){za.call(e,t)})))}function sn(){var e=this,t="arab";this.featuresTags.hasOwnProperty(t)&&(-1!==this.featuresTags.arab.indexOf("rlig")&&(an.call(this),this.tokenizer.getContextRanges("arabicWord").forEach((function(t){Ya.call(e,t)}))))}function on(){var e=this,t="latn";this.featuresTags.hasOwnProperty(t)&&(-1!==this.featuresTags.latn.indexOf("liga")&&(an.call(this),this.tokenizer.getContextRanges("latinWord").forEach((function(t){Za.call(e,t)}))))}function cn(e){(e=e||{}).tables=e.tables||{},e.empty||(Er(e.familyName,"When creating a new Font object, familyName is required."),Er(e.styleName,"When creating a new Font object, styleName is required."),Er(e.unitsPerEm,"When creating a new Font object, unitsPerEm is required."),Er(e.ascender,"When creating a new Font object, ascender is required."),Er(e.descender<=0,"When creating a new Font object, negative descender value is required."),this.names={fontFamily:{en:e.familyName||" "},fontSubfamily:{en:e.styleName||" "},fullName:{en:e.fullName||e.familyName+" "+e.styleName},postScriptName:{en:e.postScriptName||(e.familyName+e.styleName).replace(/\s/g,"")},designer:{en:e.designer||" "},designerURL:{en:e.designerURL||" "},manufacturer:{en:e.manufacturer||" "},manufacturerURL:{en:e.manufacturerURL||" "},license:{en:e.license||" "},licenseURL:{en:e.licenseURL||" "},version:{en:e.version||"Version 0.1"},description:{en:e.description||" "},copyright:{en:e.copyright||" "},trademark:{en:e.trademark||" "}},this.unitsPerEm=e.unitsPerEm||1e3,this.ascender=e.ascender,this.descender=e.descender,this.createdTimestamp=e.createdTimestamp,this.tables=Object.assign(e.tables,{os2:Object.assign({usWeightClass:e.weightClass||this.usWeightClasses.MEDIUM,usWidthClass:e.widthClass||this.usWidthClasses.MEDIUM,fsSelection:e.fsSelection||this.fsSelectionValues.REGULAR},e.tables.os2)})),this.supported=!0,this.glyphs=new At.GlyphSet(this,e.glyphs||[]),this.encoding=new ut(this),this.position=new Br(this),this.substitution=new Cr(this),this.tables=this.tables||{},this._push=null,this._hmtxTableData={},Object.defineProperty(this,"hinting",{get:function(){return this._hinting?this._hinting:"truetype"===this.outlinesFormat?this._hinting=new Gr(this):void 0}})}function ln(e,t){var r=JSON.stringify(e),a=256;for(var n in t){var s=parseInt(n);if(s&&!(s<256)){if(JSON.stringify(t[n])===r)return s;a<=s&&(a=s+1)}}return t[a]=e,a}function un(e,t,r){var a=ln(t.name,r);return[{name:"tag_"+e,type:"TAG",value:t.tag},{name:"minValue_"+e,type:"FIXED",value:t.minValue<<16},{name:"defaultValue_"+e,type:"FIXED",value:t.defaultValue<<16},{name:"maxValue_"+e,type:"FIXED",value:t.maxValue<<16},{name:"flags_"+e,type:"USHORT",value:0},{name:"nameID_"+e,type:"USHORT",value:a}]}function hn(e,t,r){var a={},n=new at.Parser(e,t);return a.tag=n.parseTag(),a.minValue=n.parseFixed(),a.defaultValue=n.parseFixed(),a.maxValue=n.parseFixed(),n.skip("uShort",1),a.name=r[n.parseUShort()]||{},a}function pn(e,t,r,a){for(var n=[{name:"nameID_"+e,type:"USHORT",value:ln(t.name,a)},{name:"flags_"+e,type:"USHORT",value:0}],s=0;s<r.length;++s){var i=r[s].tag;n.push({name:"axis_"+e+" "+i,type:"FIXED",value:t.coordinates[i]<<16})}return n}function fn(e,t,r,a){var n={},s=new at.Parser(e,t);n.name=a[s.parseUShort()]||{},s.skip("uShort",1),n.coordinates={};for(var i=0;i<r.length;++i)n.coordinates[r[i].tag]=s.parseFixed();return n}$a.prototype.setText=function(e){this.text=e},$a.prototype.contextChecks={latinWordCheck:Qa,arabicWordCheck:ja,arabicSentenceCheck:Va},$a.prototype.registerFeatures=function(e,t){var r=this,a=t.filter((function(t){return r.query.supports({script:e,tag:t})}));this.featuresTags.hasOwnProperty(e)?this.featuresTags[e]=this.featuresTags[e].concat(a):this.featuresTags[e]=a},$a.prototype.applyFeatures=function(e,t){if(!e)throw new Error("No valid font was provided to apply features");this.query||(this.query=new Da(e));for(var r=0;r<t.length;r++){var a=t[r];this.query.supports({script:a.script})&&this.registerFeatures(a.script,a.tags)}},$a.prototype.registerModifier=function(e,t,r){this.tokenizer.registerModifier(e,t,r)},$a.prototype.checkContextReady=function(e){return!!this.tokenizer.getContext(e)},$a.prototype.applyFeaturesToContexts=function(){this.checkContextReady("arabicWord")&&(nn.call(this),sn.call(this)),this.checkContextReady("latinWord")&&on.call(this),this.checkContextReady("arabicSentence")&&rn.call(this)},$a.prototype.processText=function(e){this.text&&this.text===e||(this.setText(e),tn.call(this),this.applyFeaturesToContexts())},$a.prototype.getBidiText=function(e){return this.processText(e),this.tokenizer.getText()},$a.prototype.getTextGlyphs=function(e){this.processText(e);for(var t=[],r=0;r<this.tokenizer.tokens.length;r++){var a=this.tokenizer.tokens[r];if(!a.state.deleted){var n=a.activeState.value;t.push(Array.isArray(n)?n[0]:n)}}return t},cn.prototype.hasChar=function(e){return null!==this.encoding.charToGlyphIndex(e)},cn.prototype.charToGlyphIndex=function(e){return this.encoding.charToGlyphIndex(e)},cn.prototype.charToGlyph=function(e){var t=this.charToGlyphIndex(e),r=this.glyphs.get(t);return r||(r=this.glyphs.get(0)),r},cn.prototype.updateFeatures=function(e){return this.defaultRenderOptions.features.map((function(t){return"latn"===t.script?{script:"latn",tags:t.tags.filter((function(t){return e[t]}))}:t}))},cn.prototype.stringToGlyphs=function(e,t){var r=this,a=new $a;a.registerModifier("glyphIndex",null,(function(e){return r.charToGlyphIndex(e.char)}));var n=t?this.updateFeatures(t.features):this.defaultRenderOptions.features;a.applyFeatures(this,n);for(var s=a.getTextGlyphs(e),i=s.length,o=new Array(i),c=this.glyphs.get(0),l=0;l<i;l+=1)o[l]=this.glyphs.get(s[l])||c;return o},cn.prototype.nameToGlyphIndex=function(e){return this.glyphNames.nameToGlyphIndex(e)},cn.prototype.nameToGlyph=function(e){var t=this.nameToGlyphIndex(e),r=this.glyphs.get(t);return r||(r=this.glyphs.get(0)),r},cn.prototype.glyphIndexToName=function(e){return this.glyphNames.glyphIndexToName?this.glyphNames.glyphIndexToName(e):""},cn.prototype.getKerningValue=function(e,t){e=e.index||e,t=t.index||t;var r=this.position.defaultKerningTables;return r?this.position.getKerningValue(r,e,t):this.kerningPairs[e+","+t]||0},cn.prototype.defaultRenderOptions={kerning:!0,features:[{script:"arab",tags:["init","medi","fina","rlig"]},{script:"latn",tags:["liga","rlig"]}]},cn.prototype.forEachGlyph=function(e,t,r,a,n,s){t=void 0!==t?t:0,r=void 0!==r?r:0,a=void 0!==a?a:72,n=Object.assign({},this.defaultRenderOptions,n);var i,o=1/this.unitsPerEm*a,c=this.stringToGlyphs(e,n);if(n.kerning){var l=n.script||this.position.getDefaultScriptName();i=this.position.getKerningTables(l,n.language)}for(var u=0;u<c.length;u+=1){var h=c[u];if(s.call(this,h,t,r,a,n),h.advanceWidth&&(t+=h.advanceWidth*o),n.kerning&&u<c.length-1)t+=(i?this.position.getKerningValue(i,h.index,c[u+1].index):this.getKerningValue(h,c[u+1]))*o;n.letterSpacing?t+=n.letterSpacing*a:n.tracking&&(t+=n.tracking/1e3*a)}return t},cn.prototype.getPath=function(e,t,r,a,n){var s=new we;return this.forEachGlyph(e,t,r,a,n,(function(e,t,r,a){var i=e.getPath(t,r,a,n,this);s.extend(i)})),s},cn.prototype.getPaths=function(e,t,r,a,n){var s=[];return this.forEachGlyph(e,t,r,a,n,(function(e,t,r,a){var i=e.getPath(t,r,a,n,this);s.push(i)})),s},cn.prototype.getAdvanceWidth=function(e,t,r){return this.forEachGlyph(e,0,0,t,r,(function(){}))},cn.prototype.draw=function(e,t,r,a,n,s){this.getPath(t,r,a,n,s).draw(e)},cn.prototype.drawPoints=function(e,t,r,a,n,s){this.forEachGlyph(t,r,a,n,s,(function(t,r,a,n){t.drawPoints(e,r,a,n)}))},cn.prototype.drawMetrics=function(e,t,r,a,n,s){this.forEachGlyph(t,r,a,n,s,(function(t,r,a,n){t.drawMetrics(e,r,a,n)}))},cn.prototype.getEnglishName=function(e){var t=this.names[e];if(t)return t.en},cn.prototype.validate=function(){var e=this;function t(t){var r=e.getEnglishName(t);r&&r.trim().length}t("fontFamily"),t("weightName"),t("manufacturer"),t("copyright"),t("version"),this.unitsPerEm},cn.prototype.toTables=function(){return mr.fontToTable(this)},cn.prototype.toBuffer=function(){return console.warn("Font.toBuffer is deprecated. Use Font.toArrayBuffer instead."),this.toArrayBuffer()},cn.prototype.toArrayBuffer=function(){for(var e=this.toTables().encode(),t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a<e.length;a++)r[a]=e[a];return t},cn.prototype.download=function(e){var t=this.getEnglishName("fontFamily"),r=this.getEnglishName("fontSubfamily");e=e||t.replace(/\s/g,"")+"-"+r+".otf";var a=this.toArrayBuffer();if("undefined"!=typeof window)if(window.URL=window.URL||window.webkitURL,window.URL){var n=new DataView(a),s=new Blob([n],{type:"font/opentype"}),i=document.createElement("a");i.href=window.URL.createObjectURL(s),i.download=e;var o=document.createEvent("MouseEvents");o.initEvent("click",!0,!1),i.dispatchEvent(o)}else console.warn("Font file could not be downloaded. Try using a different browser.");else{var c=require("fs"),l=function(e){for(var t=new Buffer(e.byteLength),r=new Uint8Array(e),a=0;a<t.length;++a)t[a]=r[a];return t}(a);c.writeFileSync(e,l)}},cn.prototype.fsSelectionValues={ITALIC:1,UNDERSCORE:2,NEGATIVE:4,OUTLINED:8,STRIKEOUT:16,BOLD:32,REGULAR:64,USER_TYPO_METRICS:128,WWS:256,OBLIQUE:512},cn.prototype.usWidthClasses={ULTRA_CONDENSED:1,EXTRA_CONDENSED:2,CONDENSED:3,SEMI_CONDENSED:4,MEDIUM:5,SEMI_EXPANDED:6,EXPANDED:7,EXTRA_EXPANDED:8,ULTRA_EXPANDED:9},cn.prototype.usWeightClasses={THIN:100,EXTRA_LIGHT:200,LIGHT:300,NORMAL:400,MEDIUM:500,SEMI_BOLD:600,BOLD:700,EXTRA_BOLD:800,BLACK:900};var dn={make:function(e,t){var r=new Ye.Table("fvar",[{name:"version",type:"ULONG",value:65536},{name:"offsetToData",type:"USHORT",value:0},{name:"countSizePairs",type:"USHORT",value:2},{name:"axisCount",type:"USHORT",value:e.axes.length},{name:"axisSize",type:"USHORT",value:20},{name:"instanceCount",type:"USHORT",value:e.instances.length},{name:"instanceSize",type:"USHORT",value:4+4*e.axes.length}]);r.offsetToData=r.sizeOf();for(var a=0;a<e.axes.length;a++)r.fields=r.fields.concat(un(a,e.axes[a],t));for(var n=0;n<e.instances.length;n++)r.fields=r.fields.concat(pn(n,e.instances[n],e.axes,t));return r},parse:function(e,t,r){var a=new at.Parser(e,t),n=a.parseULong();Ie.argument(65536===n,"Unsupported fvar table version.");var s=a.parseOffset16();a.skip("uShort",1);for(var i=a.parseUShort(),o=a.parseUShort(),c=a.parseUShort(),l=a.parseUShort(),u=[],h=0;h<i;h++)u.push(hn(e,t+s+h*o,r));for(var p=[],f=t+s+i*o,d=0;d<c;d++)p.push(fn(e,f+d*l,u,r));return{axes:u,instances:p}}},gn=new Array(10);gn[1]=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort();return 1===t?{posFormat:1,coverage:this.parsePointer(tt.coverage),value:this.parseValueRecord()}:2===t?{posFormat:2,coverage:this.parsePointer(tt.coverage),values:this.parseValueRecordList()}:void Ie.assert(!1,"0x"+e.toString(16)+": GPOS lookup type 1 format must be 1 or 2.")},gn[2]=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort();Ie.assert(1===t||2===t,"0x"+e.toString(16)+": GPOS lookup type 2 format must be 1 or 2.");var r=this.parsePointer(tt.coverage),a=this.parseUShort(),n=this.parseUShort();if(1===t)return{posFormat:t,coverage:r,valueFormat1:a,valueFormat2:n,pairSets:this.parseList(tt.pointer(tt.list((function(){return{secondGlyph:this.parseUShort(),value1:this.parseValueRecord(a),value2:this.parseValueRecord(n)}}))))};if(2===t){var s=this.parsePointer(tt.classDef),i=this.parsePointer(tt.classDef),o=this.parseUShort(),c=this.parseUShort();return{posFormat:t,coverage:r,valueFormat1:a,valueFormat2:n,classDef1:s,classDef2:i,class1Count:o,class2Count:c,classRecords:this.parseList(o,tt.list(c,(function(){return{value1:this.parseValueRecord(a),value2:this.parseValueRecord(n)}})))}}},gn[3]=function(){return{error:"GPOS Lookup 3 not supported"}},gn[4]=function(){return{error:"GPOS Lookup 4 not supported"}},gn[5]=function(){return{error:"GPOS Lookup 5 not supported"}},gn[6]=function(){return{error:"GPOS Lookup 6 not supported"}},gn[7]=function(){return{error:"GPOS Lookup 7 not supported"}},gn[8]=function(){return{error:"GPOS Lookup 8 not supported"}},gn[9]=function(){return{error:"GPOS Lookup 9 not supported"}};var mn=new Array(10);var vn={parse:function(e,t){var r=new tt(e,t=t||0),a=r.parseVersion(1);return Ie.argument(1===a||1.1===a,"Unsupported GPOS table version "+a),1===a?{version:a,scripts:r.parseScriptList(),features:r.parseFeatureList(),lookups:r.parseLookupList(gn)}:{version:a,scripts:r.parseScriptList(),features:r.parseFeatureList(),lookups:r.parseLookupList(gn),variations:r.parseFeatureVariationsList()}},make:function(e){return new Ye.Table("GPOS",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new Ye.ScriptList(e.scripts)},{name:"features",type:"TABLE",value:new Ye.FeatureList(e.features)},{name:"lookups",type:"TABLE",value:new Ye.LookupList(e.lookups,mn)}])}};var yn={parse:function(e,t){var r=new at.Parser(e,t),a=r.parseUShort();if(0===a)return function(e){var t={};e.skip("uShort");var r=e.parseUShort();Ie.argument(0===r,"Unsupported kern sub-table version."),e.skip("uShort",2);var a=e.parseUShort();e.skip("uShort",3);for(var n=0;n<a;n+=1){var s=e.parseUShort(),i=e.parseUShort(),o=e.parseShort();t[s+","+i]=o}return t}(r);if(1===a)return function(e){var t={};e.skip("uShort"),e.parseULong()>1&&console.warn("Only the first kern subtable is supported."),e.skip("uLong");var r=255&e.parseUShort();if(e.skip("uShort"),0===r){var a=e.parseUShort();e.skip("uShort",3);for(var n=0;n<a;n+=1){var s=e.parseUShort(),i=e.parseUShort(),o=e.parseShort();t[s+","+i]=o}}return t}(r);throw new Error("Unsupported kern table version ("+a+").")}};var An={parse:function(e,t,r,a){for(var n=new at.Parser(e,t),s=a?n.parseUShort:n.parseULong,i=[],o=0;o<r+1;o+=1){var c=s.call(n);a&&(c*=2),i.push(c)}return i}};function bn(e,t){require("fs").readFile(e,(function(e,r){if(e)return t(e.message);t(null,wr(r))}))}function Bn(e,t){var r=new XMLHttpRequest;r.open("get",e,!0),r.responseType="arraybuffer",r.onload=function(){return r.response?t(null,r.response):t("Font could not be loaded: "+r.statusText)},r.onerror=function(){t("Font could not be loaded")},r.send()}function Cn(e,t){for(var r=[],a=12,n=0;n<t;n+=1){var s=at.getTag(e,a),i=at.getULong(e,a+4),o=at.getULong(e,a+8),c=at.getULong(e,a+12);r.push({tag:s,checksum:i,offset:o,length:c,compression:!1}),a+=16}return r}function xn(e,t){if("WOFF"===t.compression){var r=new Uint8Array(e.buffer,t.offset+2,t.compressedLength-2),a=new Uint8Array(t.length);if(Ce(r,a),a.byteLength!==t.length)throw new Error("Decompression error: "+t.tag+" decompressed length doesn't match recorded length");return{data:new DataView(a.buffer,0),offset:0}}return{data:e,offset:t.offset}}function Fn(e,t){var r,a;t=null==t?{}:t;var n,s,i,o,c,l,u,h,p,f,d,g,m=new cn({empty:!0}),v=new DataView(e,0),y=[],A=at.getTag(v,0);if(A===String.fromCharCode(0,1,0,0)||"true"===A||"typ1"===A)m.outlinesFormat="truetype",y=Cn(v,n=at.getUShort(v,4));else if("OTTO"===A)m.outlinesFormat="cff",y=Cn(v,n=at.getUShort(v,4));else{if("wOFF"!==A)throw new Error("Unsupported OpenType signature "+A);var b=at.getTag(v,4);if(b===String.fromCharCode(0,1,0,0))m.outlinesFormat="truetype";else{if("OTTO"!==b)throw new Error("Unsupported OpenType flavor "+A);m.outlinesFormat="cff"}y=function(e,t){for(var r=[],a=44,n=0;n<t;n+=1){var s=at.getTag(e,a),i=at.getULong(e,a+4),o=at.getULong(e,a+8),c=at.getULong(e,a+12),l=void 0;l=o<c&&"WOFF",r.push({tag:s,offset:i,compression:l,compressedLength:o,length:c}),a+=20}return r}(v,n=at.getUShort(v,12))}for(var B=0;B<n;B+=1){var C=y[B],x=void 0;switch(C.tag){case"cmap":x=xn(v,C),m.tables.cmap=st.parse(x.data,x.offset),m.encoding=new ht(m.tables.cmap);break;case"cvt ":x=xn(v,C),g=new at.Parser(x.data,x.offset),m.tables.cvt=g.parseShortList(C.length/2);break;case"fvar":i=C;break;case"fpgm":x=xn(v,C),g=new at.Parser(x.data,x.offset),m.tables.fpgm=g.parseByteList(C.length);break;case"head":x=xn(v,C),m.tables.head=Pt.parse(x.data,x.offset),m.unitsPerEm=m.tables.head.unitsPerEm,r=m.tables.head.indexToLocFormat;break;case"hhea":x=xn(v,C),m.tables.hhea=Ht.parse(x.data,x.offset),m.ascender=m.tables.hhea.ascender,m.descender=m.tables.hhea.descender,m.numberOfHMetrics=m.tables.hhea.numberOfHMetrics;break;case"hmtx":u=C;break;case"ltag":x=xn(v,C),a=_t.parse(x.data,x.offset);break;case"maxp":x=xn(v,C),m.tables.maxp=jt.parse(x.data,x.offset),m.numGlyphs=m.tables.maxp.numGlyphs;break;case"name":f=C;break;case"OS/2":x=xn(v,C),m.tables.os2=ar.parse(x.data,x.offset);break;case"post":x=xn(v,C),m.tables.post=nr.parse(x.data,x.offset),m.glyphNames=new ft(m.tables.post);break;case"prep":x=xn(v,C),g=new at.Parser(x.data,x.offset),m.tables.prep=g.parseByteList(C.length);break;case"glyf":o=C;break;case"loca":p=C;break;case"CFF ":s=C;break;case"kern":h=C;break;case"GPOS":c=C;break;case"GSUB":l=C;break;case"meta":d=C}}var F=xn(v,f);if(m.tables.name=tr.parse(F.data,F.offset,a),m.names=m.tables.name,o&&p){var w=0===r,E=xn(v,p),S=An.parse(E.data,E.offset,m.numGlyphs,w),I=xn(v,o);m.glyphs=Ur.parse(I.data,I.offset,S,m,t)}else{if(!s)throw new Error("Font doesn't contain TrueType or CFF outlines.");var M=xn(v,s);Nt.parse(M.data,M.offset,m,t)}var T=xn(v,u);if(Jt.parse(m,T.data,T.offset,m.numberOfHMetrics,m.numGlyphs,m.glyphs,t),dt(m,t),h){var k=xn(v,h);m.kerningPairs=yn.parse(k.data,k.offset)}else m.kerningPairs={};if(c){var R=xn(v,c);m.tables.gpos=vn.parse(R.data,R.offset),m.position.init()}if(l){var L=xn(v,l);m.tables.gsub=cr.parse(L.data,L.offset)}if(i){var D=xn(v,i);m.tables.fvar=dn.parse(D.data,D.offset,m.names)}if(d){var O=xn(v,d);m.tables.meta=lr.parse(O.data,O.offset),m.metas=m.tables.meta}return m}var wn=Object.freeze({__proto__:null,Font:cn,Glyph:mt,Path:we,BoundingBox:Fe,_parse:at,parse:Fn,load:function(e,t,r){var a="undefined"==typeof window?bn:Bn;return new Promise((function(n,s){a(e,(function(e,a){if(e){if(t)return t(e);s(e)}var i;try{i=Fn(a,r)}catch(e){if(t)return t(e,null);s(e)}if(t)return t(null,i);n(i)}))}))},loadSync:function(e,t){return Fn(wr(require("fs").readFileSync(e)),t)}}),En=function(t){e.Loader.call(this,t),this.reversed=!1};En.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:En,load:function(t,r,a,n){var s=this,i=new e.FileLoader(this.manager);i.setPath(this.path),i.setResponseType("arraybuffer"),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials),i.load(t,(function(e){try{r(s.parse(e))}catch(e){n?n(e):console.error(e),s.manager.itemError(t)}}),a,n)},parse:function(e){function t(e){var t,r=[];e.forEach((function(e){"m"===e.type.toLowerCase()?(t=[e],r.push(t)):"z"!==e.type.toLowerCase()&&t.push(e)}));var a=[];return r.forEach((function(e){var t={type:"m",x:e[e.length-1].x,y:e[e.length-1].y};a.push(t);for(var r=e.length-1;r>0;r--){var n=e[r];t={type:n.type};void 0!==n.x2&&void 0!==n.y2?(t.x1=n.x2,t.y1=n.y2,t.x2=n.x1,t.y2=n.y1):void 0!==n.x1&&void 0!==n.y1&&(t.x1=n.x1,t.y1=n.y1),t.x=e[r-1].x,t.y=e[r-1].y,a.push(t)}})),a}return void 0===wn?(console.warn("THREE.TTFLoader: The loader requires opentype.js. Make sure it's included before using the loader."),null):function(e,r){for(var a=Math.round,n={},s=1e5/(72*(e.unitsPerEm||2048)),i=e.encoding.cmap.glyphIndexMap,o=Object.keys(i),c=0;c<o.length;c++){var l=o[c],u=e.glyphs.glyphs[i[l]];if(void 0!==l){var h={ha:a(u.advanceWidth*s),x_min:a(u.xMin*s),x_max:a(u.xMax*s),o:""};r&&(u.path.commands=t(u.path.commands)),u.path.commands.forEach((function(e){"c"===e.type.toLowerCase()&&(e.type="b"),h.o+=e.type.toLowerCase()+" ",void 0!==e.x&&void 0!==e.y&&(h.o+=a(e.x*s)+" "+a(e.y*s)+" "),void 0!==e.x1&&void 0!==e.y1&&(h.o+=a(e.x1*s)+" "+a(e.y1*s)+" "),void 0!==e.x2&&void 0!==e.y2&&(h.o+=a(e.x2*s)+" "+a(e.y2*s)+" ")})),n[String.fromCodePoint(u.unicode)]=h}}return{glyphs:n,familyName:e.getEnglishName("fullName"),ascender:a(e.ascender*s),descender:a(e.descender*s),underlinePosition:e.tables.post.underlinePosition,underlineThickness:e.tables.post.underlineThickness,boundingBox:{xMin:e.tables.head.xMin,xMax:e.tables.head.xMax,yMin:e.tables.head.yMin,yMax:e.tables.head.yMax},resolution:1e3,original_font_information:e.tables.name}}(wn.parse(e),this.reversed)}});var Sn=function(t){e.Loader.call(this,t),this.animateBonePositions=!0,this.animateBoneRotations=!0};function In(e){let t,r=e[0],a=1;for(;a<e.length;){const n=e[a],s=e[a+1];if(a+=2,("optionalAccess"===n||"optionalCall"===n)&&null==r)return;"access"===n||"optionalAccess"===n?(t=r,r=s(r)):"call"!==n&&"optionalCall"!==n||(r=s(((...e)=>r.call(t,...e))),t=void 0)}return r}Sn.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:Sn,load:function(t,r,a,n){var s=this,i=new e.FileLoader(s.manager);i.setPath(s.path),i.setRequestHeader(s.requestHeader),i.setWithCredentials(s.withCredentials),i.load(t,(function(e){try{r(s.parse(e))}catch(e){n?n(e):console.error(e),s.manager.itemError(t)}}),a,n)},parse:function(t){function r(t,a,n){if("ENDSITE"!==n.type){var s={time:a,position:new e.Vector3,rotation:new e.Quaternion};n.frames.push(s);for(var i=new e.Quaternion,o=new e.Vector3(1,0,0),c=new e.Vector3(0,1,0),l=new e.Vector3(0,0,1),u=0;u<n.channels.length;u++)switch(n.channels[u]){case"Xposition":s.position.x=parseFloat(t.shift().trim());break;case"Yposition":s.position.y=parseFloat(t.shift().trim());break;case"Zposition":s.position.z=parseFloat(t.shift().trim());break;case"Xrotation":i.setFromAxisAngle(o,parseFloat(t.shift().trim())*Math.PI/180),s.rotation.multiply(i);break;case"Yrotation":i.setFromAxisAngle(c,parseFloat(t.shift().trim())*Math.PI/180),s.rotation.multiply(i);break;case"Zrotation":i.setFromAxisAngle(l,parseFloat(t.shift().trim())*Math.PI/180),s.rotation.multiply(i);break;default:console.warn("THREE.BVHLoader: Invalid channel type.")}for(u=0;u<n.children.length;u++)r(t,a,n.children[u])}}function a(t,r,s){var i={name:"",type:"",frames:[]};s.push(i);var o=r.split(/[\s]+/);"END"===o[0].toUpperCase()&&"SITE"===o[1].toUpperCase()?(i.type="ENDSITE",i.name="ENDSITE"):(i.name=o[1],i.type=o[0].toUpperCase()),"{"!==n(t)&&console.error("THREE.BVHLoader: Expected opening { after type & name"),"OFFSET"!==(o=n(t).split(/[\s]+/))[0]&&console.error("THREE.BVHLoader: Expected OFFSET but got: "+o[0]),4!==o.length&&console.error("THREE.BVHLoader: Invalid number of values for OFFSET.");var c=new e.Vector3(parseFloat(o[1]),parseFloat(o[2]),parseFloat(o[3]));if((isNaN(c.x)||isNaN(c.y)||isNaN(c.z))&&console.error("THREE.BVHLoader: Invalid values of OFFSET."),i.offset=c,"ENDSITE"!==i.type){"CHANNELS"!==(o=n(t).split(/[\s]+/))[0]&&console.error("THREE.BVHLoader: Expected CHANNELS definition.");var l=parseInt(o[1]);i.channels=o.splice(2,l),i.children=[]}for(;;){var u=n(t);if("}"===u)return i;i.children.push(a(t,u,s))}}function n(e){for(var t;0===(t=e.shift().trim()).length;);return t}var s=this,i=function(e){"HIERARCHY"!==n(e)&&console.error("THREE.BVHLoader: HIERARCHY expected.");var t=[],s=a(e,n(e),t);"MOTION"!==n(e)&&console.error("THREE.BVHLoader: MOTION expected.");var i=n(e).split(/[\s]+/),o=parseInt(i[1]);isNaN(o)&&console.error("THREE.BVHLoader: Failed to read number of frames."),i=n(e).split(/[\s]+/);var c=parseFloat(i[2]);isNaN(c)&&console.error("THREE.BVHLoader: Failed to read frame time.");for(var l=0;l<o;l++)r(i=n(e).split(/[\s]+/),l*c,s);return t}(t.split(/[\r\n]+/g)),o=[];!function t(r,a){var n=new e.Bone;if(a.push(n),n.position.add(r.offset),n.name=r.name,"ENDSITE"!==r.type)for(var s=0;s<r.children.length;s++)n.add(t(r.children[s],a));return n}(i[0],o);var c=function(t){for(var r=[],a=0;a<t.length;a++){var n=t[a];if("ENDSITE"!==n.type){for(var i=[],o=[],c=[],l=0;l<n.frames.length;l++){var u=n.frames[l];i.push(u.time),o.push(u.position.x+n.offset.x),o.push(u.position.y+n.offset.y),o.push(u.position.z+n.offset.z),c.push(u.rotation.x),c.push(u.rotation.y),c.push(u.rotation.z),c.push(u.rotation.w)}s.animateBonePositions&&r.push(new e.VectorKeyframeTrack(".bones["+n.name+"].position",i,o)),s.animateBoneRotations&&r.push(new e.QuaternionKeyframeTrack(".bones["+n.name+"].quaternion",i,c))}}return new e.AnimationClip("animation",-1,r)}(i);return{skeleton:new e.Skeleton(o),clip:c}}});
/*!
fflate - fast JavaScript compression/decompression
<https://101arrowz.github.io/fflate>
Licensed under MIT. https://github.com/101arrowz/fflate/blob/master/LICENSE
*/
var Mn={},Tn=Uint8Array,kn=Uint16Array,Rn=Uint32Array,Ln=new Tn([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Dn=new Tn([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),On=new Tn([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Un=function(e,t){for(var r=new kn(31),a=0;a<31;++a)r[a]=t+=1<<e[a-1];var n=new Rn(r[30]);for(a=1;a<30;++a)for(var s=r[a];s<r[a+1];++s)n[s]=s-r[a]<<5|a;return[r,n]},Gn=Un(Ln,2),Nn=Gn[0],Pn=Gn[1];Nn[28]=258,Pn[258]=28;for(var Hn=Un(Dn,0),Jn=Hn[0],_n=Hn[1],jn=new kn(32768),Vn=0;Vn<32768;++Vn){var Xn=(43690&Vn)>>>1|(21845&Vn)<<1;Xn=(61680&(Xn=(52428&Xn)>>>2|(13107&Xn)<<2))>>>4|(3855&Xn)<<4,jn[Vn]=((65280&Xn)>>>8|(255&Xn)<<8)>>>1}var Kn=function(e,t,r){for(var a=e.length,n=0,s=new kn(t);n<a;++n)++s[e[n]-1];var i,o=new kn(t);for(n=0;n<t;++n)o[n]=o[n-1]+s[n-1]<<1;if(r){i=new kn(1<<t);var c=15-t;for(n=0;n<a;++n)if(e[n])for(var l=n<<4|e[n],u=t-e[n],h=o[e[n]-1]++<<u,p=h|(1<<u)-1;h<=p;++h)i[jn[h]>>>c]=l}else for(i=new kn(a),n=0;n<a;++n)e[n]&&(i[n]=jn[o[e[n]-1]++]>>>15-e[n]);return i},zn=new Tn(288);for(Vn=0;Vn<144;++Vn)zn[Vn]=8;for(Vn=144;Vn<256;++Vn)zn[Vn]=9;for(Vn=256;Vn<280;++Vn)zn[Vn]=7;for(Vn=280;Vn<288;++Vn)zn[Vn]=8;var Wn=new Tn(32);for(Vn=0;Vn<32;++Vn)Wn[Vn]=5;var Yn=Kn(zn,9,0),Qn=Kn(zn,9,1),qn=Kn(Wn,5,0),Zn=Kn(Wn,5,1),$n=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},es=function(e,t,r){var a=t/8|0;return(e[a]|e[a+1]<<8)>>(7&t)&r},ts=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(7&t)},rs=function(e){return(e/8|0)+(7&e&&1)},as=function(e,t,r){(null==t||t<0)&&(t=0),(null==r||r>e.length)&&(r=e.length);var a=new(e instanceof kn?kn:e instanceof Rn?Rn:Tn)(r-t);return a.set(e.subarray(t,r)),a},ns=function(e,t,r){var a=e.length;if(!a||r&&!r.l&&a<5)return t||new Tn(0);var n=!t||r,s=!r||r.i;r||(r={}),t||(t=new Tn(3*a));var i=function(e){var r=t.length;if(e>r){var a=new Tn(Math.max(2*r,e));a.set(t),t=a}},o=r.f||0,c=r.p||0,l=r.b||0,u=r.l,h=r.d,p=r.m,f=r.n,d=8*a;do{if(!u){r.f=o=es(e,c,1);var g=es(e,c+1,3);if(c+=3,!g){var m=e[(S=rs(c)+4)-4]|e[S-3]<<8,v=S+m;if(v>a){if(s)throw"unexpected EOF";break}n&&i(l+m),t.set(e.subarray(S,v),l),r.b=l+=m,r.p=c=8*v;continue}if(1==g)u=Qn,h=Zn,p=9,f=5;else{if(2!=g)throw"invalid block type";var y=es(e,c,31)+257,A=es(e,c+10,15)+4,b=y+es(e,c+5,31)+1;c+=14;for(var B=new Tn(b),C=new Tn(19),x=0;x<A;++x)C[On[x]]=es(e,c+3*x,7);c+=3*A;var F=$n(C),w=(1<<F)-1;if(!s&&c+b*(F+7)>d)break;var E=Kn(C,F,1);for(x=0;x<b;){var S,I=E[es(e,c,w)];if(c+=15&I,(S=I>>>4)<16)B[x++]=S;else{var M=0,T=0;for(16==S?(T=3+es(e,c,3),c+=2,M=B[x-1]):17==S?(T=3+es(e,c,7),c+=3):18==S&&(T=11+es(e,c,127),c+=7);T--;)B[x++]=M}}var k=B.subarray(0,y),R=B.subarray(y);p=$n(k),f=$n(R),u=Kn(k,p,1),h=Kn(R,f,1)}if(c>d)throw"unexpected EOF"}n&&i(l+131072);for(var L=(1<<p)-1,D=(1<<f)-1,O=p+f+18;s||c+O<d;){var U=(M=u[ts(e,c)&L])>>>4;if((c+=15&M)>d)throw"unexpected EOF";if(!M)throw"invalid length/literal";if(U<256)t[l++]=U;else{if(256==U){u=null;break}var G=U-254;if(U>264){var N=Ln[x=U-257];G=es(e,c,(1<<N)-1)+Nn[x],c+=N}var P=h[ts(e,c)&D],H=P>>>4;if(!P)throw"invalid distance";c+=15&P;R=Jn[H];if(H>3){N=Dn[H];R+=ts(e,c)&(1<<N)-1,c+=N}if(c>d)throw"unexpected EOF";n&&i(l+131072);for(var J=l+G;l<J;l+=4)t[l]=t[l-R],t[l+1]=t[l+1-R],t[l+2]=t[l+2-R],t[l+3]=t[l+3-R];l=J}}r.l=u,r.p=c,r.b=l,u&&(o=1,r.m=p,r.d=h,r.n=f)}while(!o);return l==t.length?t:as(t,0,l)},ss=function(e,t,r){r<<=7&t;var a=t/8|0;e[a]|=r,e[a+1]|=r>>>8},is=function(e,t,r){r<<=7&t;var a=t/8|0;e[a]|=r,e[a+1]|=r>>>8,e[a+2]|=r>>>16},os=function(e,t){for(var r=[],a=0;a<e.length;++a)e[a]&&r.push({s:a,f:e[a]});var n=r.length,s=r.slice();if(!n)return[ds,0];if(1==n){var i=new Tn(r[0].s+1);return i[r[0].s]=1,[i,1]}r.sort((function(e,t){return e.f-t.f})),r.push({s:-1,f:25001});var o=r[0],c=r[1],l=0,u=1,h=2;for(r[0]={s:-1,f:o.f+c.f,l:o,r:c};u!=n-1;)o=r[r[l].f<r[h].f?l++:h++],c=r[l!=u&&r[l].f<r[h].f?l++:h++],r[u++]={s:-1,f:o.f+c.f,l:o,r:c};var p=s[0].s;for(a=1;a<n;++a)s[a].s>p&&(p=s[a].s);var f=new kn(p+1),d=cs(r[u-1],f,0);if(d>t){a=0;var g=0,m=d-t,v=1<<m;for(s.sort((function(e,t){return f[t.s]-f[e.s]||e.f-t.f}));a<n;++a){var y=s[a].s;if(!(f[y]>t))break;g+=v-(1<<d-f[y]),f[y]=t}for(g>>>=m;g>0;){var A=s[a].s;f[A]<t?g-=1<<t-f[A]++-1:++a}for(;a>=0&&g;--a){var b=s[a].s;f[b]==t&&(--f[b],++g)}d=t}return[new Tn(f),d]},cs=function(e,t,r){return-1==e.s?Math.max(cs(e.l,t,r+1),cs(e.r,t,r+1)):t[e.s]=r},ls=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new kn(++t),a=0,n=e[0],s=1,i=function(e){r[a++]=e},o=1;o<=t;++o)if(e[o]==n&&o!=t)++s;else{if(!n&&s>2){for(;s>138;s-=138)i(32754);s>2&&(i(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(i(n),--s;s>6;s-=6)i(8304);s>2&&(i(s-3<<5|8208),s=0)}for(;s--;)i(n);s=1,n=e[o]}return[r.subarray(0,a),t]},us=function(e,t){for(var r=0,a=0;a<t.length;++a)r+=e[a]*t[a];return r},hs=function(e,t,r){var a=r.length,n=rs(t+2);e[n]=255&a,e[n+1]=a>>>8,e[n+2]=255^e[n],e[n+3]=255^e[n+1];for(var s=0;s<a;++s)e[n+s+4]=r[s];return 8*(n+4+a)},ps=function(e,t,r,a,n,s,i,o,c,l,u){ss(t,u++,r),++n[256];for(var h=os(n,15),p=h[0],f=h[1],d=os(s,15),g=d[0],m=d[1],v=ls(p),y=v[0],A=v[1],b=ls(g),B=b[0],C=b[1],x=new kn(19),F=0;F<y.length;++F)x[31&y[F]]++;for(F=0;F<B.length;++F)x[31&B[F]]++;for(var w=os(x,7),E=w[0],S=w[1],I=19;I>4&&!E[On[I-1]];--I);var M,T,k,R,L=l+5<<3,D=us(n,zn)+us(s,Wn)+i,O=us(n,p)+us(s,g)+i+14+3*I+us(x,E)+(2*x[16]+3*x[17]+7*x[18]);if(L<=D&&L<=O)return hs(t,u,e.subarray(c,c+l));if(ss(t,u,1+(O<D)),u+=2,O<D){M=Kn(p,f,0),T=p,k=Kn(g,m,0),R=g;var U=Kn(E,S,0);ss(t,u,A-257),ss(t,u+5,C-1),ss(t,u+10,I-4),u+=14;for(F=0;F<I;++F)ss(t,u+3*F,E[On[F]]);u+=3*I;for(var G=[y,B],N=0;N<2;++N){var P=G[N];for(F=0;F<P.length;++F){var H=31&P[F];ss(t,u,U[H]),u+=E[H],H>15&&(ss(t,u,P[F]>>>5&127),u+=P[F]>>>12)}}}else M=Yn,T=zn,k=qn,R=Wn;for(F=0;F<o;++F)if(a[F]>255){H=a[F]>>>18&31;is(t,u,M[H+257]),u+=T[H+257],H>7&&(ss(t,u,a[F]>>>23&31),u+=Ln[H]);var J=31&a[F];is(t,u,k[J]),u+=R[J],J>3&&(is(t,u,a[F]>>>5&8191),u+=Dn[J])}else is(t,u,M[a[F]]),u+=T[a[F]];return is(t,u,M[256]),u+T[256]},fs=new Rn([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),ds=new Tn(0),gs=function(e,t,r,a,n,s){var i=e.length,o=new Tn(a+i+5*(1+Math.ceil(i/7e3))+n),c=o.subarray(a,o.length-n),l=0;if(!t||i<8)for(var u=0;u<=i;u+=65535){var h=u+65535;h<i?l=hs(c,l,e.subarray(u,h)):(c[u]=s,l=hs(c,l,e.subarray(u,i)))}else{for(var p=fs[t-1],f=p>>>13,d=8191&p,g=(1<<r)-1,m=new kn(32768),v=new kn(g+1),y=Math.ceil(r/3),A=2*y,b=function(t){return(e[t]^e[t+1]<<y^e[t+2]<<A)&g},B=new Rn(25e3),C=new kn(288),x=new kn(32),F=0,w=0,E=(u=0,0),S=0,I=0;u<i;++u){var M=b(u),T=32767&u,k=v[M];if(m[T]=k,v[M]=T,S<=u){var R=i-u;if((F>7e3||E>24576)&&R>423){l=ps(e,c,0,B,C,x,w,E,I,u-I,l),E=F=w=0,I=u;for(var L=0;L<286;++L)C[L]=0;for(L=0;L<30;++L)x[L]=0}var D=2,O=0,U=d,G=T-k&32767;if(R>2&&M==b(u-G))for(var N=Math.min(f,R)-1,P=Math.min(32767,u),H=Math.min(258,R);G<=P&&--U&&T!=k;){if(e[u+D]==e[u+D-G]){for(var J=0;J<H&&e[u+J]==e[u+J-G];++J);if(J>D){if(D=J,O=G,J>N)break;var _=Math.min(G,J-2),j=0;for(L=0;L<_;++L){var V=u-G+L+32768&32767,X=V-m[V]+32768&32767;X>j&&(j=X,k=V)}}}G+=(T=k)-(k=m[T])+32768&32767}if(O){B[E++]=268435456|Pn[D]<<18|_n[O];var K=31&Pn[D],z=31&_n[O];w+=Ln[K]+Dn[z],++C[257+K],++x[z],S=u+D,++F}else B[E++]=e[u],++C[e[u]]}}l=ps(e,c,s,B,C,x,w,E,I,u-I,l),!s&&7&l&&(l=hs(c,l+1,ds))}return as(o,0,a+rs(l)+n)},ms=function(){for(var e=new Rn(256),t=0;t<256;++t){for(var r=t,a=9;--a;)r=(1&r&&3988292384)^r>>>1;e[t]=r}return e}(),vs=function(){var e=-1;return{p:function(t){for(var r=e,a=0;a<t.length;++a)r=ms[255&r^t[a]]^r>>>8;e=r},d:function(){return~e}}},ys=function(){var e=1,t=0;return{p:function(r){for(var a=e,n=t,s=r.length,i=0;i!=s;){for(var o=Math.min(i+2655,s);i<o;++i)n+=a+=r[i];a=(65535&a)+15*(a>>16),n=(65535&n)+15*(n>>16)}e=a,t=n},d:function(){return((e%=65521)>>>8<<16|(255&(t%=65521))<<8|t>>>8)+2*((255&e)<<23)}}},As=function(e,t,r,a,n){return gs(e,null==t.level?6:t.level,null==t.mem?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):12+t.mem,r,a,!n)},bs=function(e,t){var r={};for(var a in e)r[a]=e[a];for(var a in t)r[a]=t[a];return r},Bs=function(e,t,r){for(var a=e(),n=e.toString(),s=n.slice(n.indexOf("[")+1,n.lastIndexOf("]")).replace(/ /g,"").split(","),i=0;i<a.length;++i){var o=a[i],c=s[i];if("function"==typeof o){t+=";"+c+"=";var l=o.toString();if(o.prototype)if(-1!=l.indexOf("[native code]")){var u=l.indexOf(" ",8)+1;t+=l.slice(u,l.indexOf("(",u))}else for(var h in t+=l,o.prototype)t+=";"+c+".prototype."+h+"="+o.prototype[h].toString();else t+=l}else r[c]=o}return[t,r]},Cs=[],xs=function(t,r,a,n){var s;if(!Cs[a]){for(var i="",o={},c=t.length-1,l=0;l<c;++l)i=(s=Bs(t[l],i,o))[0],o=s[1];Cs[a]=Bs(t[c],i,o)}var u=bs({},Cs[a][1]);return function(t,r,a,n,s){var i=Mn[r]||(Mn[r]=e.$URL.createObjectURL(new e.$Blob([t],{type:"text/javascript"}))),o=new Worker(i);return o.onerror=function(e){return s(e.error,null)},o.onmessage=function(e){return s(null,e.data)},o.postMessage(a,n),o}(Cs[a][0]+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+r.toString()+"}",a,u,function(e){var t=[];for(var r in e)(e[r]instanceof Tn||e[r]instanceof kn||e[r]instanceof Rn)&&t.push((e[r]=new e[r].constructor(e[r])).buffer);return t}(u),n)},Fs=function(){return[Tn,kn,Rn,Ln,Dn,On,Nn,Jn,Qn,Zn,jn,Kn,$n,es,ts,rs,as,ns,$s,Ts,ks]},ws=function(){return[Tn,kn,Rn,Ln,Dn,On,Pn,_n,Yn,zn,qn,Wn,jn,fs,ds,Kn,ss,is,os,cs,ls,us,hs,ps,rs,as,gs,As,Ys,Ts]},Es=function(){return[Ps,_s,Ns,vs,ms]},Ss=function(){return[Hs,Js]},Is=function(){return[js,Ns,ys]},Ms=function(){return[Vs]},Ts=function(e){return postMessage(e,[e.buffer])},ks=function(e){return e&&e.size&&new Tn(e.size)},Rs=function(e,t,r,a,n,s){var i=xs(r,a,n,(function(e,t){i.terminate(),s(e,t)}));return i.postMessage([e,t],t.consume?[e.buffer]:[]),function(){i.terminate()}},Ls=function(e){return e.ondata=function(e,t){return postMessage([e,t],[e.buffer])},function(t){return e.push(t.data[0],t.data[1])}},Ds=function(e,t,r,a,n){var s,i=xs(e,a,n,(function(e,r){e?(i.terminate(),t.ondata.call(t,e)):(r[1]&&i.terminate(),t.ondata.call(t,e,r[0],r[1]))}));i.postMessage(r),t.push=function(e,r){if(s)throw"stream finished";if(!t.ondata)throw"no stream handler";i.postMessage([e,s=r],[e.buffer])},t.terminate=function(){i.terminate()}},Os=function(e,t){return e[t]|e[t+1]<<8},Us=function(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+2*(e[t+3]<<23)},Gs=function(e,t){return Us(e,t)|4294967296*Us(e,t)},Ns=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},Ps=function(e,t){var r=t.filename;if(e[0]=31,e[1]=139,e[2]=8,e[8]=t.level<2?4:9==t.level?2:0,e[9]=3,0!=t.mtime&&Ns(e,4,Math.floor(new Date(t.mtime||Date.now())/1e3)),r){e[3]=8;for(var a=0;a<=r.length;++a)e[a+10]=r.charCodeAt(a)}},Hs=function(e){if(31!=e[0]||139!=e[1]||8!=e[2])throw"invalid gzip data";var t=e[3],r=10;4&t&&(r+=e[10]|2+(e[11]<<8));for(var a=(t>>3&1)+(t>>4&1);a>0;a-=!e[r++]);return r+(2&t)},Js=function(e){var t=e.length;return(e[t-4]|e[t-3]<<8|e[t-2]<<16)+2*(e[t-1]<<23)},_s=function(e){return 10+(e.filename&&e.filename.length+1||0)},js=function(e,t){var r=t.level,a=0==r?0:r<6?1:9==r?3:2;e[0]=120,e[1]=a<<6|(a?32-2*a:1)},Vs=function(e){if(8!=(15&e[0])||e[0]>>>4>7||(e[0]<<8|e[1])%31)throw"invalid zlib data";if(32&e[1])throw"invalid zlib data: preset dictionaries not supported"};function Xs(e,t){return!t&&"function"==typeof e&&(t=e,e={}),this.ondata=t,e}var Ks=function(){function e(e,t){!t&&"function"==typeof e&&(t=e,e={}),this.ondata=t,this.o=e||{}}return e.prototype.p=function(e,t){this.ondata(As(e,this.o,0,0,!t),t)},e.prototype.push=function(e,t){if(this.d)throw"stream finished";if(!this.ondata)throw"no stream handler";this.d=t,this.p(e,t||!1)},e}(),zs=function(e,t){Ds([ws,function(){return[Ls,Ks]}],this,Xs.call(this,e,t),(function(e){var t=new Ks(e.data);onmessage=Ls(t)}),6)};function Ws(e,t,r){if(r||(r=t,t={}),"function"!=typeof r)throw"no callback";return Rs(e,t,[ws],(function(e){return Ts(Ys(e.data[0],e.data[1]))}),0,r)}function Ys(e,t){return As(e,t||{},0,0)}var Qs=function(){function e(e){this.s={},this.p=new Tn(0),this.ondata=e}return e.prototype.e=function(e){if(this.d)throw"stream finished";if(!this.ondata)throw"no stream handler";var t=this.p.length,r=new Tn(t+e.length);r.set(this.p),r.set(e,t),this.p=r},e.prototype.c=function(e){this.d=this.s.i=e||!1;var t=this.s.b,r=ns(this.p,this.o,this.s);this.ondata(as(r,t,this.s.b),this.d),this.o=as(r,this.s.b-32768),this.s.b=this.o.length,this.p=as(this.p,this.s.p/8|0),this.s.p&=7},e.prototype.push=function(e,t){this.e(e),this.c(t)},e}(),qs=function(e){this.ondata=e,Ds([Fs,function(){return[Ls,Qs]}],this,0,(function(){var e=new Qs;onmessage=Ls(e)}),7)};function Zs(e,t,r){if(r||(r=t,t={}),"function"!=typeof r)throw"no callback";return Rs(e,t,[Fs],(function(e){return Ts($s(e.data[0],ks(e.data[1])))}),1,r)}function $s(e,t){return ns(e,t)}var ei=function(){function e(e,t){this.c=vs(),this.l=0,this.v=1,Ks.call(this,e,t)}return e.prototype.push=function(e,t){Ks.prototype.push.call(this,e,t)},e.prototype.p=function(e,t){this.c.p(e),this.l+=e.length;var r=As(e,this.o,this.v&&_s(this.o),t&&8,!t);this.v&&(Ps(r,this.o),this.v=0),t&&(Ns(r,r.length-8,this.c.d()),Ns(r,r.length-4,this.l)),this.ondata(r,t)},e}(),ti=function(e,t){Ds([ws,Es,function(){return[Ls,Ks,ei]}],this,Xs.call(this,e,t),(function(e){var t=new ei(e.data);onmessage=Ls(t)}),8)};function ri(e,t,r){if(r||(r=t,t={}),"function"!=typeof r)throw"no callback";return Rs(e,t,[ws,Es,function(){return[ai]}],(function(e){return Ts(ai(e.data[0],e.data[1]))}),2,r)}function ai(e,t){t||(t={});var r=vs(),a=e.length;r.p(e);var n=As(e,t,_s(t),8),s=n.length;return Ps(n,t),Ns(n,s-8,r.d()),Ns(n,s-4,a),n}var ni=function(){function e(e){this.v=1,Qs.call(this,e)}return e.prototype.push=function(e,t){if(Qs.prototype.e.call(this,e),this.v){var r=this.p.length>3?Hs(this.p):4;if(r>=this.p.length&&!t)return;this.p=this.p.subarray(r),this.v=0}if(t){if(this.p.length<8)throw"invalid gzip stream";this.p=this.p.subarray(0,-8)}Qs.prototype.c.call(this,t)},e}(),si=function(e){this.ondata=e,Ds([Fs,Ss,function(){return[Ls,Qs,ni]}],this,0,(function(){var e=new ni;onmessage=Ls(e)}),9)};function ii(e,t,r){if(r||(r=t,t={}),"function"!=typeof r)throw"no callback";return Rs(e,t,[Fs,Ss,function(){return[oi]}],(function(e){return Ts(oi(e.data[0]))}),3,r)}function oi(e,t){return ns(e.subarray(Hs(e),-8),t||new Tn(Js(e)))}var ci=function(){function e(e,t){this.c=ys(),this.v=1,Ks.call(this,e,t)}return e.prototype.push=function(e,t){Ks.prototype.push.call(this,e,t)},e.prototype.p=function(e,t){this.c.p(e);var r=As(e,this.o,this.v&&2,t&&4,!t);this.v&&(js(r,this.o),this.v=0),t&&Ns(r,r.length-4,this.c.d()),this.ondata(r,t)},e}(),li=function(e,t){Ds([ws,Is,function(){return[Ls,Ks,ci]}],this,Xs.call(this,e,t),(function(e){var t=new ci(e.data);onmessage=Ls(t)}),10)};function ui(e,t){t||(t={});var r=ys();r.p(e);var a=As(e,t,2,4);return js(a,t),Ns(a,a.length-4,r.d()),a}var hi=function(){function e(e){this.v=1,Qs.call(this,e)}return e.prototype.push=function(e,t){if(Qs.prototype.e.call(this,e),this.v){if(this.p.length<2&&!t)return;this.p=this.p.subarray(2),this.v=0}if(t){if(this.p.length<4)throw"invalid zlib stream";this.p=this.p.subarray(0,-4)}Qs.prototype.c.call(this,t)},e}(),pi=function(e){this.ondata=e,Ds([Fs,Ms,function(){return[Ls,Qs,hi]}],this,0,(function(){var e=new hi;onmessage=Ls(e)}),11)};function fi(e,t,r){if(r||(r=t,t={}),"function"!=typeof r)throw"no callback";return Rs(e,t,[Fs,Ms,function(){return[di]}],(function(e){return Ts(di(e.data[0],ks(e.data[1])))}),5,r)}function di(e,t){return ns((Vs(e),e.subarray(2,-4)),t)}var gi=function(){function e(e){this.G=ni,this.I=Qs,this.Z=hi,this.ondata=e}return e.prototype.push=function(e,t){if(!this.ondata)throw"no stream handler";if(this.s)this.s.push(e,t);else{if(this.p&&this.p.length){var r=new Tn(this.p.length+e.length);r.set(this.p),r.set(e,this.p.length)}else this.p=e;if(this.p.length>2){var a=this,n=function(){a.ondata.apply(a,arguments)};this.s=31==this.p[0]&&139==this.p[1]&&8==this.p[2]?new this.G(n):8!=(15&this.p[0])||this.p[0]>>4>7||(this.p[0]<<8|this.p[1])%31?new this.I(n):new this.Z(n),this.s.push(this.p,t),this.p=null}}},e}(),mi=function(){function e(e){this.G=si,this.I=qs,this.Z=pi,this.ondata=e}return e.prototype.push=function(e,t){gi.prototype.push.call(this,e,t)},e}();var vi=function(e,t,r,a){for(var n in e){var s=e[n],i=t+n;s instanceof Tn?r[i]=[s,a]:Array.isArray(s)?r[i]=[s[0],bs(a,s[1])]:vi(s,i+"/",r,a)}},yi="undefined"!=typeof TextEncoder&&new TextEncoder,Ai=void 0!==e.$TextDecoder&&new e.$TextDecoder,bi=0;try{Ai.decode(ds,{stream:!0}),bi=1}catch(e){}var Bi=function(e){for(var t="",r=0;;){var a=e[r++],n=(a>127)+(a>223)+(a>239);if(r+n>e.length)return[t,as(e,r-1)];n?3==n?(a=((15&a)<<18|(63&e[r++])<<12|(63&e[r++])<<6|63&e[r++])-65536,t+=String.fromCharCode(55296|a>>10,56320|1023&a)):t+=1&n?String.fromCharCode((31&a)<<6|63&e[r++]):String.fromCharCode((15&a)<<12|(63&e[r++])<<6|63&e[r++]):t+=String.fromCharCode(a)}},Ci=function(){function t(t){this.ondata=t,bi?this.t=new e.$TextDecoder:this.p=ds}return t.prototype.push=function(e,t){if(!this.ondata)throw"no callback";if(t||(t=!1),this.t)return this.ondata(this.t.decode(e,{stream:!t}),t);var r=new Tn(this.p.length+e.length);r.set(this.p),r.set(e,this.p.length);var a=Bi(r),n=a[0],s=a[1];if(t&&s.length)throw"invalid utf-8 data";this.p=s,this.ondata(n,t)},t}(),xi=function(){function e(e){this.ondata=e}return e.prototype.push=function(e,t){if(!this.ondata)throw"no callback";this.ondata(Fi(e),t||!1)},e}();function Fi(e,t){if(t){for(var r=new Tn(e.length),a=0;a<e.length;++a)r[a]=e.charCodeAt(a);return r}if(yi)return yi.encode(e);var n=e.length,s=new Tn(e.length+(e.length>>1)),i=0,o=function(e){s[i++]=e};for(a=0;a<n;++a){if(i+5>s.length){var c=new Tn(i+8+(n-a<<1));c.set(s),s=c}var l=e.charCodeAt(a);l<128||t?o(l):l<2048?(o(192|l>>>6),o(128|63&l)):l>55295&&l<57344?(o(240|(l=65536+(1047552&l)|1023&e.charCodeAt(++a))>>>18),o(128|l>>>12&63),o(128|l>>>6&63),o(128|63&l)):(o(224|l>>>12),o(128|l>>>6&63),o(128|63&l))}return as(s,0,i)}function wi(e,t){if(t){for(var r="",a=0;a<e.length;a+=16384)r+=String.fromCharCode.apply(null,e.subarray(a,a+16384));return r}if(Ai)return Ai.decode(e);var n=Bi(e),s=n[0];if(n[1].length)throw"invalid utf-8 data";return s}var Ei=function(e){return 1==e?3:e<6?2:9==e?1:0},Si=function(e,t){return t+30+Os(e,t+26)+Os(e,t+28)},Ii=function(e,t,r){var a=Os(e,t+28),n=wi(e.subarray(t+46,t+46+a),!(2048&Os(e,t+8))),s=t+46+a,i=Us(e,t+20),o=r&&4294967295==i?Mi(e,s):[i,Us(e,t+24),Us(e,t+42)],c=o[0],l=o[1],u=o[2];return[Os(e,t+10),c,l,n,s+Os(e,t+30)+Os(e,t+32),u]},Mi=function(e,t){for(;1!=Os(e,t);t+=4+Os(e,t+2));return[Gs(e,t+12),Gs(e,t+4),Gs(e,t+20)]},Ti=function(e){var t=0;if(e)for(var r in e){var a=e[r].length;if(a>65535)throw"extra field too long";t+=a+4}return t},ki=function(e,t,r,a,n,s,i,o){var c=a.length,l=r.extra,u=o&&o.length,h=Ti(l);Ns(e,t,null!=i?33639248:67324752),t+=4,null!=i&&(e[t++]=20,e[t++]=r.os),e[t]=20,t+=2,e[t++]=r.flag<<1|(null==s&&8),e[t++]=n&&8,e[t++]=255&r.compression,e[t++]=r.compression>>8;var p=new Date(null==r.mtime?Date.now():r.mtime),f=p.getFullYear()-1980;if(f<0||f>119)throw"date not in range 1980-2099";if(Ns(e,t,2*(f<<24)|p.getMonth()+1<<21|p.getDate()<<16|p.getHours()<<11|p.getMinutes()<<5|p.getSeconds()>>>1),t+=4,null!=s&&(Ns(e,t,r.crc),Ns(e,t+4,s),Ns(e,t+8,r.size)),Ns(e,t+12,c),Ns(e,t+14,h),t+=16,null!=i&&(Ns(e,t,u),Ns(e,t+6,r.attrs),Ns(e,t+10,i),t+=14),e.set(a,t),t+=c,h)for(var d in l){var g=l[d],m=g.length;Ns(e,t,+d),Ns(e,t+2,m),e.set(g,t+4),t+=4+m}return u&&(e.set(o,t),t+=u),t},Ri=function(e,t,r,a,n){Ns(e,t,101010256),Ns(e,t+8,r),Ns(e,t+10,r),Ns(e,t+12,a),Ns(e,t+16,n)},Li=function(){function e(e){this.filename=e,this.c=vs(),this.size=0,this.compression=0}return e.prototype.process=function(e,t){this.ondata(null,e,t)},e.prototype.push=function(e,t){if(!this.ondata)throw"no callback - add to ZIP archive before pushing";this.c.p(e),this.size+=e.length,t&&(this.crc=this.c.d()),this.process(e,t||!1)},e}(),Di=function(){function e(e,t){var r=this;t||(t={}),Li.call(this,e),this.d=new Ks(t,(function(e,t){r.ondata(null,e,t)})),this.compression=8,this.flag=Ei(t.level)}return e.prototype.process=function(e,t){try{this.d.push(e,t)}catch(e){this.ondata(e,null,t)}},e.prototype.push=function(e,t){Li.prototype.push.call(this,e,t)},e}(),Oi=function(){function e(e,t){var r=this;t||(t={}),Li.call(this,e),this.d=new zs(t,(function(e,t,a){r.ondata(e,t,a)})),this.compression=8,this.flag=Ei(t.level),this.terminate=this.d.terminate}return e.prototype.process=function(e,t){this.d.push(e,t)},e.prototype.push=function(e,t){Li.prototype.push.call(this,e,t)},e}(),Ui=function(){function e(e){this.ondata=e,this.u=[],this.d=1}return e.prototype.add=function(e){var t=this;if(2&this.d)throw"stream finished";var r=Fi(e.filename),a=r.length,n=e.comment,s=n&&Fi(n),i=a!=e.filename.length||s&&n.length!=s.length,o=a+Ti(e.extra)+30;if(a>65535)throw"filename too long";var c=new Tn(o);ki(c,0,e,r,i);var l=[c],u=function(){for(var e=0,r=l;e<r.length;e++){var a=r[e];t.ondata(null,a,!1)}l=[]},h=this.d;this.d=0;var p=this.u.length,f=bs(e,{f:r,u:i,o:s,t:function(){e.terminate&&e.terminate()},r:function(){if(u(),h){var e=t.u[p+1];e?e.r():t.d=1}h=1}}),d=0;e.ondata=function(r,a,n){if(r)t.ondata(r,a,n),t.terminate();else if(d+=a.length,l.push(a),n){var s=new Tn(16);Ns(s,0,134695760),Ns(s,4,e.crc),Ns(s,8,d),Ns(s,12,e.size),l.push(s),f.c=d,f.b=o+d+16,f.crc=e.crc,f.size=e.size,h&&f.r(),h=1}else h&&u()},this.u.push(f)},e.prototype.end=function(){var e=this;if(2&this.d)throw 1&this.d?"stream finishing":"stream finished";this.d?this.e():this.u.push({r:function(){1&e.d&&(e.u.splice(-1,1),e.e())},t:function(){}}),this.d=3},e.prototype.e=function(){for(var e=0,t=0,r=0,a=0,n=this.u;a<n.length;a++){r+=46+(c=n[a]).f.length+Ti(c.extra)+(c.o?c.o.length:0)}for(var s=new Tn(r+22),i=0,o=this.u;i<o.length;i++){var c=o[i];ki(s,e,c,c.f,c.u,c.c,t,c.o),e+=46+c.f.length+Ti(c.extra)+(c.o?c.o.length:0),t+=c.b}Ri(s,e,this.u.length,r,t),this.ondata(null,s,!0),this.d=2},e.prototype.terminate=function(){for(var e=0,t=this.u;e<t.length;e++){t[e].t()}this.d=2},e}();var Gi=function(){function e(){}return e.prototype.push=function(e,t){this.ondata(null,e,t)},e.compression=0,e}(),Ni=function(){function e(){var e=this;this.i=new Qs((function(t,r){e.ondata(null,t,r)}))}return e.prototype.push=function(e,t){try{this.i.push(e,t)}catch(r){this.ondata(r,e,t)}},e.compression=8,e}(),Pi=function(){function e(e,t){var r=this;t<32e4?this.i=new Qs((function(e,t){r.ondata(null,e,t)})):(this.i=new qs((function(e,t,a){r.ondata(e,t,a)})),this.terminate=this.i.terminate)}return e.prototype.push=function(e,t){this.i.terminate&&(e=as(e,0)),this.i.push(e,t)},e.compression=8,e}(),Hi=function(){function e(e){this.onfile=e,this.k=[],this.o={0:Gi},this.p=ds}return e.prototype.push=function(e,t){var r=this;if(!this.onfile)throw"no callback";if(this.c>0){var a=Math.min(this.c,e.length),n=e.subarray(0,a);if(this.c-=a,this.d?this.d.push(n,!this.c):this.k[0].push(n),(e=e.subarray(a)).length)return this.push(e,t)}else{var s=0,i=0,o=void 0,c=void 0;this.p.length?e.length?((c=new Tn(this.p.length+e.length)).set(this.p),c.set(e,this.p.length)):c=this.p:c=e;for(var l=c.length,u=this.c,h=u&&this.d,p=function(){var e,t=Us(c,i);if(67324752==t){s=1,o=i,f.d=null,f.c=0;var a=Os(c,i+6),n=Os(c,i+8),h=2048&a,p=8&a,d=Os(c,i+26),g=Os(c,i+28);if(l>i+30+d+g){var m=[];f.k.unshift(m),s=2;var v=Us(c,i+18),y=Us(c,i+22),A=wi(c.subarray(i+30,i+=30+d),!h);4294967295==v?(e=p?[-2]:Mi(c,i),v=e[0],y=e[1]):p&&(v=-1),i+=g,f.c=v;var b={name:A,compression:n,start:function(){if(!b.ondata)throw"no callback";if(v){var e=r.o[n];if(!e)throw"unknown compression type "+n;var t=v<0?new e(A):new e(A,v,y);t.ondata=function(e,t,r){b.ondata(e,t,r)};for(var a=0,s=m;a<s.length;a++){var i=s[a];t.push(i,!1)}r.k[0]==m?r.d=t:t.push(ds,!0)}else b.ondata(null,ds,!0)},terminate:function(){r.k[0]==m&&r.d.terminate&&r.d.terminate()}};v>=0&&(b.size=v,b.originalSize=y),f.onfile(b)}return"break"}if(u){if(134695760==t)return o=i+=12+(-2==u&&8),s=2,f.c=0,"break";if(33639248==t)return o=i-=4,s=2,f.c=0,"break"}},f=this;i<l-4;++i){if("break"===p())break}if(this.p=ds,u<0){var d=s?c.subarray(0,o-12-(-2==u&&8)-(134695760==Us(c,o-16)&&4)):c.subarray(0,i);h?h.push(d,!!s):this.k[+(2==s)].push(d)}if(2&s)return this.push(c.subarray(i),t);this.p=c.subarray(i)}if(t&&this.c)throw"invalid zip file"},e.prototype.register=function(e){this.o[e.compression]=e},e}();var Ji=Object.freeze({__proto__:null,default:null,AsyncCompress:ti,AsyncDecompress:mi,AsyncDeflate:zs,AsyncGunzip:si,AsyncGzip:ti,AsyncInflate:qs,AsyncUnzipInflate:Pi,AsyncUnzlib:pi,AsyncZipDeflate:Oi,AsyncZlib:li,Compress:ei,DecodeUTF8:Ci,Decompress:gi,Deflate:Ks,EncodeUTF8:xi,Gunzip:ni,Gzip:ei,Inflate:Qs,Unzip:Hi,UnzipInflate:Ni,UnzipPassThrough:Gi,Unzlib:hi,Zip:Ui,ZipDeflate:Di,ZipPassThrough:Li,Zlib:ci,compress:ri,compressSync:ai,decompress:function(e,t,r){if(r||(r=t,t={}),"function"!=typeof r)throw"no callback";return 31==e[0]&&139==e[1]&&8==e[2]?ii(e,t,r):8!=(15&e[0])||e[0]>>4>7||(e[0]<<8|e[1])%31?Zs(e,t,r):fi(e,t,r)},decompressSync:function(e,t){return 31==e[0]&&139==e[1]&&8==e[2]?oi(e,t):8!=(15&e[0])||e[0]>>4>7||(e[0]<<8|e[1])%31?$s(e,t):di(e,t)},deflate:Ws,deflateSync:Ys,gunzip:ii,gunzipSync:oi,gzip:ri,gzipSync:ai,inflate:Zs,inflateSync:$s,strFromU8:wi,strToU8:Fi,unzip:function(e,t){if("function"!=typeof t)throw"no callback";for(var r=[],a=function(){for(var e=0;e<r.length;++e)r[e]()},n={},s=e.length-22;101010256!=Us(e,s);--s)if(!s||e.length-s>65558)return void t("invalid zip file",null);var i=Os(e,s+8);i||t(null,{});var o=i,c=Us(e,s+16),l=4294967295==c;if(l){if(s=Us(e,s-12),101075792!=Us(e,s))return void t("invalid zip file",null);o=i=Us(e,s+32),c=Us(e,s+48)}for(var u=function(s){var o=Ii(e,c,l),u=o[0],h=o[1],p=o[2],f=o[3],d=o[4],g=o[5],m=Si(e,g);c=d;var v=function(e,r){e?(a(),t(e,null)):(n[f]=r,--i||t(null,n))};if(u)if(8==u){var y=e.subarray(m,m+h);if(h<32e4)try{v(null,$s(y,new Tn(p)))}catch(e){v(e,null)}else r.push(Zs(y,{size:p},v))}else v("unknown compression type "+u,null);else v(null,as(e,m,m+h))},h=0;h<o;++h)u();return a},unzipSync:function(e){for(var t={},r=e.length-22;101010256!=Us(e,r);--r)if(!r||e.length-r>65558)throw"invalid zip file";var a=Os(e,r+8);if(!a)return{};var n=Us(e,r+16),s=4294967295==n;if(s){if(r=Us(e,r-12),101075792!=Us(e,r))throw"invalid zip file";a=Us(e,r+32),n=Us(e,r+48)}for(var i=0;i<a;++i){var o=Ii(e,n,s),c=o[0],l=o[1],u=o[2],h=o[3],p=o[4],f=o[5],d=Si(e,f);if(n=p,c){if(8!=c)throw"unknown compression type "+c;t[h]=$s(e.subarray(d,d+l),new Tn(u))}else t[h]=as(e,d,d+l)}return t},unzlib:fi,unzlibSync:di,zip:function(e,t,r){if(r||(r=t,t={}),"function"!=typeof r)throw"no callback";var a={};vi(e,"",a,t);var n=Object.keys(a),s=n.length,i=0,o=0,c=s,l=new Array(s),u=[],h=function(){for(var e=0;e<u.length;++e)u[e]()},p=function(){var e=new Tn(o+22),t=i,a=o-i;o=0;for(var n=0;n<c;++n){var s=l[n];try{var u=s.c.length;ki(e,o,s,s.f,s.u,u);var h=30+s.f.length+Ti(s.extra),p=o+h;e.set(s.c,p),ki(e,i,s,s.f,s.u,u,o,s.m),i+=16+h+(s.m?s.m.length:0),o=p+u}catch(e){return r(e,null)}}Ri(e,i,l.length,a,t),r(null,e)};s||p();for(var f=function(e){var t=n[e],c=a[t],f=c[0],d=c[1],g=vs(),m=f.length;g.p(f);var v=Fi(t),y=v.length,A=d.comment,b=A&&Fi(A),B=b&&b.length,C=Ti(d.extra),x=0==d.level?0:8,F=function(a,n){if(a)h(),r(a,null);else{var c=n.length;l[e]=bs(d,{size:m,crc:g.d(),c:n,f:v,m:b,u:y!=t.length||b&&A.length!=B,compression:x}),i+=30+y+C+c,o+=76+2*(y+C)+(B||0)+c,--s||p()}};if(y>65535&&F("filename too long",null),x)if(m<16e4)try{F(null,Ys(f,d))}catch(e){F(e,null)}else u.push(Ws(f,d,F));else F(null,f)},d=0;d<c;++d)f(d);return h},zipSync:function(e,t){t||(t={});var r={},a=[];vi(e,"",r,t);var n=0,s=0;for(var i in r){var o=r[i],c=o[0],l=o[1],u=0==l.level?0:8,h=(x=Fi(i)).length,p=l.comment,f=p&&Fi(p),d=f&&f.length,g=Ti(l.extra);if(h>65535)throw"filename too long";var m=u?Ys(c,l):c,v=m.length,y=vs();y.p(c),a.push(bs(l,{size:c.length,crc:y.d(),c:m,f:x,m:f,u:h!=i.length||f&&p.length!=d,o:n,compression:u})),n+=30+h+g+v,s+=76+2*(h+g)+(d||0)+v}for(var A=new Tn(s+22),b=n,B=s-n,C=0;C<a.length;++C){var x=a[C];ki(A,x.o,x,x.f,x.u,x.c.length);var F=30+x.f.length+Ti(x.extra);A.set(x.c,x.o+F),ki(A,n,x,x.f,x.u,x.c.length,x.o,x.m),n+=16+F+(x.m?x.m.length:0)}return Ri(A,n,a.length,B,b),A},zlib:function(e,t,r){if(r||(r=t,t={}),"function"!=typeof r)throw"no callback";return Rs(e,t,[ws,Is,function(){return[ui]}],(function(e){return Ts(ui(e.data[0],e.data[1]))}),4,r)},zlibSync:ui}),_i={findSpan:function(e,t,r){var a=r.length-e-1;if(t>=r[a])return a-1;if(t<=r[e])return e;for(var n=e,s=a,i=Math.floor((n+s)/2);t<r[i]||t>=r[i+1];)t<r[i]?s=i:n=i,i=Math.floor((n+s)/2);return i},calcBasisFunctions:function(e,t,r,a){var n=[],s=[],i=[];n[0]=1;for(var o=1;o<=r;++o){s[o]=t-a[e+1-o],i[o]=a[e+o]-t;for(var c=0,l=0;l<o;++l){var u=i[l+1],h=s[o-l],p=n[l]/(u+h);n[l]=c+u*p,c=h*p}n[o]=c}return n},calcBSplinePoint:function(t,r,a,n){for(var s=this.findSpan(t,n,r),i=this.calcBasisFunctions(s,n,t,r),o=new e.Vector4(0,0,0,0),c=0;c<=t;++c){var l=a[s-t+c],u=i[c],h=l.w*u;o.x+=l.x*h,o.y+=l.y*h,o.z+=l.z*h,o.w+=l.w*u}return o},calcBasisFunctionDerivatives:function(e,t,r,a,n){for(var s=[],i=0;i<=r;++i)s[i]=0;var o=[];for(i=0;i<=a;++i)o[i]=s.slice(0);var c=[];for(i=0;i<=r;++i)c[i]=s.slice(0);c[0][0]=1;for(var l=s.slice(0),u=s.slice(0),h=1;h<=r;++h){l[h]=t-n[e+1-h],u[h]=n[e+h]-t;for(var p=0,f=0;f<h;++f){var d=u[f+1],g=l[h-f];c[h][f]=d+g;var m=c[f][h-1]/c[h][f];c[f][h]=p+d*m,p=g*m}c[h][h]=p}for(h=0;h<=r;++h)o[0][h]=c[h][r];for(f=0;f<=r;++f){var v=0,y=1,A=[];for(i=0;i<=r;++i)A[i]=s.slice(0);A[0][0]=1;for(var b=1;b<=a;++b){var B=0,C=f-b,x=r-b;f>=b&&(A[y][0]=A[v][0]/c[x+1][C],B=A[y][0]*c[C][x]);var F=f-1<=x?b-1:r-f;for(h=C>=-1?1:-C;h<=F;++h)A[y][h]=(A[v][h]-A[v][h-1])/c[x+1][C+h],B+=A[y][h]*c[C+h][x];f<=x&&(A[y][b]=-A[v][b-1]/c[x+1][f],B+=A[y][b]*c[f][x]),o[b][f]=B;h=v;v=y,y=h}}for(f=r,b=1;b<=a;++b){for(h=0;h<=r;++h)o[b][h]*=f;f*=r-b}return o},calcBSplineDerivatives:function(t,r,a,n,s){for(var i=s<t?s:t,o=[],c=this.findSpan(t,n,r),l=this.calcBasisFunctionDerivatives(c,n,t,i,r),u=[],h=0;h<a.length;++h){var p=(d=a[h].clone()).w;d.x*=p,d.y*=p,d.z*=p,u[h]=d}for(var f=0;f<=i;++f){for(var d=u[c-t].clone().multiplyScalar(l[f][0]),g=1;g<=t;++g)d.add(u[c-t+g].clone().multiplyScalar(l[f][g]));o[f]=d}for(f=i+1;f<=s+1;++f)o[f]=new e.Vector4(0,0,0);return o},calcKoverI:function(e,t){for(var r=1,a=2;a<=e;++a)r*=a;var n=1;for(a=2;a<=t;++a)n*=a;for(a=2;a<=e-t;++a)n*=a;return r/n},calcRationalCurveDerivatives:function(t){for(var r=t.length,a=[],n=[],s=0;s<r;++s){var i=t[s];a[s]=new e.Vector3(i.x,i.y,i.z),n[s]=i.w}for(var o=[],c=0;c<r;++c){var l=a[c].clone();for(s=1;s<=c;++s)l.sub(o[c-s].clone().multiplyScalar(this.calcKoverI(c,s)*n[s]));o[c]=l.divideScalar(n[0])}return o},calcNURBSDerivatives:function(e,t,r,a,n){var s=this.calcBSplineDerivatives(e,t,r,a,n);return this.calcRationalCurveDerivatives(s)},calcSurfacePoint:function(t,r,a,n,s,i,o,c){for(var l=this.findSpan(t,i,a),u=this.findSpan(r,o,n),h=this.calcBasisFunctions(l,i,t,a),p=this.calcBasisFunctions(u,o,r,n),f=[],d=0;d<=r;++d){f[d]=new e.Vector4(0,0,0,0);for(var g=0;g<=t;++g){var m=s[l-t+g][u-r+d].clone(),v=m.w;m.x*=v,m.y*=v,m.z*=v,f[d].add(m.multiplyScalar(h[g]))}}var y=new e.Vector4(0,0,0,0);for(d=0;d<=r;++d)y.add(f[d].multiplyScalar(p[d]));y.divideScalar(y.w),c.set(y.x,y.y,y.z)}},ji=function(t,r,a,n,s){e.Curve.call(this),this.degree=t,this.knots=r,this.controlPoints=[],this.startKnot=n||0,this.endKnot=s||this.knots.length-1;for(var i=0;i<a.length;++i){var o=a[i];this.controlPoints[i]=new e.Vector4(o.x,o.y,o.z,o.w)}};(ji.prototype=Object.create(e.Curve.prototype)).constructor=ji,ji.prototype.getPoint=function(t,r){var a=r||new e.Vector3,n=this.knots[this.startKnot]+t*(this.knots[this.endKnot]-this.knots[this.startKnot]),s=_i.calcBSplinePoint(this.degree,this.knots,this.controlPoints,n);return 1!=s.w&&s.divideScalar(s.w),a.set(s.x,s.y,s.z)},ji.prototype.getTangent=function(t,r){var a=r||new e.Vector3,n=this.knots[0]+t*(this.knots[this.knots.length-1]-this.knots[0]),s=_i.calcNURBSDerivatives(this.degree,this.knots,this.controlPoints,n,1);return a.copy(s[1]).normalize(),a};var Vi,Xi=function(){var t,r,a;function n(t){e.Loader.call(this,t)}function s(e,t){this.textureLoader=e,this.manager=t}function i(){}function o(){}function c(){}function l(){}function u(e,t){this.dv=new DataView(e),this.offset=0,this.littleEndian=void 0===t||t}function h(){}function p(e){var t=e.match(/FBXVersion: (\d+)/);if(t)return parseInt(t[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function f(e){return e/46186158e3}n.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:n,load:function(t,r,a,n){var s=this,i=""===s.path?e.LoaderUtils.extractUrlBase(t):s.path,o=new e.FileLoader(this.manager);o.setPath(s.path),o.setResponseType("arraybuffer"),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(t,(function(e){try{r(s.parse(e,i))}catch(e){n?n(e):console.error(e),s.manager.itemError(t)}}),a,n)},parse:function(r,a){if(o="Kaydara FBX Binary  \0",(i=r).byteLength>=o.length&&o===B(i,0,o.length))t=(new l).parse(r);else{var n=B(r);if(!function(e){var t=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"],r=0;function a(t){var a=e[t-1];return e=e.slice(r+t),r++,a}for(var n=0;n<t.length;++n){if(a(1)===t[n])return!1}return!0}(n))throw new Error("THREE.FBXLoader: Unknown format.");if(p(n)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+p(n));t=(new c).parse(n)}var i,o;return new s(new e.TextureLoader(this.manager).setPath(this.resourcePath||a).setCrossOrigin(this.crossOrigin),this.manager).parse(t)}}),s.prototype={constructor:s,parse:function(){r=this.parseConnections();var e=this.parseImages(),t=this.parseTextures(e),n=this.parseMaterials(t),s=this.parseDeformers(),o=(new i).parse(s);return this.parseScene(s,o,n),a},parseConnections:function(){var e=new Map;"Connections"in t&&t.Connections.connections.forEach((function(t){var r=t[0],a=t[1],n=t[2];e.has(r)||e.set(r,{parents:[],children:[]});var s={ID:a,relationship:n};e.get(r).parents.push(s),e.has(a)||e.set(a,{parents:[],children:[]});var i={ID:r,relationship:n};e.get(a).children.push(i)}));return e},parseImages:function(){var e={},r={};if("Video"in t.Objects){var a=t.Objects.Video;for(var n in a){var s=a[n];if(e[l=parseInt(n)]=s.RelativeFilename||s.Filename,"Content"in s){var i=s.Content instanceof ArrayBuffer&&s.Content.byteLength>0,o="string"==typeof s.Content&&""!==s.Content;if(i||o){var c=this.parseImage(a[n]);r[s.RelativeFilename||s.Filename]=c}}}}for(var l in e){var u=e[l];void 0!==r[u]?e[l]=r[u]:e[l]=e[l].split("\\").pop()}return e},parseImage:function(t){var r,a=t.Content,n=t.RelativeFilename||t.Filename,s=n.slice(n.lastIndexOf(".")+1).toLowerCase();switch(s){case"bmp":r="image/bmp";break;case"jpg":case"jpeg":r="image/jpeg";break;case"png":r="image/png";break;case"tif":r="image/tiff";break;case"tga":null===this.manager.getHandler(".tga")&&console.warn("FBXLoader: TGA loader not found, skipping ",n),r="image/tga";break;default:return void console.warn('FBXLoader: Image type "'+s+'" is not supported.')}if("string"==typeof a)return"data:"+r+";base64,"+a;var i=new Uint8Array(a);return e.$window.URL.createObjectURL(new e.$Blob([i],{type:r}))},parseTextures:function(e){var r=new Map;if("Texture"in t.Objects){var a=t.Objects.Texture;for(var n in a){var s=this.parseTexture(a[n],e);r.set(parseInt(n),s)}}return r},parseTexture:function(t,r){var a=this.loadTexture(t,r);a.ID=t.id,a.name=t.attrName;var n=t.WrapModeU,s=t.WrapModeV,i=void 0!==n?n.value:0,o=void 0!==s?s.value:0;if(a.wrapS=0===i?e.RepeatWrapping:e.ClampToEdgeWrapping,a.wrapT=0===o?e.RepeatWrapping:e.ClampToEdgeWrapping,"Scaling"in t){var c=t.Scaling.value;a.repeat.x=c[0],a.repeat.y=c[1]}return a},loadTexture:function(t,a){var n,s,i=this.textureLoader.path,o=r.get(t.id).children;void 0!==o&&o.length>0&&void 0!==a[o[0].ID]&&(0!==(n=a[o[0].ID]).indexOf("blob:")&&0!==n.indexOf("data:")||this.textureLoader.setPath(void 0));var c=t.FileName.slice(-3).toLowerCase();if("tga"===c){var l=this.manager.getHandler(".tga");null===l?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",t.RelativeFilename),s=new e.Texture):s=l.load(n)}else"psd"===c?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",t.RelativeFilename),s=new e.Texture):s=this.textureLoader.load(n);return this.textureLoader.setPath(i),s},parseMaterials:function(e){var r=new Map;if("Material"in t.Objects){var a=t.Objects.Material;for(var n in a){var s=this.parseMaterial(a[n],e);null!==s&&r.set(parseInt(n),s)}}return r},parseMaterial:function(t,a){var n=t.id,s=t.attrName,i=t.ShadingModel;if("object"==typeof i&&(i=i.value),!r.has(n))return null;var o,c=this.parseParameters(t,a,n);switch(i.toLowerCase()){case"phong":o=new e.MeshPhongMaterial;break;case"lambert":o=new e.MeshLambertMaterial;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',i),o=new e.MeshPhongMaterial}return o.setValues(c),o.name=s,o},parseParameters:function(t,a,n){var s={};t.BumpFactor&&(s.bumpScale=t.BumpFactor.value),t.Diffuse?s.color=(new e.Color).fromArray(t.Diffuse.value):!t.DiffuseColor||"Color"!==t.DiffuseColor.type&&"ColorRGB"!==t.DiffuseColor.type||(s.color=(new e.Color).fromArray(t.DiffuseColor.value)),t.DisplacementFactor&&(s.displacementScale=t.DisplacementFactor.value),t.Emissive?s.emissive=(new e.Color).fromArray(t.Emissive.value):!t.EmissiveColor||"Color"!==t.EmissiveColor.type&&"ColorRGB"!==t.EmissiveColor.type||(s.emissive=(new e.Color).fromArray(t.EmissiveColor.value)),t.EmissiveFactor&&(s.emissiveIntensity=parseFloat(t.EmissiveFactor.value)),t.Opacity&&(s.opacity=parseFloat(t.Opacity.value)),s.opacity<1&&(s.transparent=!0),t.ReflectionFactor&&(s.reflectivity=t.ReflectionFactor.value),t.Shininess&&(s.shininess=t.Shininess.value),t.Specular?s.specular=(new e.Color).fromArray(t.Specular.value):t.SpecularColor&&"Color"===t.SpecularColor.type&&(s.specular=(new e.Color).fromArray(t.SpecularColor.value));var i=this;return r.get(n).children.forEach((function(t){var r=t.relationship;switch(r){case"Bump":s.bumpMap=i.getTexture(a,t.ID);break;case"Maya|TEX_ao_map":s.aoMap=i.getTexture(a,t.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":s.map=i.getTexture(a,t.ID),s.map.encoding=e.sRGBEncoding;break;case"DisplacementColor":s.displacementMap=i.getTexture(a,t.ID);break;case"EmissiveColor":s.emissiveMap=i.getTexture(a,t.ID),s.emissiveMap.encoding=e.sRGBEncoding;break;case"NormalMap":case"Maya|TEX_normal_map":s.normalMap=i.getTexture(a,t.ID);break;case"ReflectionColor":s.envMap=i.getTexture(a,t.ID),s.envMap.mapping=e.EquirectangularReflectionMapping,s.envMap.encoding=e.sRGBEncoding;break;case"SpecularColor":s.specularMap=i.getTexture(a,t.ID),s.specularMap.encoding=e.sRGBEncoding;break;case"TransparentColor":case"TransparencyFactor":s.alphaMap=i.getTexture(a,t.ID),s.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",r)}})),s},getTexture:function(e,a){return"LayeredTexture"in t.Objects&&a in t.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),a=r.get(a).children[0].ID),e.get(a)},parseDeformers:function(){var e={},a={};if("Deformer"in t.Objects){var n=t.Objects.Deformer;for(var s in n){var i=n[s],o=r.get(parseInt(s));if("Skin"===i.attrType){var c=this.parseSkeleton(o,n);c.ID=s,o.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),c.geometryID=o.parents[0].ID,e[s]=c}else if("BlendShape"===i.attrType){var l={id:s};l.rawTargets=this.parseMorphTargets(o,n),l.id=s,o.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),a[s]=l}}}return{skeletons:e,morphTargets:a}},parseSkeleton:function(t,r){var a=[];return t.children.forEach((function(t){var n=r[t.ID];if("Cluster"===n.attrType){var s={ID:t.ID,indices:[],weights:[],transformLink:(new e.Matrix4).fromArray(n.TransformLink.a)};"Indexes"in n&&(s.indices=n.Indexes.a,s.weights=n.Weights.a),a.push(s)}})),{rawBones:a,bones:[]}},parseMorphTargets:function(e,t){for(var a=[],n=0;n<e.children.length;n++){var s=e.children[n],i=t[s.ID],o={name:i.attrName,initialWeight:i.DeformPercent,id:i.id,fullWeights:i.FullWeights.a};if("BlendShapeChannel"!==i.attrType)return;o.geoID=r.get(parseInt(s.ID)).children.filter((function(e){return void 0===e.relationship}))[0].ID,a.push(o)}return a},parseScene:function(n,s,i){a=new e.Group;var c=this.parseModels(n.skeletons,s,i),l=t.Objects.Model,u=this;c.forEach((function(e){var t=l[e.ID];u.setLookAtProperties(e,t),r.get(e.ID).parents.forEach((function(t){var r=c.get(t.ID);void 0!==r&&r.add(e)})),null===e.parent&&a.add(e)})),this.bindSkeleton(n.skeletons,s,c),this.createAmbientLight(),this.setupMorphMaterials(),a.traverse((function(e){if(e.userData.transformData){e.parent&&(e.userData.transformData.parentMatrix=e.parent.matrix,e.userData.transformData.parentMatrixWorld=e.parent.matrixWorld);var t=y(e.userData.transformData);e.applyMatrix4(t),e.updateWorldMatrix()}}));var h=(new o).parse();1===a.children.length&&a.children[0].isGroup&&(a.children[0].animations=h,a=a.children[0]),a.animations=h},parseModels:function(a,n,s){var i=new Map,o=t.Objects.Model;for(var c in o){var l=parseInt(c),u=o[c],h=r.get(l),p=this.buildSkeleton(h,a,l,u.attrName);if(!p){switch(u.attrType){case"Camera":p=this.createCamera(h);break;case"Light":p=this.createLight(h);break;case"Mesh":p=this.createMesh(h,n,s);break;case"NurbsCurve":p=this.createCurve(h,n);break;case"LimbNode":case"Root":p=new e.Bone;break;case"Null":default:p=new e.Group}p.name=u.attrName?e.PropertyBinding.sanitizeNodeName(u.attrName):"",p.ID=l}this.getTransformData(p,u),i.set(l,p)}return i},buildSkeleton:function(t,r,a,n){var s=null;return t.parents.forEach((function(t){for(var i in r){var o=r[i];o.rawBones.forEach((function(r,i){if(r.ID===t.ID){var c=s;(s=new e.Bone).matrixWorld.copy(r.transformLink),s.name=n?e.PropertyBinding.sanitizeNodeName(n):"",s.ID=a,o.bones[i]=s,null!==c&&s.add(c)}}))}})),s},createCamera:function(r){var a,n;if(r.children.forEach((function(e){var r=t.Objects.NodeAttribute[e.ID];void 0!==r&&(n=r)})),void 0===n)a=new e.Object3D;else{var s=0;void 0!==n.CameraProjectionType&&1===n.CameraProjectionType.value&&(s=1);var i=1;void 0!==n.NearPlane&&(i=n.NearPlane.value/1e3);var o=1e3;void 0!==n.FarPlane&&(o=n.FarPlane.value/1e3);var c=e.$window.innerWidth,l=e.$window.innerHeight;void 0!==n.AspectWidth&&void 0!==n.AspectHeight&&(c=n.AspectWidth.value,l=n.AspectHeight.value);var u=c/l,h=45;void 0!==n.FieldOfView&&(h=n.FieldOfView.value);var p=n.FocalLength?n.FocalLength.value:null;switch(s){case 0:a=new e.PerspectiveCamera(h,u,i,o),null!==p&&a.setFocalLength(p);break;case 1:a=new e.OrthographicCamera(-c/2,c/2,l/2,-l/2,i,o);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+s+"."),a=new e.Object3D}}return a},createLight:function(r){var a,n;if(r.children.forEach((function(e){var r=t.Objects.NodeAttribute[e.ID];void 0!==r&&(n=r)})),void 0===n)a=new e.Object3D;else{var s;s=void 0===n.LightType?0:n.LightType.value;var i=16777215;void 0!==n.Color&&(i=(new e.Color).fromArray(n.Color.value));var o=void 0===n.Intensity?1:n.Intensity.value/100;void 0!==n.CastLightOnObject&&0===n.CastLightOnObject.value&&(o=0);var c=0;void 0!==n.FarAttenuationEnd&&(c=void 0!==n.EnableFarAttenuation&&0===n.EnableFarAttenuation.value?0:n.FarAttenuationEnd.value);switch(s){case 0:a=new e.PointLight(i,o,c,1);break;case 1:a=new e.DirectionalLight(i,o);break;case 2:var l=Math.PI/3;void 0!==n.InnerAngle&&(l=e.MathUtils.degToRad(n.InnerAngle.value));var u=0;void 0!==n.OuterAngle&&(u=e.MathUtils.degToRad(n.OuterAngle.value),u=Math.max(u,1)),a=new e.SpotLight(i,o,c,l,u,1);break;default:console.warn("THREE.FBXLoader: Unknown light type "+n.LightType.value+", defaulting to a PointLight."),a=new e.PointLight(i,o)}void 0!==n.CastShadows&&1===n.CastShadows.value&&(a.castShadow=!0)}return a},createMesh:function(t,r,a){var n,s=null,i=null,o=[];return t.children.forEach((function(e){r.has(e.ID)&&(s=r.get(e.ID)),a.has(e.ID)&&o.push(a.get(e.ID))})),o.length>1?i=o:o.length>0?i=o[0]:(i=new e.MeshPhongMaterial({color:13421772}),o.push(i)),"color"in s.attributes&&o.forEach((function(e){e.vertexColors=!0})),s.FBX_Deformer?(o.forEach((function(e){e.skinning=!0})),(n=new e.SkinnedMesh(s,i)).normalizeSkinWeights()):n=new e.Mesh(s,i),n},createCurve:function(t,r){var a=t.children.reduce((function(e,t){return r.has(t.ID)&&(e=r.get(t.ID)),e}),null),n=new e.LineBasicMaterial({color:3342591,linewidth:1});return new e.Line(a,n)},getTransformData:function(e,t){var r={};"InheritType"in t&&(r.inheritType=parseInt(t.InheritType.value)),r.eulerOrder="RotationOrder"in t?A(t.RotationOrder.value):"ZYX","Lcl_Translation"in t&&(r.translation=t.Lcl_Translation.value),"PreRotation"in t&&(r.preRotation=t.PreRotation.value),"Lcl_Rotation"in t&&(r.rotation=t.Lcl_Rotation.value),"PostRotation"in t&&(r.postRotation=t.PostRotation.value),"Lcl_Scaling"in t&&(r.scale=t.Lcl_Scaling.value),"ScalingOffset"in t&&(r.scalingOffset=t.ScalingOffset.value),"ScalingPivot"in t&&(r.scalingPivot=t.ScalingPivot.value),"RotationOffset"in t&&(r.rotationOffset=t.RotationOffset.value),"RotationPivot"in t&&(r.rotationPivot=t.RotationPivot.value),e.userData.transformData=r},setLookAtProperties:function(n,s){"LookAtProperty"in s&&r.get(n.ID).children.forEach((function(r){if("LookAtProperty"===r.relationship){var s=t.Objects.Model[r.ID];if("Lcl_Translation"in s){var i=s.Lcl_Translation.value;void 0!==n.target?(n.target.position.fromArray(i),a.add(n.target)):n.lookAt((new e.Vector3).fromArray(i))}}}))},bindSkeleton:function(t,a,n){var s=this.parsePoseNodes();for(var i in t){var o=t[i];r.get(parseInt(o.ID)).parents.forEach((function(t){if(a.has(t.ID)){var i=t.ID;r.get(i).parents.forEach((function(t){n.has(t.ID)&&n.get(t.ID).bind(new e.Skeleton(o.bones),s[t.ID])}))}}))}},parsePoseNodes:function(){var r={};if("Pose"in t.Objects){var a=t.Objects.Pose;for(var n in a)if("BindPose"===a[n].attrType){var s=a[n].PoseNode;Array.isArray(s)?s.forEach((function(t){r[t.Node]=(new e.Matrix4).fromArray(t.Matrix.a)})):r[s.Node]=(new e.Matrix4).fromArray(s.Matrix.a)}}return r},createAmbientLight:function(){if("GlobalSettings"in t&&"AmbientColor"in t.GlobalSettings){var r=t.GlobalSettings.AmbientColor.value,n=r[0],s=r[1],i=r[2];if(0!==n||0!==s||0!==i){var o=new e.Color(n,s,i);a.add(new e.AmbientLight(o,1))}}},setupMorphMaterials:function(){var e=this;a.traverse((function(t){t.isMesh&&t.geometry.morphAttributes.position&&t.geometry.morphAttributes.position.length&&(Array.isArray(t.material)?t.material.forEach((function(r,a){e.setupMorphMaterial(t,r,a)})):e.setupMorphMaterial(t,t.material))}))},setupMorphMaterial:function(e,t,r){var n=e.uuid,s=t.uuid,i=!1;if(a.traverse((function(e){e.isMesh&&(Array.isArray(e.material)?e.material.forEach((function(t){t.uuid===s&&e.uuid!==n&&(i=!0)})):e.material.uuid===s&&e.uuid!==n&&(i=!0))})),!0===i){var o=t.clone();o.morphTargets=!0,void 0===r?e.material=o:e.material[r]=o}else t.morphTargets=!0}},i.prototype={constructor:i,parse:function(e){var a=new Map;if("Geometry"in t.Objects){var n=t.Objects.Geometry;for(var s in n){var i=r.get(parseInt(s)),o=this.parseGeometry(i,n[s],e);a.set(parseInt(s),o)}}return a},parseGeometry:function(e,t,r){switch(t.attrType){case"Mesh":return this.parseMeshGeometry(e,t,r);case"NurbsCurve":return this.parseNurbsGeometry(t)}},parseMeshGeometry:function(e,r,a){var n=a.skeletons,s=[],i=e.parents.map((function(e){return t.Objects.Model[e.ID]}));if(0!==i.length){var o=e.children.reduce((function(e,t){return void 0!==n[t.ID]&&(e=n[t.ID]),e}),null);e.children.forEach((function(e){void 0!==a.morphTargets[e.ID]&&s.push(a.morphTargets[e.ID])}));var c=i[0],l={};"RotationOrder"in c&&(l.eulerOrder=A(c.RotationOrder.value)),"InheritType"in c&&(l.inheritType=parseInt(c.InheritType.value)),"GeometricTranslation"in c&&(l.translation=c.GeometricTranslation.value),"GeometricRotation"in c&&(l.rotation=c.GeometricRotation.value),"GeometricScaling"in c&&(l.scale=c.GeometricScaling.value);var u=y(l);return this.genGeometry(r,o,s,u)}},genGeometry:function(t,r,a,n){var s=new e.BufferGeometry;t.attrName&&(s.name=t.attrName);var i=this.parseGeoNode(t,r),o=this.genBuffers(i),c=new e.Float32BufferAttribute(o.vertex,3);if(c.applyMatrix4(n),s.setAttribute("position",c),o.colors.length>0&&s.setAttribute("color",new e.Float32BufferAttribute(o.colors,3)),r&&(s.setAttribute("skinIndex",new e.Uint16BufferAttribute(o.weightsIndices,4)),s.setAttribute("skinWeight",new e.Float32BufferAttribute(o.vertexWeights,4)),s.FBX_Deformer=r),o.normal.length>0){var l=(new e.Matrix3).getNormalMatrix(n),u=new e.Float32BufferAttribute(o.normal,3);u.applyNormalMatrix(l),s.setAttribute("normal",u)}if(o.uvs.forEach((function(t,r){var a="uv"+(r+1).toString();0===r&&(a="uv"),s.setAttribute(a,new e.Float32BufferAttribute(o.uvs[r],2))})),i.material&&"AllSame"!==i.material.mappingType){var h=o.materialIndex[0],p=0;if(o.materialIndex.forEach((function(e,t){e!==h&&(s.addGroup(p,t-p,h),h=e,p=t)})),s.groups.length>0){var f=s.groups[s.groups.length-1],d=f.start+f.count;d!==o.materialIndex.length&&s.addGroup(d,o.materialIndex.length-d,h)}0===s.groups.length&&s.addGroup(0,o.materialIndex.length,o.materialIndex[0])}return this.addMorphTargets(s,t,a,n),s},parseGeoNode:function(e,t){var r={};if(r.vertexPositions=void 0!==e.Vertices?e.Vertices.a:[],r.vertexIndices=void 0!==e.PolygonVertexIndex?e.PolygonVertexIndex.a:[],e.LayerElementColor&&(r.color=this.parseVertexColors(e.LayerElementColor[0])),e.LayerElementMaterial&&(r.material=this.parseMaterialIndices(e.LayerElementMaterial[0])),e.LayerElementNormal&&(r.normal=this.parseNormals(e.LayerElementNormal[0])),e.LayerElementUV){r.uv=[];for(var a=0;e.LayerElementUV[a];)e.LayerElementUV[a].UV&&r.uv.push(this.parseUVs(e.LayerElementUV[a])),a++}return r.weightTable={},null!==t&&(r.skeleton=t,t.rawBones.forEach((function(e,t){e.indices.forEach((function(a,n){void 0===r.weightTable[a]&&(r.weightTable[a]=[]),r.weightTable[a].push({id:t,weight:e.weights[n]})}))}))),r},genBuffers:function(e){var t={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]},r=0,a=0,n=!1,s=[],i=[],o=[],c=[],l=[],u=[],h=this;return e.vertexIndices.forEach((function(p,f){var d=!1;p<0&&(p^=-1,d=!0);var m=[],v=[];if(s.push(3*p,3*p+1,3*p+2),e.color){var y=g(f,r,p,e.color);o.push(y[0],y[1],y[2])}if(e.skeleton){if(void 0!==e.weightTable[p]&&e.weightTable[p].forEach((function(e){v.push(e.weight),m.push(e.id)})),v.length>4){n||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),n=!0);var A=[0,0,0,0],b=[0,0,0,0];v.forEach((function(e,t){var r=e,a=m[t];b.forEach((function(e,t,n){if(r>e){n[t]=r,r=e;var s=A[t];A[t]=a,a=s}}))})),m=A,v=b}for(;v.length<4;)v.push(0),m.push(0);for(var B=0;B<4;++B)l.push(v[B]),u.push(m[B])}if(e.normal){y=g(f,r,p,e.normal);i.push(y[0],y[1],y[2])}if(e.material&&"AllSame"!==e.material.mappingType)var C=g(f,r,p,e.material)[0];e.uv&&e.uv.forEach((function(e,t){var a=g(f,r,p,e);void 0===c[t]&&(c[t]=[]),c[t].push(a[0]),c[t].push(a[1])})),a++,d&&(h.genFace(t,e,s,C,i,o,c,l,u,a),r++,a=0,s=[],i=[],o=[],c=[],l=[],u=[])})),t},genFace:function(e,t,r,a,n,s,i,o,c,l){for(var u=2;u<l;u++)e.vertex.push(t.vertexPositions[r[0]]),e.vertex.push(t.vertexPositions[r[1]]),e.vertex.push(t.vertexPositions[r[2]]),e.vertex.push(t.vertexPositions[r[3*(u-1)]]),e.vertex.push(t.vertexPositions[r[3*(u-1)+1]]),e.vertex.push(t.vertexPositions[r[3*(u-1)+2]]),e.vertex.push(t.vertexPositions[r[3*u]]),e.vertex.push(t.vertexPositions[r[3*u+1]]),e.vertex.push(t.vertexPositions[r[3*u+2]]),t.skeleton&&(e.vertexWeights.push(o[0]),e.vertexWeights.push(o[1]),e.vertexWeights.push(o[2]),e.vertexWeights.push(o[3]),e.vertexWeights.push(o[4*(u-1)]),e.vertexWeights.push(o[4*(u-1)+1]),e.vertexWeights.push(o[4*(u-1)+2]),e.vertexWeights.push(o[4*(u-1)+3]),e.vertexWeights.push(o[4*u]),e.vertexWeights.push(o[4*u+1]),e.vertexWeights.push(o[4*u+2]),e.vertexWeights.push(o[4*u+3]),e.weightsIndices.push(c[0]),e.weightsIndices.push(c[1]),e.weightsIndices.push(c[2]),e.weightsIndices.push(c[3]),e.weightsIndices.push(c[4*(u-1)]),e.weightsIndices.push(c[4*(u-1)+1]),e.weightsIndices.push(c[4*(u-1)+2]),e.weightsIndices.push(c[4*(u-1)+3]),e.weightsIndices.push(c[4*u]),e.weightsIndices.push(c[4*u+1]),e.weightsIndices.push(c[4*u+2]),e.weightsIndices.push(c[4*u+3])),t.color&&(e.colors.push(s[0]),e.colors.push(s[1]),e.colors.push(s[2]),e.colors.push(s[3*(u-1)]),e.colors.push(s[3*(u-1)+1]),e.colors.push(s[3*(u-1)+2]),e.colors.push(s[3*u]),e.colors.push(s[3*u+1]),e.colors.push(s[3*u+2])),t.material&&"AllSame"!==t.material.mappingType&&(e.materialIndex.push(a),e.materialIndex.push(a),e.materialIndex.push(a)),t.normal&&(e.normal.push(n[0]),e.normal.push(n[1]),e.normal.push(n[2]),e.normal.push(n[3*(u-1)]),e.normal.push(n[3*(u-1)+1]),e.normal.push(n[3*(u-1)+2]),e.normal.push(n[3*u]),e.normal.push(n[3*u+1]),e.normal.push(n[3*u+2])),t.uv&&t.uv.forEach((function(t,r){void 0===e.uvs[r]&&(e.uvs[r]=[]),e.uvs[r].push(i[r][0]),e.uvs[r].push(i[r][1]),e.uvs[r].push(i[r][2*(u-1)]),e.uvs[r].push(i[r][2*(u-1)+1]),e.uvs[r].push(i[r][2*u]),e.uvs[r].push(i[r][2*u+1])}))},addMorphTargets:function(e,r,a,n){if(0!==a.length){e.morphTargetsRelative=!0,e.morphAttributes.position=[];var s=this;a.forEach((function(a){a.rawTargets.forEach((function(a){var i=t.Objects.Geometry[a.geoID];void 0!==i&&s.genMorphGeometry(e,r,i,n,a.name)}))}))}},genMorphGeometry:function(t,r,a,n,s){for(var i=void 0!==r.PolygonVertexIndex?r.PolygonVertexIndex.a:[],o=void 0!==a.Vertices?a.Vertices.a:[],c=void 0!==a.Indexes?a.Indexes.a:[],l=3*t.attributes.position.count,u=new Float32Array(l),h=0;h<c.length;h++){var p=3*c[h];u[p]=o[3*h],u[p+1]=o[3*h+1],u[p+2]=o[3*h+2]}var f={vertexIndices:i,vertexPositions:u},d=this.genBuffers(f),g=new e.Float32BufferAttribute(d.vertex,3);g.name=s||a.attrName,g.applyMatrix4(n),t.morphAttributes.position.push(g)},parseNormals:function(e){var t=e.MappingInformationType,r=e.ReferenceInformationType,a=e.Normals.a,n=[];return"IndexToDirect"===r&&("NormalIndex"in e?n=e.NormalIndex.a:"NormalsIndex"in e&&(n=e.NormalsIndex.a)),{dataSize:3,buffer:a,indices:n,mappingType:t,referenceType:r}},parseUVs:function(e){var t=e.MappingInformationType,r=e.ReferenceInformationType,a=e.UV.a,n=[];return"IndexToDirect"===r&&(n=e.UVIndex.a),{dataSize:2,buffer:a,indices:n,mappingType:t,referenceType:r}},parseVertexColors:function(e){var t=e.MappingInformationType,r=e.ReferenceInformationType,a=e.Colors.a,n=[];return"IndexToDirect"===r&&(n=e.ColorIndex.a),{dataSize:4,buffer:a,indices:n,mappingType:t,referenceType:r}},parseMaterialIndices:function(e){var t=e.MappingInformationType,r=e.ReferenceInformationType;if("NoMappingInformation"===t)return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:r};for(var a=e.Materials.a,n=[],s=0;s<a.length;++s)n.push(s);return{dataSize:1,buffer:a,indices:n,mappingType:t,referenceType:r}},parseNurbsGeometry:function(t){if(void 0===ji)return console.error("THREE.FBXLoader: The loader relies on NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new e.BufferGeometry;var r=parseInt(t.Order);if(isNaN(r))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",t.Order,t.id),new e.BufferGeometry;for(var a,n,s=r-1,i=t.KnotVector.a,o=[],c=t.Points.a,l=0,u=c.length;l<u;l+=4)o.push((new e.Vector4).fromArray(c,l));if("Closed"===t.Form)o.push(o[0]);else if("Periodic"===t.Form){a=s,n=i.length-1-a;for(l=0;l<s;++l)o.push(o[l])}var h=new ji(s,i,o,a,n).getPoints(7*o.length),p=new Float32Array(3*h.length);h.forEach((function(e,t){e.toArray(p,3*t)}));var f=new e.BufferGeometry;return f.setAttribute("position",new e.BufferAttribute(p,3)),f}},o.prototype={constructor:o,parse:function(){var e=[],t=this.parseClips();if(void 0!==t)for(var r in t){var a=t[r],n=this.addClip(a);e.push(n)}return e},parseClips:function(){if(void 0!==t.Objects.AnimationCurve){var e=this.parseAnimationCurveNodes();this.parseAnimationCurves(e);var r=this.parseAnimationLayers(e);return this.parseAnimStacks(r)}},parseAnimationCurveNodes:function(){var e=t.Objects.AnimationCurveNode,r=new Map;for(var a in e){var n=e[a];if(null!==n.attrName.match(/S|R|T|DeformPercent/)){var s={id:n.id,attr:n.attrName,curves:{}};r.set(s.id,s)}}return r},parseAnimationCurves:function(e){var a=t.Objects.AnimationCurve;for(var n in a){var s={id:a[n].id,times:a[n].KeyTime.a.map(f),values:a[n].KeyValueFloat.a},i=r.get(s.id);if(void 0!==i){var o=i.parents[0].ID,c=i.parents[0].relationship;c.match(/X/)?e.get(o).curves.x=s:c.match(/Y/)?e.get(o).curves.y=s:c.match(/Z/)?e.get(o).curves.z=s:c.match(/d|DeformPercent/)&&e.has(o)&&(e.get(o).curves.morph=s)}}},parseAnimationLayers:function(n){var s=t.Objects.AnimationLayer,i=new Map;for(var o in s){var c=[],l=r.get(parseInt(o));if(void 0!==l)l.children.forEach((function(s,i){if(n.has(s.ID)){var o=n.get(s.ID);if(void 0!==o.curves.x||void 0!==o.curves.y||void 0!==o.curves.z){if(void 0===c[i])if(void 0!==(d=r.get(s.ID).parents.filter((function(e){return void 0!==e.relationship}))[0].ID)){if(void 0===(u=t.Objects.Model[d.toString()]))return void console.warn("THREE.FBXLoader: Encountered a unused curve.",s);var l={modelName:u.attrName?e.PropertyBinding.sanitizeNodeName(u.attrName):"",ID:u.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};a.traverse((function(e){e.ID===u.id&&(l.transform=e.matrix,e.userData.transformData&&(l.eulerOrder=e.userData.transformData.eulerOrder))})),l.transform||(l.transform=new e.Matrix4),"PreRotation"in u&&(l.preRotation=u.PreRotation.value),"PostRotation"in u&&(l.postRotation=u.PostRotation.value),c[i]=l}c[i]&&(c[i][o.attr]=o)}else if(void 0!==o.curves.morph){if(void 0===c[i]){var u,h=r.get(s.ID).parents.filter((function(e){return void 0!==e.relationship}))[0].ID,p=r.get(h).parents[0].ID,f=r.get(p).parents[0].ID,d=r.get(f).parents[0].ID;l={modelName:(u=t.Objects.Model[d]).attrName?e.PropertyBinding.sanitizeNodeName(u.attrName):"",morphName:t.Objects.Deformer[h].attrName};c[i]=l}c[i][o.attr]=o}}})),i.set(parseInt(o),c)}return i},parseAnimStacks:function(e){var a=t.Objects.AnimationStack,n={};for(var s in a){var i=r.get(parseInt(s)).children;i.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");var o=e.get(i[0].ID);n[s]={name:a[s].attrName,layer:o}}return n},addClip:function(t){var r=[],a=this;return t.layer.forEach((function(e){r=r.concat(a.generateTracks(e))})),new e.AnimationClip(t.name,-1,r)},generateTracks:function(t){var r=[],a=new e.Vector3,n=new e.Quaternion,s=new e.Vector3;if(t.transform&&t.transform.decompose(a,n,s),a=a.toArray(),n=(new e.Euler).setFromQuaternion(n,t.eulerOrder).toArray(),s=s.toArray(),void 0!==t.T&&Object.keys(t.T.curves).length>0){var i=this.generateVectorTrack(t.modelName,t.T.curves,a,"position");void 0!==i&&r.push(i)}if(void 0!==t.R&&Object.keys(t.R.curves).length>0){var o=this.generateRotationTrack(t.modelName,t.R.curves,n,t.preRotation,t.postRotation,t.eulerOrder);void 0!==o&&r.push(o)}if(void 0!==t.S&&Object.keys(t.S.curves).length>0){var c=this.generateVectorTrack(t.modelName,t.S.curves,s,"scale");void 0!==c&&r.push(c)}if(void 0!==t.DeformPercent){var l=this.generateMorphTrack(t);void 0!==l&&r.push(l)}return r},generateVectorTrack:function(t,r,a,n){var s=this.getTimesForAllAxes(r),i=this.getKeyframeTrackValues(s,r,a);return new e.VectorKeyframeTrack(t+"."+n,s,i)},generateRotationTrack:function(t,r,a,n,s,i){void 0!==r.x&&(this.interpolateRotations(r.x),r.x.values=r.x.values.map(e.MathUtils.degToRad)),void 0!==r.y&&(this.interpolateRotations(r.y),r.y.values=r.y.values.map(e.MathUtils.degToRad)),void 0!==r.z&&(this.interpolateRotations(r.z),r.z.values=r.z.values.map(e.MathUtils.degToRad));var o=this.getTimesForAllAxes(r),c=this.getKeyframeTrackValues(o,r,a);void 0!==n&&((n=n.map(e.MathUtils.degToRad)).push(i),n=(new e.Euler).fromArray(n),n=(new e.Quaternion).setFromEuler(n)),void 0!==s&&((s=s.map(e.MathUtils.degToRad)).push(i),s=(new e.Euler).fromArray(s),s=(new e.Quaternion).setFromEuler(s).invert());for(var l=new e.Quaternion,u=new e.Euler,h=[],p=0;p<c.length;p+=3)u.set(c[p],c[p+1],c[p+2],i),l.setFromEuler(u),void 0!==n&&l.premultiply(n),void 0!==s&&l.multiply(s),l.toArray(h,p/3*4);return new e.QuaternionKeyframeTrack(t+".quaternion",o,h)},generateMorphTrack:function(t){var r=t.DeformPercent.curves.morph,n=r.values.map((function(e){return e/100})),s=a.getObjectByName(t.modelName).morphTargetDictionary[t.morphName];return new e.NumberKeyframeTrack(t.modelName+".morphTargetInfluences["+s+"]",r.times,n)},getTimesForAllAxes:function(e){var t=[];if(void 0!==e.x&&(t=t.concat(e.x.times)),void 0!==e.y&&(t=t.concat(e.y.times)),void 0!==e.z&&(t=t.concat(e.z.times)),(t=t.sort((function(e,t){return e-t}))).length>1){for(var r=1,a=t[0],n=1;n<t.length;n++){var s=t[n];s!==a&&(t[r]=s,a=s,r++)}t=t.slice(0,r)}return t},getKeyframeTrackValues:function(e,t,r){var a=r,n=[],s=-1,i=-1,o=-1;return e.forEach((function(e){if(t.x&&(s=t.x.times.indexOf(e)),t.y&&(i=t.y.times.indexOf(e)),t.z&&(o=t.z.times.indexOf(e)),-1!==s){var r=t.x.values[s];n.push(r),a[0]=r}else n.push(a[0]);if(-1!==i){var c=t.y.values[i];n.push(c),a[1]=c}else n.push(a[1]);if(-1!==o){var l=t.z.values[o];n.push(l),a[2]=l}else n.push(a[2])})),n},interpolateRotations:function(e){for(var t=1;t<e.values.length;t++){var r=e.values[t-1],a=e.values[t]-r,n=Math.abs(a);if(n>=180){for(var s=n/180,i=a/s,o=r+i,c=e.times[t-1],l=(e.times[t]-c)/s,u=c+l,h=[],p=[];u<e.times[t];)h.push(u),u+=l,p.push(o),o+=i;e.times=C(e.times,t,h),e.values=C(e.values,t,p)}}}},c.prototype={constructor:c,getPrevNode:function(){return this.nodeStack[this.currentIndent-2]},getCurrentNode:function(){return this.nodeStack[this.currentIndent-1]},getCurrentProp:function(){return this.currentProp},pushStack:function(e){this.nodeStack.push(e),this.currentIndent+=1},popStack:function(){this.nodeStack.pop(),this.currentIndent-=1},setCurrentProp:function(e,t){this.currentProp=e,this.currentPropName=t},parse:function(e){this.currentIndent=0,this.allNodes=new h,this.nodeStack=[],this.currentProp=[],this.currentPropName="";var t=this,r=e.split(/[\r\n]+/);return r.forEach((function(e,a){var n=e.match(/^[\s\t]*;/),s=e.match(/^[\s\t]*$/);if(!n&&!s){var i=e.match("^\\t{"+t.currentIndent+"}(\\w+):(.*){",""),o=e.match("^\\t{"+t.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),c=e.match("^\\t{"+(t.currentIndent-1)+"}}");i?t.parseNodeBegin(e,i):o?t.parseNodeProperty(e,o,r[++a]):c?t.popStack():e.match(/^[^\s\t}]/)&&t.parseNodePropertyContinued(e)}})),this.allNodes},parseNodeBegin:function(e,t){var r=t[1].trim().replace(/^"/,"").replace(/"$/,""),a=t[2].split(",").map((function(e){return e.trim().replace(/^"/,"").replace(/"$/,"")})),n={name:r},s=this.parseNodeAttr(a),i=this.getCurrentNode();0===this.currentIndent?this.allNodes.add(r,n):r in i?("PoseNode"===r?i.PoseNode.push(n):void 0!==i[r].id&&(i[r]={},i[r][i[r].id]=i[r]),""!==s.id&&(i[r][s.id]=n)):"number"==typeof s.id?(i[r]={},i[r][s.id]=n):"Properties70"!==r&&(i[r]="PoseNode"===r?[n]:n),"number"==typeof s.id&&(n.id=s.id),""!==s.name&&(n.attrName=s.name),""!==s.type&&(n.attrType=s.type),this.pushStack(n)},parseNodeAttr:function(e){var t=e[0];""!==e[0]&&(t=parseInt(e[0]),isNaN(t)&&(t=e[0]));var r="",a="";return e.length>1&&(r=e[1].replace(/^(\w+)::/,""),a=e[2]),{id:t,name:r,type:a}},parseNodeProperty:function(e,t,r){var a=t[1].replace(/^"/,"").replace(/"$/,"").trim(),n=t[2].replace(/^"/,"").replace(/"$/,"").trim();"Content"===a&&","===n&&(n=r.replace(/"/g,"").replace(/,$/,"").trim());var s=this.getCurrentNode();if("Properties70"!==s.name){if("C"===a){var i=n.split(",").slice(1),o=parseInt(i[0]),c=parseInt(i[1]),l=n.split(",").slice(3);a="connections",function(e,t){for(var r=0,a=e.length,n=t.length;r<n;r++,a++)e[a]=t[r]}(n=[o,c],l=l.map((function(e){return e.trim().replace(/^"/,"")}))),void 0===s[a]&&(s[a]=[])}"Node"===a&&(s.id=n),a in s&&Array.isArray(s[a])?s[a].push(n):"a"!==a?s[a]=n:s.a=n,this.setCurrentProp(s,a),"a"===a&&","!==n.slice(-1)&&(s.a=b(n))}else this.parseNodeSpecialProperty(e,a,n)},parseNodePropertyContinued:function(e){var t=this.getCurrentNode();t.a+=e,","!==e.slice(-1)&&(t.a=b(t.a))},parseNodeSpecialProperty:function(e,t,r){var a=r.split('",').map((function(e){return e.trim().replace(/^\"/,"").replace(/\s/,"_")})),n=a[0],s=a[1],i=a[2],o=a[3],c=a[4];switch(s){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":c=parseFloat(c);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":c=b(c)}this.getPrevNode()[n]={type:s,type2:i,flag:o,value:c},this.setCurrentProp(this.getPrevNode(),n)}},l.prototype={constructor:l,parse:function(e){var t=new u(e);t.skip(23);var r=t.getUint32();if(r<6400)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+r);for(var a=new h;!this.endOfContent(t);){var n=this.parseNode(t,r);null!==n&&a.add(n.name,n)}return a},endOfContent:function(e){return e.size()%16==0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()},parseNode:function(e,t){var r={},a=t>=7500?e.getUint64():e.getUint32(),n=t>=7500?e.getUint64():e.getUint32();t>=7500?e.getUint64():e.getUint32();var s=e.getUint8(),i=e.getString(s);if(0===a)return null;for(var o=[],c=0;c<n;c++)o.push(this.parseProperty(e));var l=o.length>0?o[0]:"",u=o.length>1?o[1]:"",h=o.length>2?o[2]:"";for(r.singleProperty=1===n&&e.getOffset()===a;a>e.getOffset();){var p=this.parseNode(e,t);null!==p&&this.parseSubNode(i,r,p)}return r.propertyList=o,"number"==typeof l&&(r.id=l),""!==u&&(r.attrName=u),""!==h&&(r.attrType=h),""!==i&&(r.name=i),r},parseSubNode:function(e,t,r){if(!0===r.singleProperty){var a=r.propertyList[0];Array.isArray(a)?(t[r.name]=r,r.a=a):t[r.name]=a}else if("Connections"===e&&"C"===r.name){var n=[];r.propertyList.forEach((function(e,t){0!==t&&n.push(e)})),void 0===t.connections&&(t.connections=[]),t.connections.push(n)}else if("Properties70"===r.name){Object.keys(r).forEach((function(e){t[e]=r[e]}))}else if("Properties70"===e&&"P"===r.name){var s,i=r.propertyList[0],o=r.propertyList[1],c=r.propertyList[2],l=r.propertyList[3];0===i.indexOf("Lcl ")&&(i=i.replace("Lcl ","Lcl_")),0===o.indexOf("Lcl ")&&(o=o.replace("Lcl ","Lcl_")),s="Color"===o||"ColorRGB"===o||"Vector"===o||"Vector3D"===o||0===o.indexOf("Lcl_")?[r.propertyList[4],r.propertyList[5],r.propertyList[6]]:r.propertyList[4],t[i]={type:o,type2:c,flag:l,value:s}}else void 0===t[r.name]?"number"==typeof r.id?(t[r.name]={},t[r.name][r.id]=r):t[r.name]=r:"PoseNode"===r.name?(Array.isArray(t[r.name])||(t[r.name]=[t[r.name]]),t[r.name].push(r)):void 0===t[r.name][r.id]&&(t[r.name][r.id]=r)},parseProperty:function(e){var t=e.getString(1);switch(t){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":var r=e.getUint32();return e.getArrayBuffer(r);case"S":r=e.getUint32();return e.getString(r);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":var a=e.getUint32(),n=e.getUint32(),s=e.getUint32();if(0===n)switch(t){case"b":case"c":return e.getBooleanArray(a);case"d":return e.getFloat64Array(a);case"f":return e.getFloat32Array(a);case"i":return e.getInt32Array(a);case"l":return e.getInt64Array(a)}void 0===Ji&&console.error("THREE.FBXLoader: External library fflate.min.js required.");var i=new u(di(new Uint8Array(e.getArrayBuffer(s))).buffer);switch(t){case"b":case"c":return i.getBooleanArray(a);case"d":return i.getFloat64Array(a);case"f":return i.getFloat32Array(a);case"i":return i.getInt32Array(a);case"l":return i.getInt64Array(a)}default:throw new Error("THREE.FBXLoader: Unknown property type "+t)}}},u.prototype={constructor:u,getOffset:function(){return this.offset},size:function(){return this.dv.buffer.byteLength},skip:function(e){this.offset+=e},getBoolean:function(){return 1==(1&this.getUint8())},getBooleanArray:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getBoolean());return t},getUint8:function(){var e=this.dv.getUint8(this.offset);return this.offset+=1,e},getInt16:function(){var e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e},getInt32:function(){var e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e},getInt32Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getInt32());return t},getUint32:function(){var e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e},getInt64:function(){var e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),2147483648&t?(t=4294967295&~t,4294967295===(e=4294967295&~e)&&(t=t+1&4294967295),-(4294967296*t+(e=e+1&4294967295))):4294967296*t+e},getInt64Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getInt64());return t},getUint64:function(){var e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),4294967296*t+e},getFloat32:function(){var e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e},getFloat32Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getFloat32());return t},getFloat64:function(){var e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e},getFloat64Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getFloat64());return t},getArrayBuffer:function(e){var t=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t},getString:function(t){for(var r=[],a=0;a<t;a++)r[a]=this.getUint8();var n=r.indexOf(0);return n>=0&&(r=r.slice(0,n)),e.LoaderUtils.decodeText(new Uint8Array(r))}},h.prototype={constructor:h,add:function(e,t){this[e]=t}};var d=[];function g(e,t,r,a){var n;switch(a.mappingType){case"ByPolygonVertex":n=e;break;case"ByPolygon":n=t;break;case"ByVertice":n=r;break;case"AllSame":n=a.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+a.mappingType)}"IndexToDirect"===a.referenceType&&(n=a.indices[n]);var s=n*a.dataSize,i=s+a.dataSize;return function(e,t,r,a){for(var n=r,s=0;n<a;n++,s++)e[s]=t[n];return e}(d,a.buffer,s,i)}var m=new e.Euler,v=new e.Vector3;function y(t){var r,a=new e.Matrix4,n=new e.Matrix4,s=new e.Matrix4,i=new e.Matrix4,o=new e.Matrix4,c=new e.Matrix4,l=new e.Matrix4,u=new e.Matrix4,h=new e.Matrix4,p=new e.Matrix4,f=new e.Matrix4,d=new e.Matrix4,g=t.inheritType?t.inheritType:0;(t.translation&&a.setPosition(v.fromArray(t.translation)),t.preRotation)&&((r=t.preRotation.map(e.MathUtils.degToRad)).push(t.eulerOrder),n.makeRotationFromEuler(m.fromArray(r)));t.rotation&&((r=t.rotation.map(e.MathUtils.degToRad)).push(t.eulerOrder),s.makeRotationFromEuler(m.fromArray(r)));t.postRotation&&((r=t.postRotation.map(e.MathUtils.degToRad)).push(t.eulerOrder),i.makeRotationFromEuler(m.fromArray(r)),i.invert());t.scale&&o.scale(v.fromArray(t.scale)),t.scalingOffset&&l.setPosition(v.fromArray(t.scalingOffset)),t.scalingPivot&&c.setPosition(v.fromArray(t.scalingPivot)),t.rotationOffset&&u.setPosition(v.fromArray(t.rotationOffset)),t.rotationPivot&&h.setPosition(v.fromArray(t.rotationPivot)),t.parentMatrixWorld&&(f.copy(t.parentMatrix),p.copy(t.parentMatrixWorld));var y=(new e.Matrix4).copy(n).multiply(s).multiply(i),A=new e.Matrix4;A.extractRotation(p);var b=new e.Matrix4;b.copyPosition(p);var B=new e.Matrix4,C=(new e.Matrix4).copy(b).invert().multiply(p);B.copy(A).invert().multiply(C);var x=o,F=new e.Matrix4;if(0===g)F.copy(A).multiply(y).multiply(B).multiply(x);else if(1===g)F.copy(A).multiply(B).multiply(y).multiply(x);else{var w=(new e.Matrix4).scale((new e.Vector3).setFromMatrixScale(f)),E=(new e.Matrix4).copy(w).invert(),S=(new e.Matrix4).copy(B).multiply(E);F.copy(A).multiply(y).multiply(S).multiply(x)}var I=new e.Matrix4;I.copy(h).invert();var M=new e.Matrix4;M.copy(c).invert();var T=new e.Matrix4;T.copy(a).multiply(u).multiply(h).multiply(n).multiply(s).multiply(i).multiply(I).multiply(l).multiply(c).multiply(o).multiply(M);var k=(new e.Matrix4).copyPosition(T),R=(new e.Matrix4).copy(p).multiply(k);return d.copyPosition(R),(T=(new e.Matrix4).copy(d).multiply(F)).premultiply(p.invert()),T}function A(e){var t=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return 6===(e=e||0)?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),t[0]):t[e]}function b(e){return e.split(",").map((function(e){return parseFloat(e)}))}function B(t,r,a){return void 0===r&&(r=0),void 0===a&&(a=t.byteLength),e.LoaderUtils.decodeText(new Uint8Array(t,r,a))}function C(e,t,r){return e.slice(0,t).concat(r).concat(e.slice(t))}return n}();function Ki(e){let t,r=e[0],a=1;for(;a<e.length;){const n=e[a],s=e[a+1];if(a+=2,("optionalAccess"===n||"optionalCall"===n)&&null==r)return;"access"===n||"optionalAccess"===n?(t=r,r=s(r)):"call"!==n&&"optionalCall"!==n||(r=s(((...e)=>r.call(t,...e))),t=void 0)}return r}function zi(e){this.IFF=e}function Wi(e){this.IFF=e}function Yi(){this.debugger=new qi}function Qi(e){this.dv=new DataView(e),this.offset=0}function qi(){this.active=!1,this.depth=0,this.formList=[]}function Zi(e){return e%2}function $i(e){return e.length+1+(Zi(e.length+1)?1:0)}zi.prototype={constructor:zi,parseBlock:function(){this.IFF.debugger.offset=this.IFF.reader.offset,this.IFF.debugger.closeForms();var e=this.IFF.reader.getIDTag(),t=this.IFF.reader.getUint32();switch(t>this.IFF.reader.dv.byteLength-this.IFF.reader.offset&&(this.IFF.reader.offset-=4,t=this.IFF.reader.getUint16()),this.IFF.debugger.dataOffset=this.IFF.reader.offset,this.IFF.debugger.length=t,e){case"FORM":this.IFF.parseForm(t);break;case"ICON":case"VMPA":case"BBOX":case"NORM":case"PRE ":case"POST":case"KEY ":case"SPAN":case"TIME":case"CLRS":case"CLRA":case"FILT":case"DITH":case"CONT":case"BRIT":case"SATR":case"HUE ":case"GAMM":case"NEGA":case"IFLT":case"PFLT":case"PROJ":case"AXIS":case"AAST":case"PIXB":case"AUVO":case"STCK":case"PROC":case"VALU":case"FUNC":case"PNAM":case"INAM":case"GRST":case"GREN":case"GRPT":case"FKEY":case"IKEY":case"CSYS":case"OPAQ":case"CMAP":case"NLOC":case"NZOM":case"NVER":case"NSRV":case"NVSK":case"NCRD":case"WRPW":case"WRPH":case"NMOD":case"NPRW":case"NPLA":case"NODS":case"VERS":case"ENUM":case"TAG ":case"OPAC":case"CGMD":case"CGTY":case"CGST":case"CGEN":case"CGTS":case"CGTE":case"OSMP":case"OMDE":case"OUTR":case"FLAG":case"TRNL":case"GLOW":case"GVAL":case"SHRP":case"RFOP":case"RSAN":case"TROP":case"RBLR":case"TBLR":case"CLRH":case"CLRF":case"ADTR":case"LINE":case"ALPH":case"VCOL":case"ENAB":this.IFF.debugger.skipped=!0,this.IFF.reader.skip(t);break;case"SURF":this.IFF.parseSurfaceLwo2(t);break;case"CLIP":this.IFF.parseClipLwo2(t);break;case"IPIX":case"IMIP":case"IMOD":case"AMOD":case"IINV":case"INCR":case"IAXS":case"IFOT":case"ITIM":case"IWRL":case"IUTI":case"IINX":case"IINY":case"IINZ":case"IREF":4===t?this.IFF.currentNode[e]=this.IFF.reader.getInt32():this.IFF.reader.skip(t);break;case"OTAG":this.IFF.parseObjectTag();break;case"LAYR":this.IFF.parseLayer(t);break;case"PNTS":this.IFF.parsePoints(t);break;case"VMAP":this.IFF.parseVertexMapping(t);break;case"AUVU":case"AUVN":this.IFF.reader.skip(t-1),this.IFF.reader.getVariableLengthIndex();break;case"POLS":this.IFF.parsePolygonList(t);break;case"TAGS":this.IFF.parseTagStrings(t);break;case"PTAG":this.IFF.parsePolygonTagMapping(t);break;case"VMAD":this.IFF.parseVertexMapping(t,!0);break;case"DESC":this.IFF.currentForm.description=this.IFF.reader.getString();break;case"TEXT":case"CMNT":case"NCOM":this.IFF.currentForm.comment=this.IFF.reader.getString();break;case"NAME":this.IFF.currentForm.channelName=this.IFF.reader.getString();break;case"WRAP":this.IFF.currentForm.wrap={w:this.IFF.reader.getUint16(),h:this.IFF.reader.getUint16()};break;case"IMAG":var r=this.IFF.reader.getVariableLengthIndex();this.IFF.currentForm.imageIndex=r;break;case"OREF":this.IFF.currentForm.referenceObject=this.IFF.reader.getString();break;case"ROID":this.IFF.currentForm.referenceObjectID=this.IFF.reader.getUint32();break;case"SSHN":this.IFF.currentSurface.surfaceShaderName=this.IFF.reader.getString();break;case"AOVN":this.IFF.currentSurface.surfaceCustomAOVName=this.IFF.reader.getString();break;case"NSTA":this.IFF.currentForm.disabled=this.IFF.reader.getUint16();break;case"NRNM":this.IFF.currentForm.realName=this.IFF.reader.getString();break;case"NNME":this.IFF.currentForm.refName=this.IFF.reader.getString(),this.IFF.currentSurface.nodes[this.IFF.currentForm.refName]=this.IFF.currentForm;break;case"INME":this.IFF.currentForm.nodeName||(this.IFF.currentForm.nodeName=[]),this.IFF.currentForm.nodeName.push(this.IFF.reader.getString());break;case"IINN":this.IFF.currentForm.inputNodeName||(this.IFF.currentForm.inputNodeName=[]),this.IFF.currentForm.inputNodeName.push(this.IFF.reader.getString());break;case"IINM":this.IFF.currentForm.inputName||(this.IFF.currentForm.inputName=[]),this.IFF.currentForm.inputName.push(this.IFF.reader.getString());break;case"IONM":this.IFF.currentForm.inputOutputName||(this.IFF.currentForm.inputOutputName=[]),this.IFF.currentForm.inputOutputName.push(this.IFF.reader.getString());break;case"FNAM":this.IFF.currentForm.fileName=this.IFF.reader.getString();break;case"CHAN":4===t?this.IFF.currentForm.textureChannel=this.IFF.reader.getIDTag():this.IFF.reader.skip(t);break;case"SMAN":var a=this.IFF.reader.getFloat32();this.IFF.currentSurface.attributes.smooth=!(a<0);break;case"COLR":this.IFF.currentSurface.attributes.Color={value:this.IFF.reader.getFloat32Array(3)},this.IFF.reader.skip(2);break;case"LUMI":this.IFF.currentSurface.attributes.Luminosity={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"SPEC":this.IFF.currentSurface.attributes.Specular={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"DIFF":this.IFF.currentSurface.attributes.Diffuse={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"REFL":this.IFF.currentSurface.attributes.Reflection={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"GLOS":this.IFF.currentSurface.attributes.Glossiness={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"TRAN":this.IFF.currentSurface.attributes.opacity=this.IFF.reader.getFloat32(),this.IFF.reader.skip(2);break;case"BUMP":this.IFF.currentSurface.attributes.bumpStrength=this.IFF.reader.getFloat32(),this.IFF.reader.skip(2);break;case"SIDE":this.IFF.currentSurface.attributes.side=this.IFF.reader.getUint16();break;case"RIMG":this.IFF.currentSurface.attributes.reflectionMap=this.IFF.reader.getVariableLengthIndex();break;case"RIND":this.IFF.currentSurface.attributes.refractiveIndex=this.IFF.reader.getFloat32(),this.IFF.reader.skip(2);break;case"TIMG":this.IFF.currentSurface.attributes.refractionMap=this.IFF.reader.getVariableLengthIndex();break;case"IMAP":this.IFF.reader.skip(2);break;case"TMAP":this.IFF.debugger.skipped=!0,this.IFF.reader.skip(t);break;case"IUVI":this.IFF.currentNode.UVChannel=this.IFF.reader.getString(t);break;case"IUTL":this.IFF.currentNode.widthWrappingMode=this.IFF.reader.getUint32();break;case"IVTL":this.IFF.currentNode.heightWrappingMode=this.IFF.reader.getUint32();break;case"BLOK":break;default:this.IFF.parseUnknownCHUNK(e,t)}"FORM"!=e&&(this.IFF.debugger.node=1,this.IFF.debugger.nodeID=e,this.IFF.debugger.log()),this.IFF.reader.offset>=this.IFF.currentFormEnd&&(this.IFF.currentForm=this.IFF.parentForm)}},Wi.prototype={constructor:Wi,parseBlock:function(){this.IFF.debugger.offset=this.IFF.reader.offset,this.IFF.debugger.closeForms();var e=this.IFF.reader.getIDTag(),t=this.IFF.reader.getUint32();switch(this.IFF.debugger.dataOffset=this.IFF.reader.offset,this.IFF.debugger.length=t,e){case"FORM":this.IFF.parseForm(t);break;case"ICON":case"VMPA":case"BBOX":case"NORM":case"PRE ":case"POST":case"KEY ":case"SPAN":case"TIME":case"CLRS":case"CLRA":case"FILT":case"DITH":case"CONT":case"BRIT":case"SATR":case"HUE ":case"GAMM":case"NEGA":case"IFLT":case"PFLT":case"PROJ":case"AXIS":case"AAST":case"PIXB":case"STCK":case"VALU":case"PNAM":case"INAM":case"GRST":case"GREN":case"GRPT":case"FKEY":case"IKEY":case"CSYS":case"OPAQ":case"CMAP":case"NLOC":case"NZOM":case"NVER":case"NSRV":case"NCRD":case"NMOD":case"NSEL":case"NPRW":case"NPLA":case"VERS":case"ENUM":case"TAG ":case"CGMD":case"CGTY":case"CGST":case"CGEN":case"CGTS":case"CGTE":case"OSMP":case"OMDE":case"OUTR":case"FLAG":case"TRNL":case"SHRP":case"RFOP":case"RSAN":case"TROP":case"RBLR":case"TBLR":case"CLRH":case"CLRF":case"ADTR":case"GLOW":case"LINE":case"ALPH":case"VCOL":case"ENAB":this.IFF.debugger.skipped=!0,this.IFF.reader.skip(t);break;case"IPIX":case"IMIP":case"IMOD":case"AMOD":case"IINV":case"INCR":case"IAXS":case"IFOT":case"ITIM":case"IWRL":case"IUTI":case"IINX":case"IINY":case"IINZ":case"IREF":4===t?this.IFF.currentNode[e]=this.IFF.reader.getInt32():this.IFF.reader.skip(t);break;case"OTAG":this.IFF.parseObjectTag();break;case"LAYR":this.IFF.parseLayer(t);break;case"PNTS":this.IFF.parsePoints(t);break;case"VMAP":this.IFF.parseVertexMapping(t);break;case"POLS":this.IFF.parsePolygonList(t);break;case"TAGS":this.IFF.parseTagStrings(t);break;case"PTAG":this.IFF.parsePolygonTagMapping(t);break;case"VMAD":this.IFF.parseVertexMapping(t,!0);break;case"DESC":this.IFF.currentForm.description=this.IFF.reader.getString();break;case"TEXT":case"CMNT":case"NCOM":this.IFF.currentForm.comment=this.IFF.reader.getString();break;case"NAME":this.IFF.currentForm.channelName=this.IFF.reader.getString();break;case"WRAP":this.IFF.currentForm.wrap={w:this.IFF.reader.getUint16(),h:this.IFF.reader.getUint16()};break;case"IMAG":var r=this.IFF.reader.getVariableLengthIndex();this.IFF.currentForm.imageIndex=r;break;case"OREF":this.IFF.currentForm.referenceObject=this.IFF.reader.getString();break;case"ROID":this.IFF.currentForm.referenceObjectID=this.IFF.reader.getUint32();break;case"SSHN":this.IFF.currentSurface.surfaceShaderName=this.IFF.reader.getString();break;case"AOVN":this.IFF.currentSurface.surfaceCustomAOVName=this.IFF.reader.getString();break;case"NSTA":this.IFF.currentForm.disabled=this.IFF.reader.getUint16();break;case"NRNM":this.IFF.currentForm.realName=this.IFF.reader.getString();break;case"NNME":this.IFF.currentForm.refName=this.IFF.reader.getString(),this.IFF.currentSurface.nodes[this.IFF.currentForm.refName]=this.IFF.currentForm;break;case"INME":this.IFF.currentForm.nodeName||(this.IFF.currentForm.nodeName=[]),this.IFF.currentForm.nodeName.push(this.IFF.reader.getString());break;case"IINN":this.IFF.currentForm.inputNodeName||(this.IFF.currentForm.inputNodeName=[]),this.IFF.currentForm.inputNodeName.push(this.IFF.reader.getString());break;case"IINM":this.IFF.currentForm.inputName||(this.IFF.currentForm.inputName=[]),this.IFF.currentForm.inputName.push(this.IFF.reader.getString());break;case"IONM":this.IFF.currentForm.inputOutputName||(this.IFF.currentForm.inputOutputName=[]),this.IFF.currentForm.inputOutputName.push(this.IFF.reader.getString());break;case"FNAM":this.IFF.currentForm.fileName=this.IFF.reader.getString();break;case"CHAN":4===t?this.IFF.currentForm.textureChannel=this.IFF.reader.getIDTag():this.IFF.reader.skip(t);break;case"SMAN":var a=this.IFF.reader.getFloat32();this.IFF.currentSurface.attributes.smooth=!(a<0);break;case"COLR":this.IFF.currentSurface.attributes.Color={value:this.IFF.reader.getFloat32Array(3)},this.IFF.reader.skip(2);break;case"LUMI":this.IFF.currentSurface.attributes.Luminosity={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"SPEC":this.IFF.currentSurface.attributes.Specular={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"DIFF":this.IFF.currentSurface.attributes.Diffuse={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"REFL":this.IFF.currentSurface.attributes.Reflection={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"GLOS":this.IFF.currentSurface.attributes.Glossiness={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"TRAN":this.IFF.currentSurface.attributes.opacity=this.IFF.reader.getFloat32(),this.IFF.reader.skip(2);break;case"BUMP":this.IFF.currentSurface.attributes.bumpStrength=this.IFF.reader.getFloat32(),this.IFF.reader.skip(2);break;case"SIDE":this.IFF.currentSurface.attributes.side=this.IFF.reader.getUint16();break;case"RIMG":this.IFF.currentSurface.attributes.reflectionMap=this.IFF.reader.getVariableLengthIndex();break;case"RIND":this.IFF.currentSurface.attributes.refractiveIndex=this.IFF.reader.getFloat32(),this.IFF.reader.skip(2);break;case"TIMG":this.IFF.currentSurface.attributes.refractionMap=this.IFF.reader.getVariableLengthIndex();break;case"IMAP":this.IFF.currentSurface.attributes.imageMapIndex=this.IFF.reader.getUint32();break;case"IUVI":this.IFF.currentNode.UVChannel=this.IFF.reader.getString(t);break;case"IUTL":this.IFF.currentNode.widthWrappingMode=this.IFF.reader.getUint32();break;case"IVTL":this.IFF.currentNode.heightWrappingMode=this.IFF.reader.getUint32();break;default:this.IFF.parseUnknownCHUNK(e,t)}"FORM"!=e&&(this.IFF.debugger.node=1,this.IFF.debugger.nodeID=e,this.IFF.debugger.log()),this.IFF.reader.offset>=this.IFF.currentFormEnd&&(this.IFF.currentForm=this.IFF.parentForm)}},Yi.prototype={constructor:Yi,parse:function(e){if(this.reader=new Qi(e),this.tree={materials:{},layers:[],tags:[],textures:[]},this.currentLayer=this.tree,this.currentForm=this.tree,this.parseTopForm(),void 0!==this.tree.format){if("LWO2"===this.tree.format)for(this.parser=new zi(this);!this.reader.endOfFile();)this.parser.parseBlock();else if("LWO3"===this.tree.format)for(this.parser=new Wi(this);!this.reader.endOfFile();)this.parser.parseBlock();return this.debugger.offset=this.reader.offset,this.debugger.closeForms(),this.tree}},parseTopForm(){if(this.debugger.offset=this.reader.offset,"FORM"===this.reader.getIDTag()){var e=this.reader.getUint32();this.debugger.dataOffset=this.reader.offset,this.debugger.length=e;var t=this.reader.getIDTag();("LWO2"===t||"LWO3"===t)&&(this.tree.format=t),this.debugger.node=0,this.debugger.nodeID=t,this.debugger.log()}else console.warn("LWOLoader: Top-level FORM missing.")},parseForm(e){var t=this.reader.getIDTag();switch(t){case"ISEQ":case"ANIM":case"STCC":case"VPVL":case"VPRM":case"NROT":case"WRPW":case"WRPH":case"FUNC":case"FALL":case"OPAC":case"GRAD":case"ENVS":case"VMOP":case"VMBG":case"OMAX":case"STEX":case"CKBG":case"CKEY":case"VMLA":case"VMLB":this.debugger.skipped=!0,this.skipForm(e);break;case"META":case"NNDS":case"NODS":case"NDTA":case"ADAT":case"AOVS":case"BLOK":case"IBGC":case"IOPC":case"IIMG":case"TXTR":this.debugger.length=4,this.debugger.skipped=!0;break;case"IFAL":case"ISCL":case"IPOS":case"IROT":case"IBMP":case"IUTD":case"IVTD":this.parseTextureNodeAttribute(t);break;case"ENVL":this.parseEnvelope(e);break;case"CLIP":"LWO2"===this.tree.format?this.parseForm(e):this.parseClip(e);break;case"STIL":this.parseImage();break;case"XREF":this.reader.skip(8),this.currentForm.referenceTexture={index:this.reader.getUint32(),refName:this.reader.getString()};break;case"IMST":this.parseImageStateForm(e);break;case"SURF":this.parseSurfaceForm(e);break;case"VALU":this.parseValueForm(e);break;case"NTAG":this.parseSubNode(e);break;case"ATTR":case"SATR":this.setupForm("attributes",e);break;case"NCON":this.parseConnections(e);break;case"SSHA":this.parentForm=this.currentForm,this.currentForm=this.currentSurface,this.setupForm("surfaceShader",e);break;case"SSHD":this.setupForm("surfaceShaderData",e);break;case"ENTR":this.parseEntryForm(e);break;case"IMAP":this.parseImageMap(e);break;case"TAMP":this.parseXVAL("amplitude",e);break;case"TMAP":this.setupForm("textureMap",e);break;case"CNTR":this.parseXVAL3("center",e);break;case"SIZE":this.parseXVAL3("scale",e);break;case"ROTA":this.parseXVAL3("rotation",e);break;default:this.parseUnknownForm(t,e)}this.debugger.node=0,this.debugger.nodeID=t,this.debugger.log()},setupForm(e,t){this.currentForm||(this.currentForm=this.currentNode),this.currentFormEnd=this.reader.offset+t,this.parentForm=this.currentForm,this.currentForm[e]?(console.warn("LWOLoader: form already exists on parent: ",e,this.currentForm),this.currentForm=this.currentForm[e]):(this.currentForm[e]={},this.currentForm=this.currentForm[e])},skipForm(e){this.reader.skip(e-4)},parseUnknownForm(t,r){var a,n,s;console.warn("LWOLoader: unknown FORM encountered: "+t,r),a=this.reader.dv.buffer,n=this.reader.offset,s=r-4,console.log(e.LoaderUtils.decodeText(new Uint8Array(a,n,s))),this.reader.skip(r-4)},parseSurfaceForm(e){this.reader.skip(8);var t=this.reader.getString(),r={attributes:{},connections:{},name:t,inputName:t,nodes:{},source:this.reader.getString()};this.tree.materials[t]=r,this.currentSurface=r,this.parentForm=this.tree.materials,this.currentForm=r,this.currentFormEnd=this.reader.offset+e},parseSurfaceLwo2(e){var t=this.reader.getString(),r={attributes:{},connections:{},name:t,nodes:{},source:this.reader.getString()};this.tree.materials[t]=r,this.currentSurface=r,this.parentForm=this.tree.materials,this.currentForm=r,this.currentFormEnd=this.reader.offset+e},parseSubNode(e){this.reader.skip(8);var t={name:this.reader.getString()};this.currentForm=t,this.currentNode=t,this.currentFormEnd=this.reader.offset+e},parseConnections(e){this.currentFormEnd=this.reader.offset+e,this.parentForm=this.currentForm,this.currentForm=this.currentSurface.connections},parseEntryForm(e){this.reader.skip(8);var t=this.reader.getString();this.currentForm=this.currentNode.attributes,this.setupForm(t,e)},parseValueForm(){this.reader.skip(8);var e=this.reader.getString();"double"===e?this.currentForm.value=this.reader.getUint64():"int"===e?this.currentForm.value=this.reader.getUint32():"vparam"===e?(this.reader.skip(24),this.currentForm.value=this.reader.getFloat64()):"vparam3"===e&&(this.reader.skip(24),this.currentForm.value=this.reader.getFloat64Array(3))},parseImageStateForm(){this.reader.skip(8),this.currentForm.mipMapLevel=this.reader.getFloat32()},parseImageMap(e){this.currentFormEnd=this.reader.offset+e,this.parentForm=this.currentForm,this.currentForm.maps||(this.currentForm.maps=[]);var t={};this.currentForm.maps.push(t),this.currentForm=t,this.reader.skip(10)},parseTextureNodeAttribute(e){switch(this.reader.skip(28),this.reader.skip(20),e){case"ISCL":this.currentNode.scale=this.reader.getFloat32Array(3);break;case"IPOS":this.currentNode.position=this.reader.getFloat32Array(3);break;case"IROT":this.currentNode.rotation=this.reader.getFloat32Array(3);break;case"IFAL":this.currentNode.falloff=this.reader.getFloat32Array(3);break;case"IBMP":this.currentNode.amplitude=this.reader.getFloat32();break;case"IUTD":this.currentNode.uTiles=this.reader.getFloat32();break;case"IVTD":this.currentNode.vTiles=this.reader.getFloat32()}this.reader.skip(2)},parseEnvelope(e){this.reader.skip(e-4)},parseClip(e){if("FORM"===this.reader.getIDTag())return this.reader.skip(16),void(this.currentNode.fileName=this.reader.getString());this.reader.setOffset(this.reader.offset-4),this.currentFormEnd=this.reader.offset+e,this.parentForm=this.currentForm,this.reader.skip(8);var t={index:this.reader.getUint32()};this.tree.textures.push(t),this.currentForm=t},parseClipLwo2(e){for(var t={index:this.reader.getUint32(),fileName:""};;){var r=this.reader.getIDTag(),a=this.reader.getUint16();if("STIL"===r){t.fileName=this.reader.getString();break}if(a>=e)break}this.tree.textures.push(t),this.currentForm=t},parseImage(){this.reader.skip(8),this.currentForm.fileName=this.reader.getString()},parseXVAL(e,t){var r=this.reader.offset+t-4;this.reader.skip(8),this.currentForm[e]=this.reader.getFloat32(),this.reader.setOffset(r)},parseXVAL3(e,t){var r=this.reader.offset+t-4;this.reader.skip(8),this.currentForm[e]={x:this.reader.getFloat32(),y:this.reader.getFloat32(),z:this.reader.getFloat32()},this.reader.setOffset(r)},parseObjectTag(){this.tree.objectTags||(this.tree.objectTags={}),this.tree.objectTags[this.reader.getIDTag()]={tagString:this.reader.getString()}},parseLayer(e){var t={number:this.reader.getUint16(),flags:this.reader.getUint16(),pivot:this.reader.getFloat32Array(3),name:this.reader.getString()};this.tree.layers.push(t),this.currentLayer=t;var r=16+$i(this.currentLayer.name);this.currentLayer.parent=r<e?this.reader.getUint16():-1},parsePoints(e){this.currentPoints=[];for(var t=0;t<e/4;t+=3)this.currentPoints.push(this.reader.getFloat32(),this.reader.getFloat32(),-this.reader.getFloat32())},parseVertexMapping(e,t){var r=this.reader.offset+e,a=this.reader.getString();if(this.reader.offset!==r){this.reader.setOffset(this.reader.offset-$i(a));var n=this.reader.getIDTag();this.reader.getUint16();var s=this.reader.getString(),i=e-6-$i(s);switch(n){case"TXUV":this.parseUVMapping(s,r,t);break;case"MORF":case"SPOT":this.parseMorphTargets(s,r,n);break;case"APSL":case"NORM":case"WGHT":case"MNVW":case"PICK":case"RGB ":case"RGBA":this.reader.skip(i);break;default:console.warn("LWOLoader: unknown vertex map type: "+n),this.reader.skip(i)}}else this.currentForm.UVChannel=a},parseUVMapping(e,t,r){for(var a=[],n=[],s=[];this.reader.offset<t;)a.push(this.reader.getVariableLengthIndex()),r&&n.push(this.reader.getVariableLengthIndex()),s.push(this.reader.getFloat32(),this.reader.getFloat32());r?(this.currentLayer.discontinuousUVs||(this.currentLayer.discontinuousUVs={}),this.currentLayer.discontinuousUVs[e]={uvIndices:a,polyIndices:n,uvs:s}):(this.currentLayer.uvs||(this.currentLayer.uvs={}),this.currentLayer.uvs[e]={uvIndices:a,uvs:s})},parseMorphTargets(e,t,r){var a=[],n=[];for(r="MORF"===r?"relative":"absolute";this.reader.offset<t;)a.push(this.reader.getVariableLengthIndex()),n.push(this.reader.getFloat32(),this.reader.getFloat32(),-this.reader.getFloat32());this.currentLayer.morphTargets||(this.currentLayer.morphTargets={}),this.currentLayer.morphTargets[e]={indices:a,points:n,type:r}},parsePolygonList(e){for(var t=this.reader.offset+e,r=this.reader.getIDTag(),a=[],n=[];this.reader.offset<t;){var s=this.reader.getUint16();s&=1023,n.push(s);for(var i=0;i<s;i++)a.push(this.reader.getVariableLengthIndex())}var o={type:r,vertexIndices:a,polygonDimensions:n,points:this.currentPoints};1===n[0]?o.type="points":2===n[0]&&(o.type="lines"),this.currentLayer.geometry=o},parseTagStrings(e){this.tree.tags=this.reader.getStringArray(e)},parsePolygonTagMapping(e){var t=this.reader.offset+e;"SURF"===this.reader.getIDTag()?this.parseMaterialIndices(t):this.reader.skip(e-4)},parseMaterialIndices(e){for(this.currentLayer.geometry.materialIndices=[];this.reader.offset<e;){var t=this.reader.getVariableLengthIndex(),r=this.reader.getUint16();this.currentLayer.geometry.materialIndices.push(t,r)}},parseUnknownCHUNK(e,t){console.warn("LWOLoader: unknown chunk type: "+e+" length: "+t);var r=this.reader.getString(t);this.currentForm[e]=r}},Qi.prototype={constructor:Qi,size:function(){return this.dv.buffer.byteLength},setOffset(e){e>0&&e<this.dv.buffer.byteLength?this.offset=e:console.error("LWOLoader: invalid buffer offset")},endOfFile:function(){return this.offset>=this.size()},skip:function(e){this.offset+=e},getUint8:function(){var e=this.dv.getUint8(this.offset);return this.offset+=1,e},getUint16:function(){var e=this.dv.getUint16(this.offset);return this.offset+=2,e},getInt32:function(){var e=this.dv.getInt32(this.offset,!1);return this.offset+=4,e},getUint32:function(){var e=this.dv.getUint32(this.offset,!1);return this.offset+=4,e},getUint64:function(){return 4294967296*this.getUint32()+this.getUint32()},getFloat32:function(){var e=this.dv.getFloat32(this.offset,!1);return this.offset+=4,e},getFloat32Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getFloat32());return t},getFloat64:function(){var e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e},getFloat64Array:function(e){for(var t=[],r=0;r<e;r++)t.push(this.getFloat64());return t},getVariableLengthIndex(){var e=this.getUint8();return 255===e?65536*this.getUint8()+256*this.getUint8()+this.getUint8():256*e+this.getUint8()},getIDTag(){return this.getString(4)},getString:function(t){if(0!==t){var r=[];if(t)for(var a=0;a<t;a++)r[a]=this.getUint8();else{for(var n,s=0;0!==n;)0!==(n=this.getUint8())&&r.push(n),s++;Zi(s+1)||this.getUint8()}return e.LoaderUtils.decodeText(new Uint8Array(r))}},getStringArray:function(e){var t=this.getString(e);return(t=t.split("\0")).filter(Boolean)}},qi.prototype={constructor:qi,enable:function(){this.active=!0},log:function(){if(this.active){var e;switch(this.node){case 0:e="FORM";break;case 1:e="CHK";break;case 2:e="S-CHK"}console.log("| ".repeat(this.depth)+e,this.nodeID,`( ${this.offset} ) -> ( ${this.dataOffset+this.length} )`,0==this.node?" {":"",this.skipped?"SKIPPED":"",0==this.node&&this.skipped?"}":""),0!=this.node||this.skipped||(this.depth+=1,this.formList.push(this.dataOffset+this.length)),this.skipped=!1}},closeForms:function(){if(this.active)for(var e=this.formList.length-1;e>=0;e--)this.offset>=this.formList[e]&&(this.depth-=1,console.log("| ".repeat(this.depth)+"}"),this.formList.splice(-1,1))}};var eo=function(t,r){e.Loader.call(this,t),r=r||{},this.resourcePath=void 0!==r.resourcePath?r.resourcePath:""};function to(e){this.textureLoader=e}function ro(e){this.textureLoader=e}function ao(){}eo.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:eo,load:function(t,r,a,n){var s=this,i=""===s.path?function(e,t){var r=e.indexOf(t);return-1===r?"./":e.substr(0,r)}(t,"Objects"):s.path,o=t.split(i).pop().split(".")[0],c=new e.FileLoader(this.manager);c.setPath(s.path),c.setResponseType("arraybuffer"),c.load(t,(function(e){try{r(s.parse(e,i,o))}catch(e){n?n(e):console.error(e),s.manager.itemError(t)}}),a,n)},parse:function(t,r,a){return Vi=(new Yi).parse(t),new to(new e.TextureLoader(this.manager).setPath(this.resourcePath||r).setCrossOrigin(this.crossOrigin)).parse(a)}}),to.prototype={constructor:to,parse:function(e){return this.materials=new ro(this.textureLoader).parse(),this.defaultLayerName=e,this.meshes=this.parseLayers(),{materials:this.materials,meshes:this.meshes}},parseLayers(){var e=[],t=[],r=new ao,a=this;return Vi.layers.forEach((function(n){var s=r.parse(n.geometry,n),i=a.parseMesh(s,n);e[n.number]=i,-1===n.parent?t.push(i):e[n.parent].add(i)})),this.applyPivots(t),t},parseMesh(t,r){var a,n=this.getMaterials(t.userData.matNames,r.geometry.type);return this.duplicateUVs(t,n),a="points"===r.geometry.type?new e.Points(t,n):"lines"===r.geometry.type?new e.LineSegments(t,n):new e.Mesh(t,n),r.name?a.name=r.name:a.name=this.defaultLayerName+"_layer_"+r.number,a.userData.pivot=r.pivot,a},applyPivots(e){e.forEach((function(e){e.traverse((function(e){var t=e.userData.pivot;if(e.position.x+=t[0],e.position.y+=t[1],e.position.z+=t[2],e.parent){var r=e.parent.userData.pivot;e.position.x-=r[0],e.position.y-=r[1],e.position.z-=r[2]}}))}))},getMaterials(t,r){var a=[],n=this;t.forEach((function(e,t){a[t]=n.getMaterialByName(e)})),"points"!==r&&"lines"!==r||a.forEach((function(t,n){var s={color:t.color};"points"===r?(s.size=.1,s.map=t.map,s.morphTargets=t.morphTargets,a[n]=new e.PointsMaterial(s)):"lines"===r&&(a[n]=new e.LineBasicMaterial(s))}));var s=a.filter(Boolean);return 1===s.length?s[0]:a},getMaterialByName(e){return this.materials.filter((function(t){return t.name===e}))[0]},duplicateUVs(t,r){var a=!1;Array.isArray(r)?r.forEach((function(e){e.aoMap&&(a=!0)})):r.aoMap&&(a=!0),a&&t.setAttribute("uv2",new e.BufferAttribute(t.attributes.uv.array,2))}},ro.prototype={constructor:ro,parse:function(){var e=[];for(var t in this.textures={},Vi.materials)"LWO3"===Vi.format?e.push(this.parseMaterial(Vi.materials[t],t,Vi.textures)):"LWO2"===Vi.format&&e.push(this.parseMaterialLwo2(Vi.materials[t],t,Vi.textures));return e},parseMaterial(e,t,r){var a={name:t,side:this.getSide(e.attributes),flatShading:this.getSmooth(e.attributes)},n=this.parseConnections(e.connections,e.nodes),s=this.parseTextureNodes(n.maps);this.parseAttributeImageMaps(n.attributes,r,s,e.maps);var i=this.parseAttributes(n.attributes,s);return this.parseEnvMap(n,s,i),a=Object.assign(s,a),a=Object.assign(a,i),new(this.getMaterialType(n.attributes))(a)},parseMaterialLwo2(t,r){var a={name:r,side:this.getSide(t.attributes),flatShading:this.getSmooth(t.attributes)},n=this.parseAttributes(t.attributes,{});return a=Object.assign(a,n),new e.MeshPhongMaterial(a)},getSide(t){if(!t.side)return e.BackSide;switch(t.side){case 0:case 1:return e.BackSide;case 2:return e.FrontSide;case 3:return e.DoubleSide}},getSmooth:e=>!e.smooth||!e.smooth,parseConnections(e,t){var r={maps:{}},a=e.inputName,n=e.inputNodeName,s=e.nodeName,i=this;return a.forEach((function(e,a){if("Material"===e){var s=i.getNodeByRefName(n[a],t);r.attributes=s.attributes,r.envMap=s.fileName,r.name=n[a]}})),s.forEach((function(e,s){e===r.name&&(r.maps[a[s]]=i.getNodeByRefName(n[s],t))})),r},getNodeByRefName(e,t){for(var r in t)if(t[r].refName===e)return t[r]},parseTextureNodes(t){var r={};for(var a in t){var n=t[a],s=n.fileName;if(!s)return;var i=this.loadTexture(s);switch(void 0!==n.widthWrappingMode&&(i.wrapS=this.getWrappingType(n.widthWrappingMode)),void 0!==n.heightWrappingMode&&(i.wrapT=this.getWrappingType(n.heightWrappingMode)),a){case"Color":r.map=i;break;case"Roughness":r.roughnessMap=i,r.roughness=.5;break;case"Specular":r.specularMap=i,r.specular=16777215;break;case"Luminous":r.emissiveMap=i,r.emissive=8421504;break;case"Luminous Color":r.emissive=8421504;break;case"Metallic":r.metalnessMap=i,r.metalness=.5;break;case"Transparency":case"Alpha":r.alphaMap=i,r.transparent=!0;break;case"Normal":r.normalMap=i,void 0!==n.amplitude&&(r.normalScale=new e.Vector2(n.amplitude,n.amplitude));break;case"Bump":r.bumpMap=i}}return r.roughnessMap&&r.specularMap&&delete r.specularMap,r},parseAttributeImageMaps(e,t,r){for(var a in e){var n=e[a];if(n.maps){var s=n.maps[0],i=this.getTexturePathByIndex(s.imageIndex,t);if(!i)return;var o=this.loadTexture(i);switch(void 0!==s.wrap&&(o.wrapS=this.getWrappingType(s.wrap.w)),void 0!==s.wrap&&(o.wrapT=this.getWrappingType(s.wrap.h)),a){case"Color":r.map=o;break;case"Diffuse":r.aoMap=o;break;case"Roughness":r.roughnessMap=o,r.roughness=1;break;case"Specular":r.specularMap=o,r.specular=16777215;break;case"Luminosity":r.emissiveMap=o,r.emissive=8421504;break;case"Metallic":r.metalnessMap=o,r.metalness=1;break;case"Transparency":case"Alpha":r.alphaMap=o,r.transparent=!0;break;case"Normal":r.normalMap=o;break;case"Bump":r.bumpMap=o}}}},parseAttributes(t,r){var a={};return t.Color&&!r.map?a.color=(new e.Color).fromArray(t.Color.value):a.color=new e.Color,t.Transparency&&0!==t.Transparency.value&&(a.opacity=1-t.Transparency.value,a.transparent=!0),t["Bump Height"]&&(a.bumpScale=.1*t["Bump Height"].value),t["Refraction Index"]&&(a.refractionRatio=1/t["Refraction Index"].value),this.parsePhysicalAttributes(a,t,r),this.parseStandardAttributes(a,t,r),this.parsePhongAttributes(a,t,r),a},parsePhysicalAttributes(e,t){t.Clearcoat&&t.Clearcoat.value>0&&(e.clearcoat=t.Clearcoat.value,t["Clearcoat Gloss"]&&(e.clearcoatRoughness=.5*(1-t["Clearcoat Gloss"].value)))},parseStandardAttributes(t,r,a){r.Luminous&&(t.emissiveIntensity=r.Luminous.value,r["Luminous Color"]&&!a.emissive?t.emissive=(new e.Color).fromArray(r["Luminous Color"].value):t.emissive=new e.Color(8421504)),r.Roughness&&!a.roughnessMap&&(t.roughness=r.Roughness.value),r.Metallic&&!a.metalnessMap&&(t.metalness=r.Metallic.value)},parsePhongAttributes(t,r,a){r.Diffuse&&t.color.multiplyScalar(r.Diffuse.value),r.Reflection&&(t.reflectivity=r.Reflection.value,t.combine=e.AddOperation),r.Luminosity&&(t.emissiveIntensity=r.Luminosity.value,a.emissiveMap||a.map?t.emissive=new e.Color(8421504):t.emissive=t.color),r.Roughness||!r.Specular||a.specularMap||(r["Color Highlight"]?t.specular=(new e.Color).setScalar(r.Specular.value).lerp(t.color.clone().multiplyScalar(r.Specular.value),r["Color Highlight"].value):t.specular=(new e.Color).setScalar(r.Specular.value)),t.specular&&r.Glossiness&&(t.shininess=7+Math.pow(2,12*r.Glossiness.value+2))},parseEnvMap(t,r,a){if(t.envMap){var n=this.loadTexture(t.envMap);a.transparent&&a.opacity<.999?(n.mapping=e.EquirectangularRefractionMapping,void 0!==a.reflectivity&&(delete a.reflectivity,delete a.combine),void 0!==a.metalness&&delete a.metalness):n.mapping=e.EquirectangularReflectionMapping,r.envMap=n}},getTexturePathByIndex(e){var t="";return Vi.textures?(Vi.textures.forEach((function(r){r.index===e&&(t=r.fileName)})),t):t},loadTexture(e){return e?this.textureLoader.load(e,void 0,void 0,(function(){console.warn("LWOLoader: non-standard resource hierarchy. Use `resourcePath` parameter to specify root content directory.")})):null},getWrappingType(t){switch(t){case 0:return console.warn('LWOLoader: "Reset" texture wrapping type is not supported in three.js'),e.ClampToEdgeWrapping;case 1:return e.RepeatWrapping;case 2:return e.MirroredRepeatWrapping;case 3:return e.ClampToEdgeWrapping}},getMaterialType:t=>t.Clearcoat&&t.Clearcoat.value>0?e.MeshPhysicalMaterial:t.Roughness?e.MeshStandardMaterial:e.MeshPhongMaterial},ao.prototype={constructor:ao,parse(t,r){var a=new e.BufferGeometry;a.setAttribute("position",new e.Float32BufferAttribute(t.points,3));var n=this.splitIndices(t.vertexIndices,t.polygonDimensions);return a.setIndex(n),this.parseGroups(a,t),a.computeVertexNormals(),this.parseUVs(a,r,n),this.parseMorphTargets(a,r,n),a.translate(-r.pivot[0],-r.pivot[1],-r.pivot[2]),a},splitIndices(e,t){var r=[],a=0;return t.forEach((function(t){if(t<4)for(var n=0;n<t;n++)r.push(e[a+n]);else if(4===t)r.push(e[a],e[a+1],e[a+2],e[a],e[a+2],e[a+3]);else if(t>4){for(n=1;n<t-1;n++)r.push(e[a],e[a+n],e[a+n+1]);console.warn("LWOLoader: polygons with greater than 4 sides are not supported")}a+=t})),r},parseGroups(e,t){var r=Vi.tags,a=[],n=3;"lines"===t.type&&(n=2),"points"===t.type&&(n=1);for(var s,i=this.splitMaterialIndices(t.polygonDimensions,t.materialIndices),o=0,c={},l=0,u=0,h=0;h<i.length;h+=2){var p,f=i[h+1];if(0===h&&(a[o]=r[f]),void 0===s&&(s=f),f!==s)c[r[s]]?p=c[r[s]]:(p=o,c[r[s]]=o,a[o]=r[s],o++),e.addGroup(l,u,p),l+=u,s=f,u=0;u+=n}e.groups.length>0&&(c[r[f]]?p=c[r[f]]:(p=o,c[r[f]]=o,a[o]=r[f]),e.addGroup(l,u,p));e.userData.matNames=a},splitMaterialIndices(e,t){var r=[];return e.forEach((function(e,a){if(e<=3)r.push(t[2*a],t[2*a+1]);else if(4===e)r.push(t[2*a],t[2*a+1],t[2*a],t[2*a+1]);else for(var n=0;n<e-2;n++)r.push(t[2*a],t[2*a+1])})),r},parseUVs(t,r){var a=Array.from(Array(2*t.attributes.position.count),(function(){return 0}));for(var n in r.uvs){var s=r.uvs[n].uvs;r.uvs[n].uvIndices.forEach((function(e,t){a[2*e]=s[2*t],a[2*e+1]=s[2*t+1]}))}t.setAttribute("uv",new e.Float32BufferAttribute(a,2))},parseMorphTargets(t,r){var a=0;for(var n in r.morphTargets){var s=t.attributes.position.array.slice();t.morphAttributes.position||(t.morphAttributes.position=[]);var i=r.morphTargets[n].points,o=r.morphTargets[n].indices,c=r.morphTargets[n].type;o.forEach((function(e,t){"relative"===c?(s[3*e]+=i[3*t],s[3*e+1]+=i[3*t+1],s[3*e+2]+=i[3*t+2]):(s[3*e]=i[3*t],s[3*e+1]=i[3*t+1],s[3*e+2]=i[3*t+2])})),t.morphAttributes.position[a]=new e.Float32BufferAttribute(s,3),t.morphAttributes.position[a].name=n,a++}t.morphTargetsRelative=!1}};var no=function(t){e.Loader.call(this,t)};no.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:no,load:function(t,r,a,n){var s=this,i=""===this.path?e.LoaderUtils.extractUrlBase(t):this.path,o=new e.FileLoader(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(t,(function(e){try{r(s.parse(e,i))}catch(e){n?n(e):console.error(e),s.manager.itemError(t)}}),a,n)},setMaterialOptions:function(e){return this.materialOptions=e,this},parse:function(e,t){for(var r=e.split("\n"),a={},n=/\s+/,s={},i=0;i<r.length;i++){var o=r[i];if(0!==(o=o.trim()).length&&"#"!==o.charAt(0)){var c=o.indexOf(" "),l=c>=0?o.substring(0,c):o;l=l.toLowerCase();var u=c>=0?o.substring(c+1):"";if(u=u.trim(),"newmtl"===l)a={name:u},s[u]=a;else if("ka"===l||"kd"===l||"ks"===l||"ke"===l){var h=u.split(n,3);a[l]=[parseFloat(h[0]),parseFloat(h[1]),parseFloat(h[2])]}else a[l]=u}}var p=new no.MaterialCreator(this.resourcePath||t,this.materialOptions);return p.setCrossOrigin(this.crossOrigin),p.setManager(this.manager),p.setMaterials(s),p}}),(no.MaterialCreator=function(t,r){this.baseUrl=t||"",this.options=r,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.side=this.options&&this.options.side?this.options.side:e.FrontSide,this.wrap=this.options&&this.options.wrap?this.options.wrap:e.RepeatWrapping}).prototype={constructor:no.MaterialCreator,crossOrigin:"anonymous",setCrossOrigin:function(e){return this.crossOrigin=e,this},setManager:function(e){this.manager=e},setMaterials:function(e){this.materialsInfo=this.convert(e),this.materials={},this.materialsArray=[],this.nameLookup={}},convert:function(e){if(!this.options)return e;var t={};for(var r in e){var a=e[r],n={};for(var s in t[r]=n,a){var i=!0,o=a[s],c=s.toLowerCase();switch(c){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(o=[o[0]/255,o[1]/255,o[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===o[0]&&0===o[1]&&0===o[2]&&(i=!1)}i&&(n[c]=o)}}return t},preload:function(){for(var e in this.materialsInfo)this.create(e)},getIndex:function(e){return this.nameLookup[e]},getAsArray:function(){var e=0;for(var t in this.materialsInfo)this.materialsArray[e]=this.create(t),this.nameLookup[t]=e,e++;return this.materialsArray},create:function(e){return void 0===this.materials[e]&&this.createMaterial_(e),this.materials[e]},createMaterial_:function(t){var r=this,a=this.materialsInfo[t],n={name:t,side:this.side};function s(e,t){if(!n[e]){var a=r.getTextureParams(t,n),s=r.loadTexture(function(e,t){return"string"!=typeof t||""===t?"":/^https?:\/\//i.test(t)?t:e+t}(r.baseUrl,a.url));s.repeat.copy(a.scale),s.offset.copy(a.offset),s.wrapS=r.wrap,s.wrapT=r.wrap,n[e]=s}}for(var i in a){var o,c=a[i];if(""!==c)switch(i.toLowerCase()){case"kd":n.color=(new e.Color).fromArray(c);break;case"ks":n.specular=(new e.Color).fromArray(c);break;case"ke":n.emissive=(new e.Color).fromArray(c);break;case"map_kd":s("map",c);break;case"map_ks":s("specularMap",c);break;case"map_ke":s("emissiveMap",c);break;case"norm":s("normalMap",c);break;case"map_bump":case"bump":s("bumpMap",c);break;case"map_d":s("alphaMap",c),n.transparent=!0;break;case"ns":n.shininess=parseFloat(c);break;case"d":(o=parseFloat(c))<1&&(n.opacity=o,n.transparent=!0);break;case"tr":o=parseFloat(c),this.options&&this.options.invertTrProperty&&(o=1-o),o>0&&(n.opacity=1-o,n.transparent=!0)}}return this.materials[t]=new e.MeshPhongMaterial(n),this.materials[t]},getTextureParams:function(t,r){var a,n={scale:new e.Vector2(1,1),offset:new e.Vector2(0,0)},s=t.split(/\s+/);return(a=s.indexOf("-bm"))>=0&&(r.bumpScale=parseFloat(s[a+1]),s.splice(a,2)),(a=s.indexOf("-s"))>=0&&(n.scale.set(parseFloat(s[a+1]),parseFloat(s[a+2])),s.splice(a,4)),(a=s.indexOf("-o"))>=0&&(n.offset.set(parseFloat(s[a+1]),parseFloat(s[a+2])),s.splice(a,4)),n.url=s.join(" ").trim(),n},loadTexture:function(t,r,a,n,s){var i,o=void 0!==this.manager?this.manager:e.DefaultLoadingManager,c=o.getHandler(t);return null===c&&(c=new e.TextureLoader(o)),c.setCrossOrigin&&c.setCrossOrigin(this.crossOrigin),i=c.load(t,a,n,s),void 0!==r&&(i.mapping=r),i}};var so=function(t){e.CompressedTextureLoader.call(this,t)};so.prototype=Object.assign(Object.create(e.CompressedTextureLoader.prototype),{constructor:so,parse:function(t,r){var a={mipmaps:[],width:0,height:0,format:null,mipmapCount:1};function n(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}function s(e,t,r,a){for(var n=r*a*4,s=new Uint8Array(e,t,n),i=new Uint8Array(n),o=0,c=0,l=0;l<a;l++)for(var u=0;u<r;u++){var h=s[c],p=s[++c],f=s[++c],d=s[++c];c++,i[o]=f,i[++o]=p,i[++o]=h,i[++o]=d,o++}return i}var i,o=n("DXT1"),c=n("DXT3"),l=n("DXT5"),u=n("ETC1"),h=new Int32Array(t,0,31);if(542327876!==h[0])return console.error("THREE.DDSLoader.parse: Invalid magic number in DDS header."),a;if(4&!h[20])return console.error("THREE.DDSLoader.parse: Unsupported format, must contain a FourCC code."),a;var p,f=h[21],d=!1;switch(f){case o:i=8,a.format=e.RGB_S3TC_DXT1_Format;break;case c:i=16,a.format=e.RGBA_S3TC_DXT3_Format;break;case l:i=16,a.format=e.RGBA_S3TC_DXT5_Format;break;case u:i=8,a.format=e.RGB_ETC1_Format;break;default:if(!(32===h[22]&&16711680&h[23]&&65280&h[24]&&255&h[25]&&4278190080&h[26]))return console.error("THREE.DDSLoader.parse: Unsupported FourCC code ",(p=f,String.fromCharCode(255&p,p>>8&255,p>>16&255,p>>24&255))),a;d=!0,i=64,a.format=e.RGBAFormat}a.mipmapCount=1,131072&h[2]&&!1!==r&&(a.mipmapCount=Math.max(1,h[7]));var g=h[28];if(a.isCubemap=!!(512&g),a.isCubemap&&(!(1024&g)||!(2048&g)||!(4096&g)||!(8192&g)||!(16384&g)||!(32768&g)))return console.error("THREE.DDSLoader.parse: Incomplete cubemap faces"),a;a.width=h[4],a.height=h[3];for(var m=h[1]+4,v=a.isCubemap?6:1,y=0;y<v;y++)for(var A=a.width,b=a.height,B=0;B<a.mipmapCount;B++){if(d)var C=(x=s(t,m,A,b)).length;else{C=Math.max(4,A)/4*Math.max(4,b)/4*i;var x=new Uint8Array(t,m,C)}var F={data:x,width:A,height:b};a.mipmaps.push(F),m+=C,A=Math.max(A>>1,1),b=Math.max(b>>1,1)}return a}});var io=function(){var t=/^[og]\s*(.+)?/,r=/^mtllib /,a=/^usemtl /,n=/^usemap /,s=new e.Vector3,i=new e.Vector3,o=new e.Vector3,c=new e.Vector3,l=new e.Vector3;function u(){var e={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(e,t){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=e,void(this.object.fromDeclaration=!1!==t);var r=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:e||"",fromDeclaration:!1!==t,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(e,t){var r=this._finalize(!1);r&&(r.inherited||r.groupCount<=0)&&this.materials.splice(r.index,1);var a={index:this.materials.length,name:e||"",mtllib:Array.isArray(t)&&t.length>0?t[t.length-1]:"",smooth:void 0!==r?r.smooth:this.smooth,groupStart:void 0!==r?r.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(e){var t={index:"number"==typeof e?e:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return t.clone=this.clone.bind(t),t}};return this.materials.push(a),a},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(e){var t=this.currentMaterial();if(t&&-1===t.groupEnd&&(t.groupEnd=this.geometry.vertices.length/3,t.groupCount=t.groupEnd-t.groupStart,t.inherited=!1),e&&this.materials.length>1)for(var r=this.materials.length-1;r>=0;r--)this.materials[r].groupCount<=0&&this.materials.splice(r,1);return e&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),t}},r&&r.name&&"function"==typeof r.clone){var a=r.clone(0);a.inherited=!0,this.object.materials.push(a)}this.objects.push(this.object)},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(e,t){var r=parseInt(e,10);return 3*(r>=0?r-1:r+t/3)},parseNormalIndex:function(e,t){var r=parseInt(e,10);return 3*(r>=0?r-1:r+t/3)},parseUVIndex:function(e,t){var r=parseInt(e,10);return 2*(r>=0?r-1:r+t/2)},addVertex:function(e,t,r){var a=this.vertices,n=this.object.geometry.vertices;n.push(a[e+0],a[e+1],a[e+2]),n.push(a[t+0],a[t+1],a[t+2]),n.push(a[r+0],a[r+1],a[r+2])},addVertexPoint:function(e){var t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addVertexLine:function(e){var t=this.vertices;this.object.geometry.vertices.push(t[e+0],t[e+1],t[e+2])},addNormal:function(e,t,r){var a=this.normals,n=this.object.geometry.normals;n.push(a[e+0],a[e+1],a[e+2]),n.push(a[t+0],a[t+1],a[t+2]),n.push(a[r+0],a[r+1],a[r+2])},addFaceNormal:function(e,t,r){var a=this.vertices,n=this.object.geometry.normals;s.fromArray(a,e),i.fromArray(a,t),o.fromArray(a,r),l.subVectors(o,i),c.subVectors(s,i),l.cross(c),l.normalize(),n.push(l.x,l.y,l.z),n.push(l.x,l.y,l.z),n.push(l.x,l.y,l.z)},addColor:function(e,t,r){var a=this.colors,n=this.object.geometry.colors;void 0!==a[e]&&n.push(a[e+0],a[e+1],a[e+2]),void 0!==a[t]&&n.push(a[t+0],a[t+1],a[t+2]),void 0!==a[r]&&n.push(a[r+0],a[r+1],a[r+2])},addUV:function(e,t,r){var a=this.uvs,n=this.object.geometry.uvs;n.push(a[e+0],a[e+1]),n.push(a[t+0],a[t+1]),n.push(a[r+0],a[r+1])},addDefaultUV:function(){var e=this.object.geometry.uvs;e.push(0,0),e.push(0,0),e.push(0,0)},addUVLine:function(e){var t=this.uvs;this.object.geometry.uvs.push(t[e+0],t[e+1])},addFace:function(e,t,r,a,n,s,i,o,c){var l=this.vertices.length,u=this.parseVertexIndex(e,l),h=this.parseVertexIndex(t,l),p=this.parseVertexIndex(r,l);if(this.addVertex(u,h,p),this.addColor(u,h,p),void 0!==i&&""!==i){var f=this.normals.length;u=this.parseNormalIndex(i,f),h=this.parseNormalIndex(o,f),p=this.parseNormalIndex(c,f),this.addNormal(u,h,p)}else this.addFaceNormal(u,h,p);if(void 0!==a&&""!==a){var d=this.uvs.length;u=this.parseUVIndex(a,d),h=this.parseUVIndex(n,d),p=this.parseUVIndex(s,d),this.addUV(u,h,p),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(e){this.object.geometry.type="Points";for(var t=this.vertices.length,r=0,a=e.length;r<a;r++){var n=this.parseVertexIndex(e[r],t);this.addVertexPoint(n),this.addColor(n)}},addLineGeometry:function(e,t){this.object.geometry.type="Line";for(var r=this.vertices.length,a=this.uvs.length,n=0,s=e.length;n<s;n++)this.addVertexLine(this.parseVertexIndex(e[n],r));var i=0;for(s=t.length;i<s;i++)this.addUVLine(this.parseUVIndex(t[i],a))}};return e.startObject("",!1),e}function h(t){e.Loader.call(this,t),this.materials=null}return h.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:h,load:function(t,r,a,n){var s=this,i=new e.FileLoader(this.manager);i.setPath(this.path),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials),i.load(t,(function(e){try{r(s.parse(e))}catch(e){n?n(e):console.error(e),s.manager.itemError(t)}}),a,n)},setMaterials:function(e){return this.materials=e,this},parse:function(s){var i=new u;-1!==s.indexOf("\r\n")&&(s=s.replace(/\r\n/g,"\n")),-1!==s.indexOf("\\\n")&&(s=s.replace(/\\\n/g,""));for(var o=s.split("\n"),c="",l="",h=[],p="function"==typeof"".trimLeft,f=0,d=o.length;f<d;f++)if(c=o[f],0!==(c=p?c.trimLeft():c.trim()).length&&"#"!==(l=c.charAt(0)))if("v"===l){var g=c.split(/\s+/);switch(g[0]){case"v":i.vertices.push(parseFloat(g[1]),parseFloat(g[2]),parseFloat(g[3])),g.length>=7?i.colors.push(parseFloat(g[4]),parseFloat(g[5]),parseFloat(g[6])):i.colors.push(void 0,void 0,void 0);break;case"vn":i.normals.push(parseFloat(g[1]),parseFloat(g[2]),parseFloat(g[3]));break;case"vt":i.uvs.push(parseFloat(g[1]),parseFloat(g[2]))}}else if("f"===l){for(var m=c.substr(1).trim().split(/\s+/),v=[],y=0,A=m.length;y<A;y++){var b=m[y];if(b.length>0){var B=b.split("/");v.push(B)}}var C=v[0];for(y=1,A=v.length-1;y<A;y++){var x=v[y],F=v[y+1];i.addFace(C[0],x[0],F[0],C[1],x[1],F[1],C[2],x[2],F[2])}}else if("l"===l){var w=c.substring(1).trim().split(" "),E=[],S=[];if(-1===c.indexOf("/"))E=w;else for(var I=0,M=w.length;I<M;I++){var T=w[I].split("/");""!==T[0]&&E.push(T[0]),""!==T[1]&&S.push(T[1])}i.addLineGeometry(E,S)}else if("p"===l){var k=c.substr(1).trim().split(" ");i.addPointGeometry(k)}else if(null!==(h=t.exec(c))){var R=(" "+h[0].substr(1).trim()).substr(1);i.startObject(R)}else if(a.test(c))i.object.startMaterial(c.substring(7).trim(),i.materialLibraries);else if(r.test(c))i.materialLibraries.push(c.substring(7).trim());else if(n.test(c))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if("s"===l){if((h=c.split(" ")).length>1){var L=h[1].trim().toLowerCase();i.object.smooth="0"!==L&&"off"!==L}else i.object.smooth=!0;(K=i.object.currentMaterial())&&(K.smooth=i.object.smooth)}else{if("\0"===c)continue;console.warn('THREE.OBJLoader: Unexpected line: "'+c+'"')}i.finalize();var D=new e.Group;if(D.materialLibraries=[].concat(i.materialLibraries),!0===!(1===i.objects.length&&0===i.objects[0].geometry.vertices.length))for(f=0,d=i.objects.length;f<d;f++){var O=i.objects[f],U=O.geometry,G=O.materials,N="Line"===U.type,P="Points"===U.type,H=!1;if(0!==U.vertices.length){(Q=new e.BufferGeometry).setAttribute("position",new e.Float32BufferAttribute(U.vertices,3)),U.normals.length>0&&Q.setAttribute("normal",new e.Float32BufferAttribute(U.normals,3)),U.colors.length>0&&(H=!0,Q.setAttribute("color",new e.Float32BufferAttribute(U.colors,3))),!0===U.hasUVIndices&&Q.setAttribute("uv",new e.Float32BufferAttribute(U.uvs,2));for(var J,_=[],j=0,V=G.length;j<V;j++){var X=(Y=G[j]).name+"_"+Y.smooth+"_"+H,K=i.materials[X];if(null!==this.materials)if(K=this.materials.create(Y.name),!N||!K||K instanceof e.LineBasicMaterial){if(P&&K&&!(K instanceof e.PointsMaterial)){var z=new e.PointsMaterial({size:10,sizeAttenuation:!1});e.Material.prototype.copy.call(z,K),z.color.copy(K.color),z.map=K.map,K=z}}else{var W=new e.LineBasicMaterial;e.Material.prototype.copy.call(W,K),W.color.copy(K.color),K=W}void 0===K&&((K=N?new e.LineBasicMaterial:P?new e.PointsMaterial({size:1,sizeAttenuation:!1}):new e.MeshPhongMaterial).name=Y.name,K.flatShading=!Y.smooth,K.vertexColors=H,i.materials[X]=K),_.push(K)}if(_.length>1){for(j=0,V=G.length;j<V;j++){var Y=G[j];Q.addGroup(Y.groupStart,Y.groupCount,j)}J=N?new e.LineSegments(Q,_):P?new e.Points(Q,_):new e.Mesh(Q,_)}else J=N?new e.LineSegments(Q,_[0]):P?new e.Points(Q,_[0]):new e.Mesh(Q,_[0]);J.name=O.name,D.add(J)}}else if(i.vertices.length>0){var Q;K=new e.PointsMaterial({size:1,sizeAttenuation:!1});(Q=new e.BufferGeometry).setAttribute("position",new e.Float32BufferAttribute(i.vertices,3)),i.colors.length>0&&void 0!==i.colors[0]&&(Q.setAttribute("color",new e.Float32BufferAttribute(i.colors,3)),K.vertexColors=!0);var q=new e.Points(Q,K);D.add(q)}return D}}),h}();var oo=function(t){e.DataTextureLoader.call(this,t),this.type=e.FloatType};oo.prototype=Object.assign(Object.create(e.DataTextureLoader.prototype),{constructor:oo,parse:function(t){const r=65536,a=14,n=65537,s=16384,i=Math.pow(2.7182818,2.2);var o=new DataView(new ArrayBuffer(8));function c(e){if(0===e)return[e,0];o.setFloat64(0,e);var t=o.getUint32(0)>>>20&2047;0===t&&(o.setFloat64(0,e*Math.pow(2,64)),t=(o.getUint32(0)>>>20&2047)-64);var r=t-1022;return[function(e,t){for(var r=Math.min(3,Math.ceil(Math.abs(t)/1023)),a=e,n=0;n<r;n++)a*=Math.pow(2,Math.floor((t+n)/r));return a}(e,-r),r]}const l={l:0,c:0,lc:0};function u(e,t,r,a,n){for(;r<e;)t=t<<8|J(a,n),r+=8;r-=e,l.l=t>>r&(1<<e)-1,l.c=t,l.lc=r}const h=new Array(59);function p(e,t,r,a,s,i,o){for(var c=r,p=0,f=0;s<=i;s++){if(c.value-r.value>a)return!1;u(6,p,f,e,c);var d=l.l;if(p=l.c,f=l.lc,o[s]=d,63==d){if(c.value-r.value>a)throw"Something wrong with hufUnpackEncTable";u(8,p,f,e,c);var g=l.l+6;if(p=l.c,f=l.lc,s+g>i+1)throw"Something wrong with hufUnpackEncTable";for(;g--;)o[s++]=0;s--}else if(d>=59){if(s+(g=d-59+2)>i+1)throw"Something wrong with hufUnpackEncTable";for(;g--;)o[s++]=0;s--}}!function(e){for(var t=0;t<=58;++t)h[t]=0;for(t=0;t<n;++t)h[e[t]]+=1;var r=0;for(t=58;t>0;--t){var a=r+h[t]>>1;h[t]=r,r=a}for(t=0;t<n;++t){var s=e[t];s>0&&(e[t]=s|h[s]++<<6)}}(o)}function f(e){return 63&e}function d(e){return e>>6}const g={c:0,lc:0};function m(e,t,r,a){e=e<<8|J(r,a),t+=8,g.c=e,g.lc=t}const v={c:0,lc:0};function y(e,t,r,a,n,s,i,o,c,l){if(e==t){a<8&&(m(r,a,n,i),r=g.c,a=g.lc);var u=r>>(a-=8);u=new Uint8Array([u])[0];if(c.value+u>l)return!1;for(var h=o[c.value-1];u-- >0;)o[c.value++]=h}else{if(!(c.value<l))return!1;o[c.value++]=e}v.c=r,v.lc=a}function A(e){return 65535&e}function b(e){var t=A(e);return t>32767?t-65536:t}const B={a:0,b:0};function C(e,t){var r=b(e),a=b(t),n=r+(1&a)+(a>>1),s=n,i=n-a;B.a=s,B.b=i}function x(e,t){var r=A(e),a=A(t),n=r-(a>>1)&65535,s=a+n-32768&65535;B.a=s,B.b=n}function F(e,t,r,a,n,s,i){for(var o,c=i<16384,l=r>n?n:r,u=1;u<=l;)u<<=1;for(o=u>>=1,u>>=1;u>=1;){for(var h,p,f,d,g=0,m=g+s*(n-o),v=s*u,y=s*o,A=a*u,b=a*o;g<=m;g+=y){for(var F=g,w=g+a*(r-o);F<=w;F+=b){var E=F+A,S=(I=F+v)+A;c?(C(e[F+t],e[I+t]),h=B.a,f=B.b,C(e[E+t],e[S+t]),p=B.a,d=B.b,C(h,p),e[F+t]=B.a,e[E+t]=B.b,C(f,d),e[I+t]=B.a,e[S+t]=B.b):(x(e[F+t],e[I+t]),h=B.a,f=B.b,x(e[E+t],e[S+t]),p=B.a,d=B.b,x(h,p),e[F+t]=B.a,e[E+t]=B.b,x(f,d),e[I+t]=B.a,e[S+t]=B.b)}if(r&u){var I=F+v;c?C(e[F+t],e[I+t]):x(e[F+t],e[I+t]),h=B.a,e[I+t]=B.b,e[F+t]=h}}if(n&u)for(F=g,w=g+a*(r-o);F<=w;F+=b){E=F+A;c?C(e[F+t],e[E+t]):x(e[F+t],e[E+t]),h=B.a,e[E+t]=B.b,e[F+t]=h}o=u,u>>=1}return g}function w(e,t,r,i,o,c){var l=r.value,u=H(t,r),h=H(t,r);r.value+=4;var A=H(t,r);if(r.value+=4,u<0||u>=n||h<0||h>=n)throw"Something wrong with HUF_ENCSIZE";var b=new Array(n),B=new Array(s);if(function(e){for(var t=0;t<s;t++)e[t]={},e[t].len=0,e[t].lit=0,e[t].p=null}(B),p(e,0,r,i-(r.value-l),u,h,b),A>8*(i-(r.value-l)))throw"Something wrong with hufUncompress";!function(e,t,r,n){for(;t<=r;t++){var s=d(e[t]),i=f(e[t]);if(s>>i)throw"Invalid table entry";if(i>a){if((u=n[s>>i-a]).len)throw"Invalid table entry";if(u.lit++,u.p){var o=u.p;u.p=new Array(u.lit);for(var c=0;c<u.lit-1;++c)u.p[c]=o[c]}else u.p=new Array(1);u.p[u.lit-1]=t}else if(i){var l=0;for(c=1<<a-i;c>0;c--){var u;if((u=n[(s<<a-i)+l]).len||u.p)throw"Invalid table entry";u.len=i,u.lit=t,l++}}}}(b,u,h,B),function(e,t,r,n,s,i,o,c,l,u){for(var h=0,p=0,A=c,b=Math.trunc(s.value+(i+7)/8);s.value<b;)for(m(h,p,r,s),h=g.c,p=g.lc;p>=a;)if((F=t[h>>p-a&16383]).len)p-=F.len,y(F.lit,o,h,p,r,0,s,l,u,A),h=v.c,p=v.lc;else{if(!F.p)throw"hufDecode issues";var B;for(B=0;B<F.lit;B++){for(var C=f(e[F.p[B]]);p<C&&s.value<b;)m(h,p,r,s),h=g.c,p=g.lc;if(p>=C&&d(e[F.p[B]])==(h>>p-C&(1<<C)-1)){p-=C,y(F.p[B],o,h,p,r,0,s,l,u,A),h=v.c,p=v.lc;break}}if(B==F.lit)throw"hufDecode issues"}var x=8-i&7;for(h>>=x,p-=x;p>0;){var F;if(!(F=t[h<<a-p&16383]).len)throw"hufDecode issues";p-=F.len,y(F.lit,o,h,p,r,0,s,l,u,A),h=v.c,p=v.lc}}(b,B,e,0,r,A,h,c,o,{value:0})}function E(e){for(var t=1;t<e.length;t++){var r=e[t-1]+e[t]-128;e[t]=r}}function S(e,t){for(var r=0,a=Math.floor((e.length+1)/2),n=0,s=e.length-1;!(n>s||(t[n++]=e[r++],n>s));)t[n++]=e[a++]}function I(e){for(var t=e.byteLength,r=new Array,a=0,n=new DataView(e);t>0;){var s=n.getInt8(a++);if(s<0){t-=(o=-s)+1;for(var i=0;i<o;i++)r.push(n.getUint8(a++))}else{var o=s;t-=2;var c=n.getUint8(a++);for(i=0;i<o+1;i++)r.push(c)}}return r}function M(e,t,r){for(var a,n=1;n<64;)65280==(a=t[e.value])?n=64:a>>8==255?n+=255&a:(r[n]=a,n++),e.value++}function T(e,t){t[0]=X(e[0]),t[1]=X(e[1]),t[2]=X(e[5]),t[3]=X(e[6]),t[4]=X(e[14]),t[5]=X(e[15]),t[6]=X(e[27]),t[7]=X(e[28]),t[8]=X(e[2]),t[9]=X(e[4]),t[10]=X(e[7]),t[11]=X(e[13]),t[12]=X(e[16]),t[13]=X(e[26]),t[14]=X(e[29]),t[15]=X(e[42]),t[16]=X(e[3]),t[17]=X(e[8]),t[18]=X(e[12]),t[19]=X(e[17]),t[20]=X(e[25]),t[21]=X(e[30]),t[22]=X(e[41]),t[23]=X(e[43]),t[24]=X(e[9]),t[25]=X(e[11]),t[26]=X(e[18]),t[27]=X(e[24]),t[28]=X(e[31]),t[29]=X(e[40]),t[30]=X(e[44]),t[31]=X(e[53]),t[32]=X(e[10]),t[33]=X(e[19]),t[34]=X(e[23]),t[35]=X(e[32]),t[36]=X(e[39]),t[37]=X(e[45]),t[38]=X(e[52]),t[39]=X(e[54]),t[40]=X(e[20]),t[41]=X(e[22]),t[42]=X(e[33]),t[43]=X(e[38]),t[44]=X(e[46]),t[45]=X(e[51]),t[46]=X(e[55]),t[47]=X(e[60]),t[48]=X(e[21]),t[49]=X(e[34]),t[50]=X(e[37]),t[51]=X(e[47]),t[52]=X(e[50]),t[53]=X(e[56]),t[54]=X(e[59]),t[55]=X(e[61]),t[56]=X(e[35]),t[57]=X(e[36]),t[58]=X(e[48]),t[59]=X(e[49]),t[60]=X(e[57]),t[61]=X(e[58]),t[62]=X(e[62]),t[63]=X(e[63])}function k(e){const t=.5*Math.cos(.7853975),r=.5*Math.cos(3.14159/16),a=.5*Math.cos(3.14159/8),n=.5*Math.cos(3*3.14159/16),s=.5*Math.cos(.981746875),i=.5*Math.cos(3*3.14159/8),o=.5*Math.cos(1.374445625);for(var c=new Array(4),l=new Array(4),u=new Array(4),h=new Array(4),p=0;p<8;++p){var f=8*p;c[0]=a*e[f+2],c[1]=i*e[f+2],c[2]=a*e[f+6],c[3]=i*e[f+6],l[0]=r*e[f+1]+n*e[f+3]+s*e[f+5]+o*e[f+7],l[1]=n*e[f+1]-o*e[f+3]-r*e[f+5]-s*e[f+7],l[2]=s*e[f+1]-r*e[f+3]+o*e[f+5]+n*e[f+7],l[3]=o*e[f+1]-s*e[f+3]+n*e[f+5]-r*e[f+7],u[0]=t*(e[f+0]+e[f+4]),u[3]=t*(e[f+0]-e[f+4]),u[1]=c[0]+c[3],u[2]=c[1]-c[2],h[0]=u[0]+u[1],h[1]=u[3]+u[2],h[2]=u[3]-u[2],h[3]=u[0]-u[1],e[f+0]=h[0]+l[0],e[f+1]=h[1]+l[1],e[f+2]=h[2]+l[2],e[f+3]=h[3]+l[3],e[f+4]=h[3]-l[3],e[f+5]=h[2]-l[2],e[f+6]=h[1]-l[1],e[f+7]=h[0]-l[0]}for(var d=0;d<8;++d)c[0]=a*e[16+d],c[1]=i*e[16+d],c[2]=a*e[48+d],c[3]=i*e[48+d],l[0]=r*e[8+d]+n*e[24+d]+s*e[40+d]+o*e[56+d],l[1]=n*e[8+d]-o*e[24+d]-r*e[40+d]-s*e[56+d],l[2]=s*e[8+d]-r*e[24+d]+o*e[40+d]+n*e[56+d],l[3]=o*e[8+d]-s*e[24+d]+n*e[40+d]-r*e[56+d],u[0]=t*(e[d]+e[32+d]),u[3]=t*(e[d]-e[32+d]),u[1]=c[0]+c[3],u[2]=c[1]-c[2],h[0]=u[0]+u[1],h[1]=u[3]+u[2],h[2]=u[3]-u[2],h[3]=u[0]-u[1],e[0+d]=h[0]+l[0],e[8+d]=h[1]+l[1],e[16+d]=h[2]+l[2],e[24+d]=h[3]+l[3],e[32+d]=h[3]-l[3],e[40+d]=h[2]-l[2],e[48+d]=h[1]-l[1],e[56+d]=h[0]-l[0]}function R(e){for(var t=0;t<64;++t){var r=e[0][t],a=e[1][t],n=e[2][t];e[0][t]=r+1.5747*n,e[1][t]=r-.1873*a-.4682*n,e[2][t]=r+1.8556*a}}function L(t,r,a){for(var n=0;n<64;++n)r[a+n]=e.DataUtils.toHalfFloat(D(t[n]))}function D(e){return e<=1?Math.sign(e)*Math.pow(Math.abs(e),2.2):Math.sign(e)*Math.pow(i,Math.abs(e)-1)}function O(e){var t=e.array.slice(e.offset.value,e.offset.value+e.size);void 0===Ji&&console.error("THREE.EXRLoader: External library fflate.min.js required.");var r=di(t),a=new Uint8Array(r.length);return E(r),S(r,a),new DataView(a.buffer)}function U(e){var t=e.viewer,r={value:e.offset.value},a=new Uint8Array(e.width*e.lines*(Q.channels.length*e.type*2)),n={version:j(t,r),unknownUncompressedSize:j(t,r),unknownCompressedSize:j(t,r),acCompressedSize:j(t,r),dcCompressedSize:j(t,r),rleCompressedSize:j(t,r),rleUncompressedSize:j(t,r),rleRawSize:j(t,r),totalAcUncompressedCount:j(t,r),totalDcUncompressedCount:j(t,r),acCompression:j(t,r)};if(n.version<2)throw"EXRLoader.parse: "+Q.compression+" version "+n.version+" is unsupported";for(var s=new Array,i=K(t,r)-2;i>0;){var o=G(t.buffer,r),c=_(t,r),l=c>>2&3,u=new Int8Array([(c>>4)-1])[0],h=_(t,r);s.push({name:o,index:u,type:h,compression:l}),i-=o.length+3}for(var p=Q.channels,f=new Array(e.channels),d=0;d<e.channels;++d){var g=f[d]={},m=p[d];g.name=m.name,g.compression=0,g.decoded=!1,g.type=m.pixelType,g.pLinear=m.pLinear,g.width=e.width,g.height=e.lines}for(var v={idx:new Array(3)},y=0;y<e.channels;++y)for(g=f[y],d=0;d<s.length;++d){var A=s[d];g.name==A.name&&(g.compression=A.compression,A.index>=0&&(v.idx[A.index]=y),g.offset=y)}if(n.acCompressedSize>0)switch(n.acCompression){case 0:var b=new Uint16Array(n.totalAcUncompressedCount);w(e.array,t,r,n.acCompressedSize,b,n.totalAcUncompressedCount);break;case 1:var B=di(e.array.slice(r.value,r.value+n.totalAcUncompressedCount));b=new Uint16Array(B.buffer);r.value+=n.totalAcUncompressedCount}if(n.dcCompressedSize>0){var C={array:e.array,offset:r,size:n.dcCompressedSize},x=new Uint16Array(O(C).buffer);r.value+=n.dcCompressedSize}if(n.rleRawSize>0){var F=I((B=di(e.array.slice(r.value,r.value+n.rleCompressedSize))).buffer);r.value+=n.rleCompressedSize}var E=0,S=new Array(f.length);for(d=0;d<S.length;++d)S[d]=new Array;for(var D=0;D<e.lines;++D)for(var U=0;U<f.length;++U)S[U].push(E),E+=f[U].width*e.type*2;!function(e,t,r,a,n,s){var i=new DataView(s.buffer),o=r[e.idx[0]].width,c=r[e.idx[0]].height,l=Math.floor(o/8),u=Math.ceil(o/8),h=Math.ceil(c/8),p=o-8*(u-1),f=c-8*(h-1),d={value:0},g=new Array(3),m=new Array(3),v=new Array(3),y=new Array(3),A=new Array(3);for(let r=0;r<3;++r)A[r]=t[e.idx[r]],g[r]=r<1?0:g[r-1]+u*h,m[r]=new Float32Array(64),v[r]=new Uint16Array(64),y[r]=new Uint16Array(64*u);for(let t=0;t<h;++t){var b=8;t==h-1&&(b=f);var B=8;for(let e=0;e<u;++e){e==u-1&&(B=p);for(let e=0;e<3;++e)v[e].fill(0),v[e][0]=n[g[e]++],M(d,a,v[e]),T(v[e],m[e]),k(m[e]);R(m);for(let t=0;t<3;++t)L(m[t],y[t],64*e)}let s=0;for(let a=0;a<3;++a){const n=r[e.idx[a]].type;for(let e=8*t;e<8*t+b;++e){s=A[a][e];for(let t=0;t<l;++t){const r=64*t+8*(7&e);i.setUint16(s+0*n,y[a][r+0],!0),i.setUint16(s+2*n,y[a][r+1],!0),i.setUint16(s+4*n,y[a][r+2],!0),i.setUint16(s+6*n,y[a][r+3],!0),i.setUint16(s+8*n,y[a][r+4],!0),i.setUint16(s+10*n,y[a][r+5],!0),i.setUint16(s+12*n,y[a][r+6],!0),i.setUint16(s+14*n,y[a][r+7],!0),s+=16*n}}if(l!=u)for(let e=8*t;e<8*t+b;++e){const t=A[a][e]+8*l*2*n,r=64*l+8*(7&e);for(let e=0;e<B;++e)i.setUint16(t+2*e*n,y[a][r+e],!0)}}}for(var C=new Uint16Array(o),x=(i=new DataView(s.buffer),0);x<3;++x){r[e.idx[x]].decoded=!0;var F=r[e.idx[x]].type;if(2==r[x].type)for(var w=0;w<c;++w){const e=A[x][w];for(var E=0;E<o;++E)C[E]=i.getUint16(e+2*E*F,!0);for(E=0;E<o;++E)i.setFloat32(e+2*E*F,X(C[E]),!0)}}}(v,S,f,b,x,a);for(d=0;d<f.length;++d){if(!(g=f[d]).decoded)switch(g.compression){case 2:var N=0,P=0;for(D=0;D<e.lines;++D){for(var H=S[d][N],J=0;J<g.width;++J){for(var V=0;V<2*g.type;++V)a[H++]=F[P+V*g.width*g.height];P++}N++}break;case 1:default:throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(a.buffer)}function G(t,r){for(var a=new Uint8Array(t),n=0;0!=a[r.value+n];)n+=1;var s=(new e.$TextDecoder).decode(a.slice(r.value,r.value+n));return r.value=r.value+n+1,s}function N(e,t){var r=e.getUint32(0,!0);return t.value=t.value+8,r}function P(e,t){var r=e.getInt32(t.value,!0);return t.value=t.value+4,r}function H(e,t){var r=e.getUint32(t.value,!0);return t.value=t.value+4,r}function J(e,t){var r=e[t.value];return t.value=t.value+1,r}function _(e,t){var r=e.getUint8(t.value);return t.value=t.value+1,r}function j(e,t){var r=Number(e.getBigInt64(t.value,!0));return t.value+=8,r}function V(e,t){var r=e.getFloat32(t.value,!0);return t.value+=4,r}function X(e){var t=(31744&e)>>10,r=1023&e;return(e>>15?-1:1)*(t?31===t?r?NaN:1/0:Math.pow(2,t-15)*(1+r/1024):r/1024*6103515625e-14)}function K(e,t){var r=e.getUint16(t.value,!0);return t.value+=2,r}function z(t,r,a,n,s){return"string"===n||"stringvector"===n||"iccProfile"===n?function(t,r,a){var n=(new e.$TextDecoder).decode(new Uint8Array(t).slice(r.value,r.value+a));return r.value=r.value+a,n}(r,a,s):"chlist"===n?function(e,t,r,a){for(var n=r.value,s=[];r.value<n+a-1;){var i=G(t,r),o=P(e,r),c=_(e,r);r.value+=3;var l=P(e,r),u=P(e,r);s.push({name:i,pixelType:o,pLinear:c,xSampling:l,ySampling:u})}return r.value+=1,s}(t,r,a,s):"chromaticities"===n?function(e,t){return{redX:V(e,t),redY:V(e,t),greenX:V(e,t),greenY:V(e,t),blueX:V(e,t),blueY:V(e,t),whiteX:V(e,t),whiteY:V(e,t)}}(t,a):"compression"===n?function(e,t){return["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"][_(e,t)]}(t,a):"box2i"===n?function(e,t){return{xMin:H(e,t),yMin:H(e,t),xMax:H(e,t),yMax:H(e,t)}}(t,a):"lineOrder"===n?function(e,t){return["INCREASING_Y"][_(e,t)]}(t,a):"float"===n?V(t,a):"v2f"===n?function(e,t){return[V(e,t),V(e,t)]}(t,a):"v3f"===n?function(e,t){return[V(e,t),V(e,t),V(e,t)]}(t,a):"int"===n?P(t,a):"rational"===n?function(e,t){return[P(e,t),H(e,t)]}(t,a):"timecode"===n?function(e,t){return[H(e,t),H(e,t)]}(t,a):"preview"===n?(a.value+=s,"skipped"):void(a.value+=s)}var W=new DataView(t),Y=new Uint8Array(t),Q={};W.getUint32(0,!0),W.getUint8(4,!0),W.getUint8(5,!0);for(var q={value:8},Z=!0;Z;){var $=G(t,q);if(0==$)Z=!1;else{var ee=G(t,q),te=z(W,t,q,ee,H(W,q));void 0===te?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${ee}'.`):Q[$]=te}}var re,ae,ne,se,ie=Q.dataWindow.yMax+1;switch(Q.compression){case"NO_COMPRESSION":ae=1,re=function(e){return new DataView(e.array.buffer,e.offset.value,e.size)};break;case"RLE_COMPRESSION":ae=1,re=function(e){var t=e.viewer.buffer.slice(e.offset.value,e.offset.value+e.size),r=new Uint8Array(I(t)),a=new Uint8Array(r.length);return E(r),S(r,a),new DataView(a.buffer)};break;case"ZIPS_COMPRESSION":ae=1,re=O;break;case"ZIP_COMPRESSION":ae=16,re=O;break;case"PIZ_COMPRESSION":ae=32,re=function(e){for(var t=e.viewer,a={value:e.offset.value},n=e.width*ae*(Q.channels.length*e.type),s=new Uint16Array(n),i=new Uint8Array(8192),o=0,c=new Array(e.channels),l=0;l<e.channels;l++)c[l]={},c[l].start=o,c[l].end=c[l].start,c[l].nx=e.width,c[l].ny=e.lines,c[l].size=e.type,o+=c[l].nx*c[l].ny*c[l].size;var u=K(t,a),h=K(t,a);if(h>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(u<=h)for(l=0;l<h-u+1;l++)i[l+u]=_(t,a);var p=new Uint16Array(r),f=function(e,t){for(var a=0,n=0;n<r;++n)(0==n||e[n>>3]&1<<(7&n))&&(t[a++]=n);for(var s=a-1;a<r;)t[a++]=0;return s}(i,p),d=H(t,a);for(w(e.array,t,a,d,s,o),l=0;l<e.channels;++l)for(var g=c[l],m=0;m<c[l].size;++m)F(s,g.start+m,g.nx,g.size,g.ny,g.nx*g.size,f);!function(e,t,r){for(var a=0;a<r;++a)t[a]=e[t[a]]}(p,s,o);for(var v=0,y=new Uint8Array(s.buffer.byteLength),A=0;A<e.lines;A++)for(var b=0;b<e.channels;b++){var B=(g=c[b]).nx*g.size,C=new Uint8Array(s.buffer,2*g.end,2*B);y.set(C,v),v+=2*B,g.end+=B}return new DataView(y.buffer)};break;case"PXR24_COMPRESSION":ae=16,re=function(e){var t=e.array.slice(e.offset.value,e.offset.value+e.size);void 0===Ji&&console.error("THREE.EXRLoader: External library fflate.min.js required.");var r=di(t);const a=e.lines*e.channels*e.width,n=1==e.type?new Uint16Array(a):new Uint32Array(a);let s=0,i=0;const o=new Array(4);for(let t=0;t<e.lines;t++)for(let t=0;t<e.channels;t++){let t=0;switch(e.type){case 1:o[0]=s,o[1]=o[0]+e.width,s=o[1]+e.width;for(let a=0;a<e.width;++a)t+=r[o[0]++]<<8|r[o[1]++],n[i]=t,i++;break;case 2:o[0]=s,o[1]=o[0]+e.width,o[2]=o[1]+e.width,s=o[2]+e.width;for(let a=0;a<e.width;++a)t+=r[o[0]++]<<24|r[o[1]++]<<16|r[o[2]++]<<8,n[i]=t,i++}}return new DataView(n.buffer)};break;case"DWAA_COMPRESSION":ae=32,re=U;break;case"DWAB_COMPRESSION":ae=256,re=U;break;default:throw"EXRLoader.parse: "+Q.compression+" is unsupported"}var oe=Q.channels[0].pixelType;if(1===oe)switch(this.type){case e.UnsignedByteType:case e.FloatType:se=function(e,t){return X(K(e,t))},ne=2;break;case e.HalfFloatType:se=K,ne=2}else{if(2!==oe)throw"EXRLoader.parse: unsupported pixelType "+oe+" for "+Q.compression+".";switch(this.type){case e.UnsignedByteType:case e.FloatType:se=V,ne=4;break;case e.HalfFloatType:se=function(t,r){return e.DataUtils.toHalfFloat(V(t,r))},ne=4}}for(var ce=ie/ae,le=0;le<ce;le++)N(W,q);var ue=Q.dataWindow.xMax-Q.dataWindow.xMin+1,he=Q.dataWindow.yMax-Q.dataWindow.yMin+1,pe=ue*he*4;switch(this.type){case e.UnsignedByteType:case e.FloatType:var fe=new Float32Array(pe);Q.channels.length<4&&fe.fill(1,0,pe);break;case e.HalfFloatType:fe=new Uint16Array(pe);Q.channels.length<4&&fe.fill(15360,0,pe);break;default:console.error("THREE.EXRLoader: unsupported type: ",this.type)}for(var de,ge,me={R:0,G:1,B:2,A:3},ve={size:0,width:ue,lines:ae,offset:q,array:Y,viewer:W,type:oe,channels:Q.channels.length},ye={value:0},Ae=0;Ae<he/ae;Ae++){de=H(W,q),pe=H(W,q),ve.lines=de+ae>he?he-de:ae,ve.offset=q,ve.size=pe,ge=re(ve),q.value+=pe;for(var be=0;be<ae;be++){var Be=be+Ae*ae;if(Be>=he)break;for(var Ce=0;Ce<Q.channels.length;Ce++)for(var xe=me[Q.channels[Ce].name],Fe=0;Fe<ue;Fe++){var we=be*(Q.channels.length*ue)+Ce*ue+Fe;ye.value=we*ne;var Ee=se(ge,ye);fe[4*ue*(he-1-Be)+4*Fe+xe]=Ee}}}if(this.type===e.UnsignedByteType){let e,t;const r=fe.length,a=new Uint8Array(r);for(let r=0;r<he;++r)for(let n=0;n<ue;++n){t=r*ue*4+4*n;const s=fe[t],i=fe[t+1],o=fe[t+2];if(e=s>i?s:i,e=o>e?o:e,e<1e-32)a[t]=a[t+1]=a[t+2]=a[t+3]=0;else{const r=c(e);e=256*r[0]/e,a[t]=s*e,a[t+1]=i*e,a[t+2]=o*e,a[t+3]=r[1]+128}}fe=a}const Se=this.type===e.UnsignedByteType?e.RGBEFormat:e.RGBAFormat;return{header:Q,width:ue,height:he,data:fe,format:Se,type:this.type}},setDataType:function(e){return this.type=e,this},load:function(t,r,a,n){return e.DataTextureLoader.prototype.load.call(this,t,(function(t,a){switch(t.type){case e.UnsignedByteType:t.encoding=e.RGBEEncoding,t.minFilter=e.NearestFilter,t.magFilter=e.NearestFilter,t.generateMipmaps=!1,t.flipY=!1;break;case e.FloatType:case e.HalfFloatType:t.encoding=e.LinearEncoding,t.minFilter=e.LinearFilter,t.magFilter=e.LinearFilter,t.generateMipmaps=!1,t.flipY=!1}r&&r(t,a)}),a,n)}});var co,lo,uo,ho,po,fo,go,mo,vo,yo,Ao,bo,Bo,Co,xo,Fo,wo,Eo=function(t){e.Loader.call(this,t),this.defaultDPI=90,this.defaultUnit="px"};Eo.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:Eo,load:function(t,r,a,n){var s=this,i=new e.FileLoader(s.manager);i.setPath(s.path),i.setRequestHeader(s.requestHeader),i.setWithCredentials(s.withCredentials),i.load(t,(function(e){try{r(s.parse(e))}catch(e){n?n(e):console.error(e),s.manager.itemError(t)}}),a,n)},parse:function(t){var r=this;function a(e,t,r,a,s,i,o,c){if(0!=t&&0!=r){a=a*Math.PI/180,t=Math.abs(t),r=Math.abs(r);var l=(o.x-c.x)/2,u=(o.y-c.y)/2,h=Math.cos(a)*l+Math.sin(a)*u,p=-Math.sin(a)*l+Math.cos(a)*u,f=t*t,d=r*r,g=h*h,m=p*p,v=g/f+m/d;if(v>1){var y=Math.sqrt(v);f=(t*=y)*t,d=(r*=y)*r}var A=f*m+d*g,b=(f*d-A)/A,B=Math.sqrt(Math.max(0,b));s===i&&(B=-B);var C=B*t*p/r,x=-B*r*h/t,F=Math.cos(a)*C-Math.sin(a)*x+(o.x+c.x)/2,w=Math.sin(a)*C+Math.cos(a)*x+(o.y+c.y)/2,E=n(1,0,(h-C)/t,(p-x)/r),S=n((h-C)/t,(p-x)/r,(-h-C)/t,(-p-x)/r)%(2*Math.PI);e.currentPath.absellipse(F,w,t,r,E,E+S,0===i,a)}else e.lineTo(c.x,c.y)}function n(e,t,r,a){var n=e*r+t*a,s=Math.sqrt(e*e+t*t)*Math.sqrt(r*r+a*a),i=Math.acos(Math.max(-1,Math.min(1,n/s)));return e*a-t*r<0&&(i=-i),i}function s(e,t){t=Object.assign({},t);var r={};if(e.hasAttribute("class"))for(var a=e.getAttribute("class").split(/\s/).filter(Boolean).map((e=>e.trim())),n=0;n<a.length;n++)r=Object.assign(r,d["."+a[n]]);function s(a,n,s){void 0===s&&(s=function(e){return e.startsWith("url")&&console.warn("SVGLoader: url access in attributes is not implemented."),e}),e.hasAttribute(a)&&(t[n]=s(e.getAttribute(a))),r[a]&&(t[n]=s(r[a])),e.style&&""!==e.style[a]&&(t[n]=s(e.style[a]))}function i(e){return Math.max(0,Math.min(1,u(e)))}function o(e){return Math.max(0,u(e))}return e.hasAttribute("id")&&(r=Object.assign(r,d["#"+e.getAttribute("id")])),s("fill","fill"),s("fill-opacity","fillOpacity",i),s("opacity","opacity",i),s("stroke","stroke"),s("stroke-opacity","strokeOpacity",i),s("stroke-width","strokeWidth",o),s("stroke-linejoin","strokeLineJoin"),s("stroke-linecap","strokeLineCap"),s("stroke-miterlimit","strokeMiterLimit",o),s("visibility","visibility"),t}function i(e,t){return e-(t-e)}function o(e,t,r){if("string"!=typeof e)throw new TypeError("Invalid input: "+typeof e);var a={SEPARATOR:/[ \t\r\n\,.\-+]/,WHITESPACE:/[ \t\r\n]/,DIGIT:/[\d]/,SIGN:/[-+]/,POINT:/\./,COMMA:/,/,EXP:/e/i,FLAGS:/[01]/},n=0,s=!0,i=[],o="",c="";function l(e,t,r){var a=new SyntaxError('Unexpected character "'+e+'" at index '+t+".");throw a.partial=r,a}function u(){""!==o&&(""===c?i.push(Number(o)):i.push(Number(o)*Math.pow(10,Number(c)))),o="",c=""}var h,p=0,f=e.length;for(p=0;p<f;p++)if(h=e[p],Array.isArray(t)&&t.includes(i.length%r)&&a.FLAGS.test(h))n=1,o=h,u();else{if(0===n){if(a.WHITESPACE.test(h))continue;if(a.DIGIT.test(h)||a.SIGN.test(h)){n=1,o=h;continue}if(a.POINT.test(h)){n=2,o=h;continue}a.COMMA.test(h)&&(s&&l(h,p,i),s=!0)}if(1===n){if(a.DIGIT.test(h)){o+=h;continue}if(a.POINT.test(h)){o+=h,n=2;continue}if(a.EXP.test(h)){n=3;continue}a.SIGN.test(h)&&1===o.length&&a.SIGN.test(o[0])&&l(h,p,i)}if(2===n){if(a.DIGIT.test(h)){o+=h;continue}if(a.EXP.test(h)){n=3;continue}a.POINT.test(h)&&"."===o[o.length-1]&&l(h,p,i)}if(3===n){if(a.DIGIT.test(h)){c+=h;continue}if(a.SIGN.test(h)){if(""===c){c+=h;continue}1===c.length&&a.SIGN.test(c)&&l(h,p,i)}}a.WHITESPACE.test(h)?(u(),n=0,s=!1):a.COMMA.test(h)?(u(),n=0,s=!0):a.SIGN.test(h)?(u(),n=1,o=h):a.POINT.test(h)?(u(),n=2,o=h):l(h,p,i)}return u(),i}var c=["mm","cm","in","pt","pc","px"],l={mm:{mm:1,cm:.1,in:1/25.4,pt:72/25.4,pc:6/25.4,px:-1},cm:{mm:10,cm:1,in:1/2.54,pt:72/2.54,pc:6/2.54,px:-1},in:{mm:25.4,cm:2.54,in:1,pt:72,pc:6,px:-1},pt:{mm:25.4/72,cm:2.54/72,in:1/72,pt:1,pc:6/72,px:-1},pc:{mm:25.4/6,cm:2.54/6,in:1/6,pt:12,pc:1,px:-1},px:{px:1}};function u(e){var t="px";if("string"==typeof e||e instanceof String)for(var a=0,n=c.length;a<n;a++){var s=c[a];if(e.endsWith(s)){t=s,e=e.substring(0,e.length-s.length);break}}var i=void 0;return"px"===t&&"px"!==r.defaultUnit?i=l.in[r.defaultUnit]/r.defaultDPI:(i=l[t][r.defaultUnit])<0&&(i=l[t].in*r.defaultDPI),i*parseFloat(e)}function h(e){var t=e.elements;return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function p(e){var t=e.elements;return Math.sqrt(t[3]*t[3]+t[4]*t[4])}var f=[],d={},g=[],m=new e.Matrix3,v=new e.Matrix3,y=new e.Matrix3,A=new e.Matrix3,b=new e.Vector2,B=new e.Vector3,C=new e.Matrix3,x=(new e.$DOMParser).parseFromString(t,"image/svg+xml");return function t(r,n){if(1===r.nodeType){var c=function(t){if(!(t.hasAttribute("transform")||"use"===t.nodeName&&(t.hasAttribute("x")||t.hasAttribute("y"))))return null;var r=function(t){var r=new e.Matrix3,a=m;if("use"===t.nodeName&&(t.hasAttribute("x")||t.hasAttribute("y"))){var n=u(t.getAttribute("x")),s=u(t.getAttribute("y"));r.translate(n,s)}if(t.hasAttribute("transform"))for(var i=t.getAttribute("transform").split(")"),c=i.length-1;c>=0;c--){var l=i[c].trim();if(""!==l){var h=l.indexOf("("),p=l.length;if(h>0&&h<p){var f=l.substr(0,h),d=o(l.substr(h+1,p-h-1));switch(a.identity(),f){case"translate":if(d.length>=1){s=n=d[0];d.length>=2&&(s=d[1]),a.translate(n,s)}break;case"rotate":if(d.length>=1){var g=0,b=0,B=0;g=-d[0]*Math.PI/180,d.length>=3&&(b=d[1],B=d[2]),v.identity().translate(-b,-B),y.identity().rotate(g),A.multiplyMatrices(y,v),v.identity().translate(b,B),a.multiplyMatrices(v,A)}break;case"scale":if(d.length>=1){var C=d[0],x=C;d.length>=2&&(x=d[1]),a.scale(C,x)}break;case"skewX":1===d.length&&a.set(1,Math.tan(d[0]*Math.PI/180),0,0,1,0,0,0,1);break;case"skewY":1===d.length&&a.set(1,0,0,Math.tan(d[0]*Math.PI/180),1,0,0,0,1);break;case"matrix":6===d.length&&a.set(d[0],d[2],d[4],d[1],d[3],d[5],0,0,1)}}r.premultiply(a)}}return r}(t);g.length>0&&r.premultiply(g[g.length-1]);return C.copy(r),g.push(r),r}(r),l=!0,x=null;switch(r.nodeName){case"svg":break;case"style":!function(e){if(!e.sheet||!e.sheet.cssRules||!e.sheet.cssRules.length)return;for(var t=0;t<e.sheet.cssRules.length;t++){var r=e.sheet.cssRules[t];if(1===r.type)for(var a=r.selectorText.split(/,/gm).filter(Boolean).map((e=>e.trim())),n=0;n<a.length;n++)d[a[n]]=Object.assign(d[a[n]]||{},r.style)}}(r);break;case"g":n=s(r,n);break;case"path":n=s(r,n),r.hasAttribute("d")&&(x=function(t){for(var r=new e.ShapePath,n=new e.Vector2,s=new e.Vector2,c=new e.Vector2,l=!0,u=!1,h=t.getAttribute("d").match(/[a-df-z][^a-df-z]*/gi),p=0,f=h.length;p<f;p++){var d=h[p],g=d.charAt(0),m=d.substr(1).trim();switch(!0===l&&(u=!0,l=!1),g){case"M":for(var v=0,y=(C=o(m)).length;v<y;v+=2)n.x=C[v+0],n.y=C[v+1],s.x=n.x,s.y=n.y,0===v?r.moveTo(n.x,n.y):r.lineTo(n.x,n.y),0===v&&!0===u&&c.copy(n);break;case"H":for(v=0,y=(C=o(m)).length;v<y;v++)n.x=C[v],s.x=n.x,s.y=n.y,r.lineTo(n.x,n.y),0===v&&!0===u&&c.copy(n);break;case"V":for(v=0,y=(C=o(m)).length;v<y;v++)n.y=C[v],s.x=n.x,s.y=n.y,r.lineTo(n.x,n.y),0===v&&!0===u&&c.copy(n);break;case"L":for(v=0,y=(C=o(m)).length;v<y;v+=2)n.x=C[v+0],n.y=C[v+1],s.x=n.x,s.y=n.y,r.lineTo(n.x,n.y),0===v&&!0===u&&c.copy(n);break;case"C":for(v=0,y=(C=o(m)).length;v<y;v+=6)r.bezierCurveTo(C[v+0],C[v+1],C[v+2],C[v+3],C[v+4],C[v+5]),s.x=C[v+2],s.y=C[v+3],n.x=C[v+4],n.y=C[v+5],0===v&&!0===u&&c.copy(n);break;case"S":for(v=0,y=(C=o(m)).length;v<y;v+=4)r.bezierCurveTo(i(n.x,s.x),i(n.y,s.y),C[v+0],C[v+1],C[v+2],C[v+3]),s.x=C[v+0],s.y=C[v+1],n.x=C[v+2],n.y=C[v+3],0===v&&!0===u&&c.copy(n);break;case"Q":for(v=0,y=(C=o(m)).length;v<y;v+=4)r.quadraticCurveTo(C[v+0],C[v+1],C[v+2],C[v+3]),s.x=C[v+0],s.y=C[v+1],n.x=C[v+2],n.y=C[v+3],0===v&&!0===u&&c.copy(n);break;case"T":for(v=0,y=(C=o(m)).length;v<y;v+=2){var A=i(n.x,s.x),b=i(n.y,s.y);r.quadraticCurveTo(A,b,C[v+0],C[v+1]),s.x=A,s.y=b,n.x=C[v+0],n.y=C[v+1],0===v&&!0===u&&c.copy(n)}break;case"A":for(v=0,y=(C=o(m,[3,4],7)).length;v<y;v+=7)if(C[v+5]!=n.x||C[v+6]!=n.y){var B=n.clone();n.x=C[v+5],n.y=C[v+6],s.x=n.x,s.y=n.y,a(r,C[v],C[v+1],C[v+2],C[v+3],C[v+4],B,n),0===v&&!0===u&&c.copy(n)}break;case"m":for(v=0,y=(C=o(m)).length;v<y;v+=2)n.x+=C[v+0],n.y+=C[v+1],s.x=n.x,s.y=n.y,0===v?r.moveTo(n.x,n.y):r.lineTo(n.x,n.y),0===v&&!0===u&&c.copy(n);break;case"h":for(v=0,y=(C=o(m)).length;v<y;v++)n.x+=C[v],s.x=n.x,s.y=n.y,r.lineTo(n.x,n.y),0===v&&!0===u&&c.copy(n);break;case"v":for(v=0,y=(C=o(m)).length;v<y;v++)n.y+=C[v],s.x=n.x,s.y=n.y,r.lineTo(n.x,n.y),0===v&&!0===u&&c.copy(n);break;case"l":for(v=0,y=(C=o(m)).length;v<y;v+=2)n.x+=C[v+0],n.y+=C[v+1],s.x=n.x,s.y=n.y,r.lineTo(n.x,n.y),0===v&&!0===u&&c.copy(n);break;case"c":for(v=0,y=(C=o(m)).length;v<y;v+=6)r.bezierCurveTo(n.x+C[v+0],n.y+C[v+1],n.x+C[v+2],n.y+C[v+3],n.x+C[v+4],n.y+C[v+5]),s.x=n.x+C[v+2],s.y=n.y+C[v+3],n.x+=C[v+4],n.y+=C[v+5],0===v&&!0===u&&c.copy(n);break;case"s":for(v=0,y=(C=o(m)).length;v<y;v+=4)r.bezierCurveTo(i(n.x,s.x),i(n.y,s.y),n.x+C[v+0],n.y+C[v+1],n.x+C[v+2],n.y+C[v+3]),s.x=n.x+C[v+0],s.y=n.y+C[v+1],n.x+=C[v+2],n.y+=C[v+3],0===v&&!0===u&&c.copy(n);break;case"q":for(v=0,y=(C=o(m)).length;v<y;v+=4)r.quadraticCurveTo(n.x+C[v+0],n.y+C[v+1],n.x+C[v+2],n.y+C[v+3]),s.x=n.x+C[v+0],s.y=n.y+C[v+1],n.x+=C[v+2],n.y+=C[v+3],0===v&&!0===u&&c.copy(n);break;case"t":for(v=0,y=(C=o(m)).length;v<y;v+=2){A=i(n.x,s.x),b=i(n.y,s.y);r.quadraticCurveTo(A,b,n.x+C[v+0],n.y+C[v+1]),s.x=A,s.y=b,n.x=n.x+C[v+0],n.y=n.y+C[v+1],0===v&&!0===u&&c.copy(n)}break;case"a":var C;for(v=0,y=(C=o(m,[3,4],7)).length;v<y;v+=7)if(0!=C[v+5]||0!=C[v+6]){B=n.clone();n.x+=C[v+5],n.y+=C[v+6],s.x=n.x,s.y=n.y,a(r,C[v],C[v+1],C[v+2],C[v+3],C[v+4],B,n),0===v&&!0===u&&c.copy(n)}break;case"Z":case"z":r.currentPath.autoClose=!0,r.currentPath.curves.length>0&&(n.copy(c),r.currentPath.currentPoint.copy(n),l=!0);break;default:console.warn(d)}u=!1}return r}(r));break;case"rect":n=s(r,n),x=function(t){var r=u(t.getAttribute("x")||0),a=u(t.getAttribute("y")||0),n=u(t.getAttribute("rx")||0),s=u(t.getAttribute("ry")||0),i=u(t.getAttribute("width")),o=u(t.getAttribute("height")),c=new e.ShapePath;c.moveTo(r+2*n,a),c.lineTo(r+i-2*n,a),(0!==n||0!==s)&&c.bezierCurveTo(r+i,a,r+i,a,r+i,a+2*s);c.lineTo(r+i,a+o-2*s),(0!==n||0!==s)&&c.bezierCurveTo(r+i,a+o,r+i,a+o,r+i-2*n,a+o);c.lineTo(r+2*n,a+o),(0!==n||0!==s)&&c.bezierCurveTo(r,a+o,r,a+o,r,a+o-2*s);c.lineTo(r,a+2*s),(0!==n||0!==s)&&c.bezierCurveTo(r,a,r,a,r+2*n,a);return c}(r);break;case"polygon":n=s(r,n),x=function(t){function r(e,t,r){var a=u(t),i=u(r);0===s?n.moveTo(a,i):n.lineTo(a,i),s++}var a=/(-?[\d\.?]+)[,|\s](-?[\d\.?]+)/g,n=new e.ShapePath,s=0;return t.getAttribute("points").replace(a,r),n.currentPath.autoClose=!0,n}(r);break;case"polyline":n=s(r,n),x=function(t){function r(e,t,r){var a=u(t),i=u(r);0===s?n.moveTo(a,i):n.lineTo(a,i),s++}var a=/(-?[\d\.?]+)[,|\s](-?[\d\.?]+)/g,n=new e.ShapePath,s=0;return t.getAttribute("points").replace(a,r),n.currentPath.autoClose=!1,n}(r);break;case"circle":n=s(r,n),x=function(t){var r=u(t.getAttribute("cx")||0),a=u(t.getAttribute("cy")||0),n=u(t.getAttribute("r")||0),s=new e.Path;s.absarc(r,a,n,0,2*Math.PI);var i=new e.ShapePath;return i.subPaths.push(s),i}(r);break;case"ellipse":n=s(r,n),x=function(t){var r=u(t.getAttribute("cx")||0),a=u(t.getAttribute("cy")||0),n=u(t.getAttribute("rx")||0),s=u(t.getAttribute("ry")||0),i=new e.Path;i.absellipse(r,a,n,s,0,2*Math.PI);var o=new e.ShapePath;return o.subPaths.push(i),o}(r);break;case"line":n=s(r,n),x=function(t){var r=u(t.getAttribute("x1")||0),a=u(t.getAttribute("y1")||0),n=u(t.getAttribute("x2")||0),s=u(t.getAttribute("y2")||0),i=new e.ShapePath;return i.moveTo(r,a),i.lineTo(n,s),i.currentPath.autoClose=!1,i}(r);break;case"defs":l=!1;break;case"use":n=s(r,n);var F=r.href.baseVal.substring(1),w=r.viewportElement.getElementById(F);w?t(w,n):console.warn("SVGLoader: 'use node' references non-existent node id: "+F)}if(x&&(void 0!==n.fill&&"none"!==n.fill&&x.color.setStyle(n.fill),function(e,t){function r(e){B.set(e.x,e.y,1).applyMatrix3(t),e.set(B.x,B.y)}for(var a=function(e){return 0!==e.elements[1]||0!==e.elements[3]}(t),n=e.subPaths,s=0,i=n.length;s<i;s++)for(var o=n[s].curves,c=0;c<o.length;c++){var l=o[c];l.isLineCurve?(r(l.v1),r(l.v2)):l.isCubicBezierCurve?(r(l.v0),r(l.v1),r(l.v2),r(l.v3)):l.isQuadraticBezierCurve?(r(l.v0),r(l.v1),r(l.v2)):l.isEllipseCurve&&(a&&console.warn("SVGLoader: Elliptic arc or ellipse rotation or skewing is not implemented."),b.set(l.aX,l.aY),r(b),l.aX=b.x,l.aY=b.y,l.xRadius*=h(t),l.yRadius*=p(t))}}(x,C),f.push(x),x.userData={node:r,style:n}),l)for(var E=r.childNodes,S=0;S<E.length;S++)t(E[S],n);c&&(g.pop(),g.length>0?C.copy(g[g.length-1]):C.identity())}}(x.documentElement,{fill:"#000",fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeLineJoin:"miter",strokeLineCap:"butt",strokeMiterLimit:4}),{paths:f,xml:x.documentElement}}}),Eo.createShapes=function(t){const r=999999999,a=0,n=1,s=2,i=3,o=4,c=5,l=6,u={loc:a,t:0};function h(e,t,r,n){var i=e.x,o=t.x,c=r.x,l=n.x,h=e.y,f=t.y,d=r.y,g=n.y,m=(l-c)*(h-d)-(g-d)*(i-c),v=(g-d)*(o-i)-(l-c)*(f-h),y=m/v,A=((o-i)*(h-d)-(f-h)*(i-c))/v;if(0===v&&0!==m||y<=0||y>=1||A<0||A>1)return null;if(0===m&&0===v){for(var b=0;b<2;b++){if(p(0===b?r:n,e,t),u.loc==a)return{x:(B=0===b?r:n).x,y:B.y,t:u.t};if(u.loc==s)return{x:+(i+u.t*(o-i)).toPrecision(10),y:+(h+u.t*(f-h)).toPrecision(10),t:u.t}}return null}for(b=0;b<2;b++){var B;if(p(0===b?r:n,e,t),u.loc==a)return{x:(B=0===b?r:n).x,y:B.y,t:u.t}}return{x:+(i+y*(o-i)).toPrecision(10),y:+(h+y*(f-h)).toPrecision(10),t:y}}function p(e,t,r){var h,p=r.x-t.x,f=r.y-t.y,d=e.x-t.x,g=e.y-t.y,m=p*g-d*f;if(e.x===t.x&&e.y===t.y)return u.loc=a,void(u.t=0);if(e.x===r.x&&e.y===r.y)return u.loc=n,void(u.t=1);m<-Number.EPSILON?u.loc=i:m>Number.EPSILON?u.loc=o:p*d<0||f*g<0?u.loc=c:Math.sqrt(p*p+f*f)<Math.sqrt(d*d+g*g)?u.loc=l:(h=0!==p?d/p:g/f,u.loc=s,u.t=h)}function f(t,r,a){const n=new e.Vector2;r.getCenter(n);const s=[];return a.forEach((r=>{if(r.boundingBox.containsPoint(n)){(function(t,r){const a=[],n=[];for(let s=1;s<t.length;s++){const i=t[s-1],o=t[s];for(let t=1;t<r.length;t++){const s=h(i,o,r[t-1],r[t]);null!==s&&void 0===a.find((e=>e.t<=s.t+Number.EPSILON&&e.t>=s.t-Number.EPSILON))&&(a.push(s),n.push(new e.Vector2(s.x,s.y)))}}return n})(t,r.points).forEach((e=>{s.push({identifier:r.identifier,isCW:r.isCW,point:e})}))}})),s.sort(((e,t)=>e.point.x-t.point.x)),s}let d=0,g=r,m=-999999999,v=t.subPaths.map((t=>{const a=t.getPoints();let n=-999999999,s=r,i=-999999999,o=r;for(let e=0;e<a.length;e++){const t=a[e];t.y>n&&(n=t.y),t.y<s&&(s=t.y),t.x>i&&(i=t.x),t.x<o&&(o=t.x)}return m<=i&&(m=i+1),g>=o&&(g=o-1),{points:a,isCW:e.ShapeUtils.isClockWise(a),identifier:d++,boundingBox:new e.Box2(new e.Vector2(o,s),new e.Vector2(i,n))}}));v=v.filter((e=>e.points.length>0));const y=v.map((r=>function(t,r,a,n,s){null!=s&&""!==s||(s="nonzero");const i=new e.Vector2;t.boundingBox.getCenter(i);const o=f([new e.Vector2(a,i.y),new e.Vector2(n,i.y)],t.boundingBox,r);o.sort(((e,t)=>e.point.x-t.point.x));const c=[],l=[];o.forEach((e=>{e.identifier===t.identifier?c.push(e):l.push(e)}));const u=c[0].point.x,h=[];let p=0;for(;p<l.length&&l[p].point.x<u;)h.length>0&&h[h.length-1]===l[p].identifier?h.pop():h.push(l[p].identifier),p++;if(h.push(t.identifier),"evenodd"===s){const e=h.length%2==0,r=h[h.length-2];return{identifier:t.identifier,isHole:e,for:r}}if("nonzero"===s){let e=!0,a=null,n=null;for(let t=0;t<h.length;t++){const s=h[t];e?(n=r[s].isCW,e=!1,a=s):n!==r[s].isCW&&(n=r[s].isCW,e=!0)}return{identifier:t.identifier,isHole:e,for:a}}console.warn('fill-rule: "'+s+'" is currently not implemented.')}(r,v,g,m,t.userData.style.fillRule))),A=[];return v.forEach((t=>{if(!y[t.identifier].isHole){const r=new e.Shape(t.points);y.filter((e=>e.isHole&&e.for===t.identifier)).forEach((t=>{const a=v[t.identifier];r.holes.push(new e.Path(a.points))})),A.push(r)}})),A},Eo.getStrokeStyle=function(e,t,r,a,n){return{strokeColor:t=void 0!==t?t:"#000",strokeWidth:e=void 0!==e?e:1,strokeLineJoin:r=void 0!==r?r:"miter",strokeLineCap:a=void 0!==a?a:"butt",strokeMiterLimit:n=void 0!==n?n:4}},Eo.pointsToStroke=function(t,r,a,n){var s=[],i=[],o=[];if(0===Eo.pointsToStrokeWithBuffers(t,r,a,n,s,i,o))return null;var c=new e.BufferGeometry;return c.setAttribute("position",new e.Float32BufferAttribute(s,3)),c.setAttribute("normal",new e.Float32BufferAttribute(i,3)),c.setAttribute("uv",new e.Float32BufferAttribute(o,2)),c},Eo.pointsToStrokeWithBuffers=(co=new e.Vector2,lo=new e.Vector2,uo=new e.Vector2,ho=new e.Vector2,po=new e.Vector2,fo=new e.Vector2,go=new e.Vector2,mo=new e.Vector2,vo=new e.Vector2,yo=new e.Vector2,Ao=new e.Vector2,bo=new e.Vector2,Bo=new e.Vector2,Co=new e.Vector2,xo=new e.Vector2,Fo=new e.Vector2,wo=new e.Vector2,function(e,t,r,a,n,s,i,o){r=void 0!==r?r:12,a=void 0!==a?a:.001,o=void 0!==o?o:0;var c=(e=function(e){for(var t=!1,r=1,n=e.length-1;r<n;r++)if(e[r].distanceTo(e[r+1])<a){t=!0;break}if(!t)return e;var s=[];for(s.push(e[0]),r=1,n=e.length-1;r<n;r++)e[r].distanceTo(e[r+1])>=a&&s.push(e[r]);return s.push(e[e.length-1]),s}(e)).length;if(c<2)return 0;var l,u,h,p,f,d=e[0].equals(e[c-1]),g=e[0],m=t.strokeWidth/2,v=1/(c-1),y=0,A=!1,b=0,B=3*o,C=2*o;D(e[0],e[1],co).multiplyScalar(m),mo.copy(e[0]).sub(co),vo.copy(e[0]).add(co),yo.copy(mo),Ao.copy(vo);for(var x=1;x<c;x++){l=e[x],u=x===c-1?d?e[1]:void 0:e[x+1];var F=co;D(g,l,F),uo.copy(F).multiplyScalar(m),bo.copy(l).sub(uo),Bo.copy(l).add(uo);var w=y+v;if(h=!1,void 0!==u){D(l,u,lo),uo.copy(lo).multiplyScalar(m),Co.copy(l).sub(uo),xo.copy(l).add(uo),p=!0,uo.subVectors(u,g),F.dot(uo)<0&&(p=!1),1===x&&(A=p),uo.subVectors(u,l),uo.normalize();var E=Math.abs(F.dot(uo));if(0!==E){var S=m/E;uo.multiplyScalar(-S),ho.subVectors(l,g),po.copy(ho).setLength(S).add(uo),Fo.copy(po).negate();var I=po.length(),M=ho.length();ho.divideScalar(M),fo.subVectors(u,l);var T=fo.length();switch(fo.divideScalar(T),ho.dot(Fo)<M&&fo.dot(Fo)<T&&(h=!0),wo.copy(po).add(l),Fo.add(l),f=!1,h?p?(xo.copy(Fo),Bo.copy(Fo)):(Co.copy(Fo),bo.copy(Fo)):G(),t.strokeLineJoin){case"bevel":N(p,h,w);break;case"round":P(p,h),p?U(l,bo,Co,w,0):U(l,xo,Bo,w,1);break;case"miter":case"miter-clip":default:var k=m*t.strokeMiterLimit/I;if(k<1){if("miter-clip"!==t.strokeLineJoin){N(p,h,w);break}P(p,h),p?(fo.subVectors(wo,bo).multiplyScalar(k).add(bo),go.subVectors(wo,Co).multiplyScalar(k).add(Co),O(bo,w,0),O(fo,w,0),O(l,w,.5),O(l,w,.5),O(fo,w,0),O(go,w,0),O(l,w,.5),O(go,w,0),O(Co,w,0)):(fo.subVectors(wo,Bo).multiplyScalar(k).add(Bo),go.subVectors(wo,xo).multiplyScalar(k).add(xo),O(Bo,w,1),O(fo,w,1),O(l,w,.5),O(l,w,.5),O(fo,w,1),O(go,w,1),O(l,w,.5),O(go,w,1),O(xo,w,1))}else h?(p?(O(vo,y,1),O(mo,y,0),O(wo,w,0),O(vo,y,1),O(wo,w,0),O(Fo,w,1)):(O(vo,y,1),O(mo,y,0),O(wo,w,1),O(mo,y,0),O(Fo,w,0),O(wo,w,1)),p?Co.copy(wo):xo.copy(wo)):p?(O(bo,w,0),O(wo,w,0),O(l,w,.5),O(l,w,.5),O(wo,w,0),O(Co,w,0)):(O(Bo,w,1),O(wo,w,1),O(l,w,.5),O(l,w,.5),O(wo,w,1),O(xo,w,1)),f=!0}}else G()}else G();d||x!==c-1||H(e[0],yo,Ao,p,!0,y),y=w,g=l,mo.copy(Co),vo.copy(xo)}if(d){if(h&&n){var R=wo,L=Fo;A!==p&&(R=Fo,L=wo),p?(f||A)&&(L.toArray(n,0),L.toArray(n,9),f&&R.toArray(n,3)):!f&&A||(L.toArray(n,3),L.toArray(n,9),f&&R.toArray(n,0))}}else H(l,bo,Bo,p,!1,w);return b;function D(e,t,r){return r.subVectors(t,e),r.set(-r.y,r.x).normalize()}function O(e,t,r){n&&(n[B]=e.x,n[B+1]=e.y,n[B+2]=0,s&&(s[B]=0,s[B+1]=0,s[B+2]=1),B+=3,i&&(i[C]=t,i[C+1]=r,C+=2)),b+=3}function U(e,t,a,n,s){co.copy(t).sub(e).normalize(),lo.copy(a).sub(e).normalize();var i=Math.PI,o=co.dot(lo);Math.abs(o)<1&&(i=Math.abs(Math.acos(o))),i/=r,uo.copy(t);for(var c=0,l=r-1;c<l;c++)ho.copy(uo).rotateAround(e,i),O(uo,n,s),O(ho,n,s),O(e,n,.5),uo.copy(ho);O(ho,n,s),O(a,n,s),O(e,n,.5)}function G(){O(vo,y,1),O(mo,y,0),O(bo,w,0),O(vo,y,1),O(bo,w,1),O(Bo,w,0)}function N(e,t,r){t?e?(O(vo,y,1),O(mo,y,0),O(bo,w,0),O(vo,y,1),O(bo,w,0),O(Fo,w,1),O(bo,r,0),O(Co,r,0),O(Fo,r,.5)):(O(vo,y,1),O(mo,y,0),O(Bo,w,1),O(mo,y,0),O(Fo,w,0),O(Bo,w,1),O(Bo,r,1),O(xo,r,0),O(Fo,r,.5)):e?(O(bo,r,0),O(Co,r,0),O(l,r,.5)):(O(Bo,r,1),O(xo,r,0),O(l,r,.5))}function P(e,t){t&&(e?(O(vo,y,1),O(mo,y,0),O(bo,w,0),O(vo,y,1),O(bo,w,0),O(Fo,w,1),O(bo,y,0),O(l,w,.5),O(Fo,w,1),O(l,w,.5),O(Co,y,0),O(Fo,w,1)):(O(vo,y,1),O(mo,y,0),O(Bo,w,1),O(mo,y,0),O(Fo,w,0),O(Bo,w,1),O(Bo,y,1),O(Fo,w,0),O(l,w,.5),O(l,w,.5),O(Fo,w,0),O(xo,y,1)))}function H(e,r,a,s,i,o){switch(t.strokeLineCap){case"round":i?U(e,a,r,o,.5):U(e,r,a,o,.5);break;case"square":if(i)co.subVectors(r,e),lo.set(co.y,-co.x),uo.addVectors(co,lo).add(e),ho.subVectors(lo,co).add(e),s?(uo.toArray(n,3),ho.toArray(n,0),ho.toArray(n,9)):(uo.toArray(n,3),uo.toArray(n,9),ho.toArray(n,0));else{co.subVectors(a,e),lo.set(co.y,-co.x),uo.addVectors(co,lo).add(e),ho.subVectors(lo,co).add(e);var c=n.length;s?(uo.toArray(n,c-3),ho.toArray(n,c-6),ho.toArray(n,c-12)):(uo.toArray(n,c-6),ho.toArray(n,c-3),ho.toArray(n,c-12))}}}});var So=function(t){e.DataTextureLoader.call(this,t),this.type=e.UnsignedByteType};So.prototype=Object.assign(Object.create(e.DataTextureLoader.prototype),{constructor:So,parse:function(t){var r=function(e,t){switch(e){case 1:console.error("THREE.RGBELoader Read Error: "+(t||""));break;case 2:console.error("THREE.RGBELoader Write Error: "+(t||""));break;case 3:console.error("THREE.RGBELoader Bad File Format: "+(t||""));break;default:case 4:console.error("THREE.RGBELoader: Error: "+(t||""))}return-1},a=function(e,t,r){t=t||1024;for(var a=e.pos,n=-1,s=0,i="",o=String.fromCharCode.apply(null,new Uint16Array(e.subarray(a,a+128)));0>(n=o.indexOf("\n"))&&s<t&&a<e.byteLength;)i+=o,s+=o.length,a+=128,o+=String.fromCharCode.apply(null,new Uint16Array(e.subarray(a,a+128)));return-1<n&&(!1!==r&&(e.pos+=s+n+1),i+o.slice(0,n))},n=function(t,r,a,n){var s=t[r+3],i=Math.pow(2,s-128)/255;a[n+0]=e.DataUtils.toHalfFloat(t[r+0]*i),a[n+1]=e.DataUtils.toHalfFloat(t[r+1]*i),a[n+2]=e.DataUtils.toHalfFloat(t[r+2]*i)},s=new Uint8Array(t);s.pos=0;var i,o,c,l,u,h,p=function(e){var t,n,s=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,i=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,o=/^\s*FORMAT=(\S+)\s*$/,c=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,l={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};if(e.pos>=e.byteLength||!(t=a(e)))return r(1,"no header found");if(!(n=t.match(/^#\?(\S+)/)))return r(3,"bad initial token");for(l.valid|=1,l.programtype=n[1],l.string+=t+"\n";!1!==(t=a(e));)if(l.string+=t+"\n","#"!==t.charAt(0)){if((n=t.match(s))&&(l.gamma=parseFloat(n[1],10)),(n=t.match(i))&&(l.exposure=parseFloat(n[1],10)),(n=t.match(o))&&(l.valid|=2,l.format=n[1]),(n=t.match(c))&&(l.valid|=4,l.height=parseInt(n[1],10),l.width=parseInt(n[2],10)),2&l.valid&&4&l.valid)break}else l.comments+=t+"\n";return 2&l.valid?4&l.valid?l:r(3,"missing image size specifier"):r(3,"missing format specifier")}(s);if(-1!==p){var f=p.width,d=p.height,g=function(e,t,a){var n,s,i,o,c,l,u,h,p,f,d,g,m,v=t,y=a;if(v<8||v>32767||2!==e[0]||2!==e[1]||128&e[2])return new Uint8Array(e);if(v!==(e[2]<<8|e[3]))return r(3,"wrong scanline width");if(!(n=new Uint8Array(4*t*a)).length)return r(4,"unable to allocate buffer space");for(s=0,i=0,h=4*v,m=new Uint8Array(4),l=new Uint8Array(h);y>0&&i<e.byteLength;){if(i+4>e.byteLength)return r(1);if(m[0]=e[i++],m[1]=e[i++],m[2]=e[i++],m[3]=e[i++],2!=m[0]||2!=m[1]||(m[2]<<8|m[3])!=v)return r(3,"bad rgbe scanline format");for(u=0;u<h&&i<e.byteLength;){if((g=(o=e[i++])>128)&&(o-=128),0===o||u+o>h)return r(3,"bad scanline data");if(g)for(c=e[i++],p=0;p<o;p++)l[u++]=c;else l.set(e.subarray(i,i+o),u),u+=o,i+=o}for(f=v,p=0;p<f;p++)d=0,n[s]=l[p+d],d+=v,n[s+1]=l[p+d],d+=v,n[s+2]=l[p+d],d+=v,n[s+3]=l[p+d],s+=4;y--}return n}(s.subarray(s.pos),f,d);if(-1!==g){switch(this.type){case e.UnsignedByteType:var m=g,v=e.RGBEFormat,y=e.UnsignedByteType;break;case e.FloatType:for(var A=g.length/4*3,b=new Float32Array(A),B=0;B<A;B++)c=b,l=3*B,u=void 0,h=void 0,u=(i=g)[(o=4*B)+3],h=Math.pow(2,u-128)/255,c[l+0]=i[o+0]*h,c[l+1]=i[o+1]*h,c[l+2]=i[o+2]*h;m=b,v=e.RGBFormat,y=e.FloatType;break;case e.HalfFloatType:A=g.length/4*3;var C=new Uint16Array(A);for(B=0;B<A;B++)n(g,4*B,C,3*B);m=C,v=e.RGBFormat,y=e.HalfFloatType;break;default:console.error("THREE.RGBELoader: unsupported type: ",this.type)}return{width:f,height:d,data:m,header:p.string,gamma:p.gamma,exposure:p.exposure,format:v,type:y}}}return null},setDataType:function(e){return this.type=e,this},load:function(t,r,a,n){return e.DataTextureLoader.prototype.load.call(this,t,(function(t,a){switch(t.type){case e.UnsignedByteType:t.encoding=e.RGBEEncoding,t.minFilter=e.NearestFilter,t.magFilter=e.NearestFilter,t.generateMipmaps=!1,t.flipY=!0;break;case e.FloatType:case e.HalfFloatType:t.encoding=e.LinearEncoding,t.minFilter=e.LinearFilter,t.magFilter=e.LinearFilter,t.generateMipmaps=!1,t.flipY=!0}r&&r(t,a)}),a,n)}});const Io="http://www.yanhuangxueyuan.com/threejs";function Mo(e){let t,r=e[0],a=1;for(;a<e.length;){const n=e[a],s=e[a+1];if(a+=2,("optionalAccess"===n||"optionalCall"===n)&&null==r)return;"access"===n||"optionalAccess"===n?(t=r,r=s(r)):"call"!==n&&"optionalCall"!==n||(r=s(((...e)=>r.call(t,...e))),t=void 0)}return r}var To=function(t){e.Loader.call(this,t)};To.prototype=Object.assign(Object.create(e.Loader.prototype),{constructor:To,load:function(t,r,a,n){var s=this,i=""===s.path?e.LoaderUtils.extractUrlBase(t):s.path,o=new e.FileLoader(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(t,(function(e){try{r(s.parse(e,i))}catch(e){n?n(e):console.error(e),s.manager.itemError(t)}}),a,n)},options:{set convertUpAxis(e){console.warn("THREE.ColladaLoader: options.convertUpAxis() has been removed. Up axis is converted automatically.")}},parse:function(t,r){function a(e,t){for(var r=[],a=e.childNodes,n=0,s=a.length;n<s;n++){var i=a[n];i.nodeName===t&&r.push(i)}return r}function n(e){if(0===e.length)return[];for(var t=e.trim().split(/\s+/),r=new Array(t.length),a=0,n=t.length;a<n;a++)r[a]=t[a];return r}function s(e){if(0===e.length)return[];for(var t=e.trim().split(/\s+/),r=new Array(t.length),a=0,n=t.length;a<n;a++)r[a]=parseFloat(t[a]);return r}function i(e){if(0===e.length)return[];for(var t=e.trim().split(/\s+/),r=new Array(t.length),a=0,n=t.length;a<n;a++)r[a]=parseInt(t[a]);return r}function o(e){return e.substring(1)}function c(e){return 0===Object.keys(e).length}function l(e){return void 0!==e&&!0===e.hasAttribute("meter")?parseFloat(e.getAttribute("meter")):1}function u(e){return void 0!==e?e.textContent:"Y_UP"}function h(e,t,r,n){var s=a(e,t)[0];if(void 0!==s)for(var i=a(s,r),o=0;o<i.length;o++)n(i[o])}function p(e,t){for(var r in e){e[r].build=t(e[r])}}function f(e,t){return void 0!==e.build||(e.build=t(e)),e.build}function d(e){for(var t={inputs:{}},r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"input":var s=o(n.getAttribute("source")),i=n.getAttribute("semantic");t.inputs[i]=s}}return t}function g(e){var t={},r=e.getAttribute("target").split("/"),a=r.shift(),n=r.shift(),s=-1!==n.indexOf("("),i=-1!==n.indexOf(".");if(i)r=n.split("."),n=r.shift(),t.member=r.shift();else if(s){var c=n.split("(");n=c.shift();for(var l=0;l<c.length;l++)c[l]=parseInt(c[l].replace(/\)/,""));t.indices=c}return t.id=a,t.sid=n,t.arraySyntax=s,t.memberSyntax=i,t.sampler=o(e.getAttribute("source")),t}function m(e){var t=[],r=e.channels,a=e.samplers,n=e.sources;for(var s in r)if(r.hasOwnProperty(s)){var i=r[s],o=a[i.sampler],c=o.inputs.INPUT,l=o.inputs.OUTPUT;C(y(i,n[c],n[l]),t)}return t}function v(e){return f(Ze.animations[e],m)}function y(e,t,r){var a,n,s,i,o,c,l=Ze.nodes[e.id],u=Ge(l.id),h=l.transforms[e.sid],p=l.matrix.clone().transpose(),f={};switch(h){case"matrix":for(s=0,i=t.array.length;s<i;s++)if(a=t.array[s],n=s*r.stride,void 0===f[a]&&(f[a]={}),!0===e.arraySyntax){var d=r.array[n],g=e.indices[0]+4*e.indices[1];f[a][g]=d}else for(o=0,c=r.stride;o<c;o++)f[a][o]=r.array[n+o];break;case"translate":case"rotate":case"scale":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',h)}var m=function(e,t){var r=[];for(var a in e)r.push({time:parseFloat(a),value:e[a]});r.sort(s);for(var n=0;n<16;n++)x(r,n,t.elements[n]);return r;function s(e,t){return e.time-t.time}}(f,p);return{name:u.uuid,keyframes:m}}var A=new e.Vector3,b=new e.Vector3,B=new e.Quaternion;function C(t,r){for(var a=t.keyframes,n=t.name,s=[],i=[],o=[],c=[],l=0,u=a.length;l<u;l++){var h=a[l],p=h.time,f=h.value;Ee.fromArray(f).transpose(),Ee.decompose(A,B,b),s.push(p),i.push(A.x,A.y,A.z),o.push(B.x,B.y,B.z,B.w),c.push(b.x,b.y,b.z)}return i.length>0&&r.push(new e.VectorKeyframeTrack(n+".position",s,i)),o.length>0&&r.push(new e.QuaternionKeyframeTrack(n+".quaternion",s,o)),c.length>0&&r.push(new e.VectorKeyframeTrack(n+".scale",s,c)),r}function x(e,t,r){var a,n,s,i=!0;for(n=0,s=e.length;n<s;n++)void 0===(a=e[n]).value[t]?a.value[t]=null:i=!1;if(!0===i)for(n=0,s=e.length;n<s;n++)(a=e[n]).value[t]=r;else!function(e,t){for(var r,a,n=0,s=e.length;n<s;n++){var i=e[n];if(null===i.value[t]){if(r=F(e,n,t),a=w(e,n,t),null===r){i.value[t]=a.value[t];continue}if(null===a){i.value[t]=r.value[t];continue}E(i,r,a,t)}}}(e,t)}function F(e,t,r){for(;t>=0;){var a=e[t];if(null!==a.value[r])return a;t--}return null}function w(e,t,r){for(;t<e.length;){var a=e[t];if(null!==a.value[r])return a;t++}return null}function E(e,t,r,a){r.time-t.time!=0?e.value[a]=(e.time-t.time)*(r.value[a]-t.value[a])/(r.time-t.time)+t.value[a]:e.value[a]=t.value[a]}function S(t){for(var r=[],a=t.name,n=t.end-t.start||-1,s=t.animations,i=0,o=s.length;i<o;i++)for(var c=v(s[i]),l=0,u=c.length;l<u;l++)r.push(c[l]);return new e.AnimationClip(a,n,r)}function I(e){return f(Ze.clips[e],S)}function M(e){for(var t={sources:{}},r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"bind_shape_matrix":t.bindShapeMatrix=s(n.textContent);break;case"source":var i=n.getAttribute("id");t.sources[i]=ie(n);break;case"joints":t.joints=T(n);break;case"vertex_weights":t.vertexWeights=k(n)}}return t}function T(e){for(var t={inputs:{}},r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"input":var s=n.getAttribute("semantic"),i=o(n.getAttribute("source"));t.inputs[s]=i}}return t}function k(e){for(var t={inputs:{}},r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"input":var s=n.getAttribute("semantic"),c=o(n.getAttribute("source")),l=parseInt(n.getAttribute("offset"));t.inputs[s]={id:c,offset:l};break;case"vcount":t.vcount=i(n.textContent);break;case"v":t.v=i(n.textContent)}}return t}function R(t){var r={id:t.id},a=Ze.geometries[r.id];return void 0!==t.skin&&(r.skin=function(t){var r,a,n,s=4,i={joints:[],indices:{array:[],stride:s},weights:{array:[],stride:s}},o=t.sources,c=t.vertexWeights,l=c.vcount,u=c.v,h=c.inputs.JOINT.offset,p=c.inputs.WEIGHT.offset,f=t.sources[t.joints.inputs.JOINT],d=t.sources[t.joints.inputs.INV_BIND_MATRIX],g=o[c.inputs.WEIGHT.id].array,m=0;for(r=0,n=l.length;r<n;r++){var v=l[r],y=[];for(a=0;a<v;a++){var A=u[m+h],b=g[u[m+p]];y.push({index:A,weight:b}),m+=2}for(y.sort(F),a=0;a<s;a++){var B=y[a];void 0!==B?(i.indices.array.push(B.index),i.weights.array.push(B.weight)):(i.indices.array.push(0),i.weights.array.push(0))}}t.bindShapeMatrix?i.bindMatrix=(new e.Matrix4).fromArray(t.bindShapeMatrix).transpose():i.bindMatrix=(new e.Matrix4).identity();for(r=0,n=f.array.length;r<n;r++){var C=f.array[r],x=(new e.Matrix4).fromArray(d.array,r*d.stride).transpose();i.joints.push({name:C,boneInverse:x})}return i;function F(e,t){return t.weight-e.weight}}(t.skin),a.sources.skinIndices=r.skin.indices,a.sources.skinWeights=r.skin.weights),r}function L(e){return void 0!==e.build?e.build:e.init_from}function D(e){var t=Ze.images[e];return void 0!==t?f(t,L):(console.warn("THREE.ColladaLoader: Couldn't find image with ID:",e),null)}function O(e){for(var t={surfaces:{},samplers:{}},r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"newparam":U(n,t);break;case"technique":t.technique=P(n);break;case"extra":t.extra=X(n)}}return t}function U(e,t){for(var r=e.getAttribute("sid"),a=0,n=e.childNodes.length;a<n;a++){var s=e.childNodes[a];if(1===s.nodeType)switch(s.nodeName){case"surface":t.surfaces[r]=G(s);break;case"sampler2D":t.samplers[r]=N(s)}}}function G(e){for(var t={},r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"init_from":t.init_from=n.textContent}}return t}function N(e){for(var t={},r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"source":t.source=n.textContent}}return t}function P(e){for(var t={},r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"constant":case"lambert":case"blinn":case"phong":t.type=n.nodeName,t.parameters=H(n)}}return t}function H(e){for(var t={},r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"emission":case"diffuse":case"specular":case"bump":case"ambient":case"shininess":case"transparency":t[n.nodeName]=J(n);break;case"transparent":t[n.nodeName]={opaque:n.getAttribute("opaque"),data:J(n)}}}return t}function J(e){for(var t={},r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"color":t[n.nodeName]=s(n.textContent);break;case"float":t[n.nodeName]=parseFloat(n.textContent);break;case"texture":t[n.nodeName]={id:n.getAttribute("texture"),extra:_(n)}}}return t}function _(e){for(var t={technique:{}},r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"extra":j(n,t)}}return t}function j(e,t){for(var r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"technique":V(n,t)}}}function V(e,t){for(var r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"repeatU":case"repeatV":case"offsetU":case"offsetV":t.technique[n.nodeName]=parseFloat(n.textContent);break;case"wrapU":case"wrapV":"TRUE"===n.textContent.toUpperCase()?t.technique[n.nodeName]=1:"FALSE"===n.textContent.toUpperCase()?t.technique[n.nodeName]=0:t.technique[n.nodeName]=parseInt(n.textContent)}}}function X(e){for(var t={},r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"technique":t.technique=K(n)}}return t}function K(e){for(var t={},r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"double_sided":t[n.nodeName]=parseInt(n.textContent)}}return t}function z(e){return e}function W(t){var r,a,n=(r=t.url,f(Ze.effects[r],z)),s=n.profile.technique,i=n.profile.extra;switch(s.type){case"phong":case"blinn":a=new e.MeshPhongMaterial;break;case"lambert":a=new e.MeshLambertMaterial;break;default:a=new e.MeshBasicMaterial}function o(t){var r=n.profile.samplers[t.id],a=null;void 0!==r?a=D(n.profile.surfaces[r.source].init_from):(console.warn("THREE.ColladaLoader: Undefined sampler. Access image directly (see #12530)."),a=D(t.id));if(null!==a){var s=function(e){var t,r=e.slice(2+(e.lastIndexOf(".")-1>>>0));switch(r=r.toLowerCase()){case"tga":t=Ke;break;default:t=We}return t}(a);if(void 0!==s){var i=s.load(a),o=t.extra;if(void 0!==o&&void 0!==o.technique&&!1===c(o.technique)){var l=o.technique;i.wrapS=l.wrapU?e.RepeatWrapping:e.ClampToEdgeWrapping,i.wrapT=l.wrapV?e.RepeatWrapping:e.ClampToEdgeWrapping,i.offset.set(l.offsetU||0,l.offsetV||0),i.repeat.set(l.repeatU||1,l.repeatV||1)}else i.wrapS=e.RepeatWrapping,i.wrapT=e.RepeatWrapping;return i}return console.warn("THREE.ColladaLoader: Loader for texture %s not found.",a),null}return console.warn("THREE.ColladaLoader: Couldn't create texture with ID:",t.id),null}a.name=t.name||"";var l=s.parameters;for(var u in l){var h=l[u];switch(u){case"diffuse":h.color&&a.color.fromArray(h.color),h.texture&&(a.map=o(h.texture));break;case"specular":h.color&&a.specular&&a.specular.fromArray(h.color),h.texture&&(a.specularMap=o(h.texture));break;case"bump":h.texture&&(a.normalMap=o(h.texture));break;case"ambient":h.texture&&(a.lightMap=o(h.texture));break;case"shininess":h.float&&a.shininess&&(a.shininess=h.float);break;case"emission":h.color&&a.emissive&&a.emissive.fromArray(h.color),h.texture&&(a.emissiveMap=o(h.texture))}}var p=l.transparent,d=l.transparency;if(void 0===d&&p&&(d={float:1}),void 0===p&&d&&(p={opaque:"A_ONE",data:{color:[1,1,1,1]}}),p&&d)if(p.data.texture)a.transparent=!0;else{var g=p.data.color;switch(p.opaque){case"A_ONE":a.opacity=g[3]*d.float;break;case"RGB_ZERO":a.opacity=1-g[0]*d.float;break;case"A_ZERO":a.opacity=1-g[3]*d.float;break;case"RGB_ONE":a.opacity=g[0]*d.float;break;default:console.warn('THREE.ColladaLoader: Invalid opaque type "%s" of transparent tag.',p.opaque)}a.opacity<1&&(a.transparent=!0)}return void 0!==i&&void 0!==i.technique&&1===i.technique.double_sided&&(a.side=e.DoubleSide),a}function Y(e){return f(Ze.materials[e],W)}function Q(e){for(var t=0;t<e.childNodes.length;t++){var r=e.childNodes[t];switch(r.nodeName){case"technique_common":return Z(r)}}return{}}function Z(e){for(var t={},r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];switch(a.nodeName){case"perspective":case"orthographic":t.technique=a.nodeName,t.parameters=$(a)}}return t}function $(e){for(var t={},r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];switch(a.nodeName){case"xfov":case"yfov":case"xmag":case"ymag":case"znear":case"zfar":case"aspect_ratio":t[a.nodeName]=parseFloat(a.textContent)}}return t}function ee(t){var r;switch(t.optics.technique){case"perspective":r=new e.PerspectiveCamera(t.optics.parameters.yfov,t.optics.parameters.aspect_ratio,t.optics.parameters.znear,t.optics.parameters.zfar);break;case"orthographic":var a=t.optics.parameters.ymag,n=t.optics.parameters.xmag,s=t.optics.parameters.aspect_ratio;n=void 0===n?a*s:n,a=void 0===a?n/s:a,n*=.5,a*=.5,r=new e.OrthographicCamera(-n,n,a,-a,t.optics.parameters.znear,t.optics.parameters.zfar);break;default:r=new e.PerspectiveCamera}return r.name=t.name||"",r}function te(e){var t=Ze.cameras[e];return void 0!==t?f(t,ee):(console.warn("THREE.ColladaLoader: Couldn't find camera with ID:",e),null)}function re(e){for(var t={},r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"directional":case"point":case"spot":case"ambient":t.technique=n.nodeName,t.parameters=ae(n)}}return t}function ae(t){for(var r={},a=0,n=t.childNodes.length;a<n;a++){var i=t.childNodes[a];if(1===i.nodeType)switch(i.nodeName){case"color":var o=s(i.textContent);r.color=(new e.Color).fromArray(o);break;case"falloff_angle":r.falloffAngle=parseFloat(i.textContent);break;case"quadratic_attenuation":var c=parseFloat(i.textContent);r.distance=c?Math.sqrt(1/c):0}}return r}function ne(t){var r;switch(t.technique){case"directional":r=new e.DirectionalLight;break;case"point":r=new e.PointLight;break;case"spot":r=new e.SpotLight;break;case"ambient":r=new e.AmbientLight}return t.parameters.color&&r.color.copy(t.parameters.color),t.parameters.distance&&(r.distance=t.parameters.distance),r}function se(e){var t=Ze.lights[e];return void 0!==t?f(t,ne):(console.warn("THREE.ColladaLoader: Couldn't find light with ID:",e),null)}function ie(e){for(var t={array:[],stride:3},r=0;r<e.childNodes.length;r++){var i=e.childNodes[r];if(1===i.nodeType)switch(i.nodeName){case"float_array":t.array=s(i.textContent);break;case"Name_array":t.array=n(i.textContent);break;case"technique_common":var o=a(i,"accessor")[0];void 0!==o&&(t.stride=parseInt(o.getAttribute("stride")))}}return t}function oe(e){for(var t={},r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];1===a.nodeType&&(t[a.getAttribute("semantic")]=o(a.getAttribute("source")))}return t}function ce(e){for(var t={type:e.nodeName,material:e.getAttribute("material"),count:parseInt(e.getAttribute("count")),inputs:{},stride:0,hasUV:!1},r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"input":var s=o(n.getAttribute("source")),c=n.getAttribute("semantic"),l=parseInt(n.getAttribute("offset")),u=parseInt(n.getAttribute("set")),h=u>0?c+u:c;t.inputs[h]={id:s,offset:l},t.stride=Math.max(t.stride,l+1),"TEXCOORD"===c&&(t.hasUV=!0);break;case"vcount":t.vcount=i(n.textContent);break;case"p":t.p=i(n.textContent)}}return t}function le(e){for(var t=0,r=0,a=e.length;r<a;r++){!0===e[r].hasUV&&t++}t>0&&t<e.length&&(e.uvsNeedsFix=!0)}function ue(e){var t={},r=e.sources,a=e.vertices,n=e.primitives;if(0===n.length)return{};var s=function(e){for(var t={},r=0;r<e.length;r++){var a=e[r];void 0===t[a.type]&&(t[a.type]=[]),t[a.type].push(a)}return t}(n);for(var i in s){var o=s[i];le(o),t[i]=he(o,r,a)}return t}function he(t,r,a){for(var n={},s={array:[],stride:0},i={array:[],stride:0},o={array:[],stride:0},c={array:[],stride:0},l={array:[],stride:0},u=[],h=4,p=[],f=4,d=new e.BufferGeometry,g=[],m=0,v=0;v<t.length;v++){var y=t[v],A=y.inputs,b=0;switch(y.type){case"lines":case"linestrips":b=2*y.count;break;case"triangles":b=3*y.count;break;case"polylist":for(var B=0;B<y.count;B++){var C=y.vcount[B];switch(C){case 3:b+=3;break;case 4:b+=6;break;default:b+=3*(C-2)}}break;default:console.warn("THREE.ColladaLoader: Unknow primitive type:",y.type)}for(var x in d.addGroup(m,b,v),m+=b,y.material&&g.push(y.material),A){var F=A[x];switch(x){case"VERTEX":for(var w in a){var E=a[w];switch(w){case"POSITION":var S=s.array.length;if(pe(y,r[E],F.offset,s.array),s.stride=r[E].stride,r.skinWeights&&r.skinIndices&&(pe(y,r.skinIndices,F.offset,u),pe(y,r.skinWeights,F.offset,p)),!1===y.hasUV&&!0===t.uvsNeedsFix){b=(s.array.length-S)/s.stride;for(var I=0;I<b;I++)o.array.push(0,0)}break;case"NORMAL":pe(y,r[E],F.offset,i.array),i.stride=r[E].stride;break;case"COLOR":pe(y,r[E],F.offset,l.array),l.stride=r[E].stride;break;case"TEXCOORD":pe(y,r[E],F.offset,o.array),o.stride=r[E].stride;break;case"TEXCOORD1":pe(y,r[E],F.offset,c.array),o.stride=r[E].stride;break;default:console.warn('THREE.ColladaLoader: Semantic "%s" not handled in geometry build process.',w)}}break;case"NORMAL":pe(y,r[F.id],F.offset,i.array),i.stride=r[F.id].stride;break;case"COLOR":pe(y,r[F.id],F.offset,l.array),l.stride=r[F.id].stride;break;case"TEXCOORD":pe(y,r[F.id],F.offset,o.array),o.stride=r[F.id].stride;break;case"TEXCOORD1":pe(y,r[F.id],F.offset,c.array),c.stride=r[F.id].stride}}}return s.array.length>0&&d.setAttribute("position",new e.Float32BufferAttribute(s.array,s.stride)),i.array.length>0&&d.setAttribute("normal",new e.Float32BufferAttribute(i.array,i.stride)),l.array.length>0&&d.setAttribute("color",new e.Float32BufferAttribute(l.array,l.stride)),o.array.length>0&&d.setAttribute("uv",new e.Float32BufferAttribute(o.array,o.stride)),c.array.length>0&&d.setAttribute("uv2",new e.Float32BufferAttribute(c.array,c.stride)),u.length>0&&d.setAttribute("skinIndex",new e.Float32BufferAttribute(u,h)),p.length>0&&d.setAttribute("skinWeight",new e.Float32BufferAttribute(p,f)),n.data=d,n.type=t[0].type,n.materialKeys=g,n}function pe(e,t,r,a){var n=e.p,s=e.stride,i=e.vcount;function o(e){for(var t=n[e+r]*l,s=t+l;t<s;t++)a.push(c[t])}var c=t.array,l=t.stride;if(void 0!==e.vcount)for(var u=0,h=0,p=i.length;h<p;h++){var f=i[h];if(4===f){var d=u+1*s,g=u+2*s,m=u+3*s;o(u+0*s),o(d),o(m),o(d),o(g),o(m)}else if(3===f){d=u+1*s,g=u+2*s;o(u+0*s),o(d),o(g)}else if(f>4)for(var v=1,y=f-2;v<=y;v++){d=u+s*v,g=u+s*(v+1);o(u+0*s),o(d),o(g)}u+=s*f}else for(h=0,p=n.length;h<p;h+=s)o(h)}function fe(e){return f(Ze.geometries[e],ue)}function de(e){return void 0!==e.build?e.build:e}function ge(e,t){for(var r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];if(1===a.nodeType)switch(a.nodeName){case"joint":t.joints[a.getAttribute("sid")]=me(a);break;case"link":t.links.push(ye(a))}}}function me(e){for(var t,r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];if(1===a.nodeType)switch(a.nodeName){case"prismatic":case"revolute":t=ve(a)}}return t}function ve(t,r){r={sid:t.getAttribute("sid"),name:t.getAttribute("name")||"",axis:new e.Vector3,limits:{min:0,max:0},type:t.nodeName,static:!1,zeroPosition:0,middlePosition:0};for(var a=0;a<t.childNodes.length;a++){var n=t.childNodes[a];if(1===n.nodeType)switch(n.nodeName){case"axis":var i=s(n.textContent);r.axis.fromArray(i);break;case"limits":var o=n.getElementsByTagName("max")[0],c=n.getElementsByTagName("min")[0];r.limits.max=parseFloat(o.textContent),r.limits.min=parseFloat(c.textContent)}}return r.limits.min>=r.limits.max&&(r.static=!0),r.middlePosition=(r.limits.min+r.limits.max)/2,r}function ye(e){for(var t={sid:e.getAttribute("sid"),name:e.getAttribute("name")||"",attachments:[],transforms:[]},r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];if(1===a.nodeType)switch(a.nodeName){case"attachment_full":t.attachments.push(Ae(a));break;case"matrix":case"translate":case"rotate":t.transforms.push(be(a))}}return t}function Ae(e){for(var t={joint:e.getAttribute("joint").split("/").pop(),transforms:[],links:[]},r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];if(1===a.nodeType)switch(a.nodeName){case"link":t.links.push(ye(a));break;case"matrix":case"translate":case"rotate":t.transforms.push(be(a))}}return t}function be(t){var r={type:t.nodeName},a=s(t.textContent);switch(r.type){case"matrix":r.obj=new e.Matrix4,r.obj.fromArray(a).transpose();break;case"translate":r.obj=new e.Vector3,r.obj.fromArray(a);break;case"rotate":r.obj=new e.Vector3,r.obj.fromArray(a),r.angle=e.MathUtils.degToRad(a[3])}return r}function Be(e,t){for(var r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];if(1===a.nodeType)switch(a.nodeName){case"technique_common":Ce(a,t)}}}function Ce(e,t){for(var r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];if(1===a.nodeType)switch(a.nodeName){case"inertia":t.inertia=s(a.textContent);break;case"mass":t.mass=s(a.textContent)[0]}}}function xe(e){for(var t={target:e.getAttribute("target").split("/").pop()},r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];if(1===a.nodeType)switch(a.nodeName){case"axis":var n=a.getElementsByTagName("param")[0];t.axis=n.textContent;var s=t.axis.split("inst_").pop().split("axis")[0];t.jointIndex=s.substr(0,s.length-1)}}return t}function Fe(e){return void 0!==e.build?e.build:e}function we(t){for(var r=[],a=Je.querySelector('[id="'+t.id+'"]'),n=0;n<a.childNodes.length;n++){var i=a.childNodes[n];if(1===i.nodeType)switch(i.nodeName){case"matrix":var o=s(i.textContent),c=(new e.Matrix4).fromArray(o).transpose();r.push({sid:i.getAttribute("sid"),type:i.nodeName,obj:c});break;case"translate":case"scale":o=s(i.textContent);var l=(new e.Vector3).fromArray(o);r.push({sid:i.getAttribute("sid"),type:i.nodeName,obj:l});break;case"rotate":o=s(i.textContent),l=(new e.Vector3).fromArray(o);var u=e.MathUtils.degToRad(o[3]);r.push({sid:i.getAttribute("sid"),type:i.nodeName,obj:l,angle:u})}}return r}var Ee=new e.Matrix4,Se=new e.Vector3;function Ie(t){for(var r={name:t.getAttribute("name")||"",type:t.getAttribute("type"),id:t.getAttribute("id"),sid:t.getAttribute("sid"),matrix:new e.Matrix4,nodes:[],instanceCameras:[],instanceControllers:[],instanceLights:[],instanceGeometries:[],instanceNodes:[],transforms:{}},a=0;a<t.childNodes.length;a++){var n=t.childNodes[a];if(1===n.nodeType)switch(n.nodeName){case"node":r.nodes.push(n.getAttribute("id")),Ie(n);break;case"instance_camera":r.instanceCameras.push(o(n.getAttribute("url")));break;case"instance_controller":r.instanceControllers.push(Me(n));break;case"instance_light":r.instanceLights.push(o(n.getAttribute("url")));break;case"instance_geometry":r.instanceGeometries.push(Me(n));break;case"instance_node":r.instanceNodes.push(o(n.getAttribute("url")));break;case"matrix":var i=s(n.textContent);r.matrix.multiply(Ee.fromArray(i).transpose()),r.transforms[n.getAttribute("sid")]=n.nodeName;break;case"translate":i=s(n.textContent);Se.fromArray(i),r.matrix.multiply(Ee.makeTranslation(Se.x,Se.y,Se.z)),r.transforms[n.getAttribute("sid")]=n.nodeName;break;case"rotate":i=s(n.textContent);var c=e.MathUtils.degToRad(i[3]);r.matrix.multiply(Ee.makeRotationAxis(Se.fromArray(i),c)),r.transforms[n.getAttribute("sid")]=n.nodeName;break;case"scale":i=s(n.textContent);r.matrix.scale(Se.fromArray(i)),r.transforms[n.getAttribute("sid")]=n.nodeName;break;case"extra":break;default:console.log(n)}}return Ue(r.id)?console.warn("THREE.ColladaLoader: There is already a node with ID %s. Exclude current node from further processing.",r.id):Ze.nodes[r.id]=r,r}function Me(e){for(var t={id:o(e.getAttribute("url")),materials:{},skeletons:[]},r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];switch(a.nodeName){case"bind_material":for(var n=a.getElementsByTagName("instance_material"),s=0;s<n.length;s++){var i=n[s],c=i.getAttribute("symbol"),l=i.getAttribute("target");t.materials[c]=o(l)}break;case"skeleton":t.skeletons.push(o(a.textContent))}}return t}function Te(t,r){var a,n,s,i=[],o=[];for(a=0;a<t.length;a++){var c=t[a];if(Ue(c))ke(Ge(c),r,i);else if(s=c,void 0!==Ze.visualScenes[s])for(var l=Ze.visualScenes[c].children,u=0;u<l.length;u++){var h=l[u];if("JOINT"===h.type)ke(Ge(h.id),r,i)}else console.error("THREE.ColladaLoader: Unable to find root bone of skeleton with ID:",c)}for(a=0;a<r.length;a++)for(u=0;u<i.length;u++)if((n=i[u]).bone.name===r[a].name){o[a]=n,n.processed=!0;break}for(a=0;a<i.length;a++)!1===(n=i[a]).processed&&(o.push(n),n.processed=!0);var p=[],f=[];for(a=0;a<o.length;a++)n=o[a],p.push(n.bone),f.push(n.boneInverse);return new e.Skeleton(p,f)}function ke(t,r,a){t.traverse((function(t){if(!0===t.isBone){for(var n,s=0;s<r.length;s++){var i=r[s];if(i.name===t.name){n=i.boneInverse;break}}void 0===n&&(n=new e.Matrix4),a.push({bone:t,boneInverse:n,processed:!1})}}))}function Re(t){for(var r,a=[],n=t.matrix,s=t.nodes,i=t.type,o=t.instanceCameras,c=t.instanceControllers,l=t.instanceLights,u=t.instanceGeometries,h=t.instanceNodes,p=0,d=s.length;p<d;p++)a.push(Ge(s[p]));for(p=0,d=o.length;p<d;p++){var g=te(o[p]);null!==g&&a.push(g.clone())}for(p=0,d=c.length;p<d;p++)for(var m=c[p],v=(r=m.id,f(Ze.controllers[r],R)),y=Oe(fe(v.id),m.materials),A=Te(m.skeletons,v.skin.joints),b=0,B=y.length;b<B;b++){var C;(C=y[b]).isSkinnedMesh&&(C.bind(A,v.skin.bindMatrix),C.normalizeSkinWeights()),a.push(C)}for(p=0,d=l.length;p<d;p++){var x=se(l[p]);null!==x&&a.push(x.clone())}for(p=0,d=u.length;p<d;p++)for(b=0,B=(y=Oe(fe((m=u[p]).id),m.materials)).length;b<B;b++)a.push(y[b]);for(p=0,d=h.length;p<d;p++)a.push(Ge(h[p]).clone());if(0===s.length&&1===a.length)C=a[0];else{C="JOINT"===i?new e.Bone:new e.Group;for(p=0;p<a.length;p++)C.add(a[p])}return C.name="JOINT"===i?t.sid:t.name,C.matrix.copy(n),C.matrix.decompose(C.position,C.quaternion,C.scale),C}var Le=new e.MeshBasicMaterial({color:16711935});function De(e,t){for(var r=[],a=0,n=e.length;a<n;a++){var s=t[e[a]];void 0===s?(console.warn("THREE.ColladaLoader: Material with key %s not found. Apply fallback material.",e[a]),r.push(Le)):r.push(Y(s))}return r}function Oe(t,r){var a=[];for(var n in t){var s=t[n],i=De(s.materialKeys,r);0===i.length&&("lines"===n||"linestrips"===n?i.push(new e.LineBasicMaterial):i.push(new e.MeshPhongMaterial));var o=void 0!==s.data.attributes.skinIndex;if(o)for(var c=0,l=i.length;c<l;c++)i[c].skinning=!0;var u,h=1===i.length?i[0]:i;switch(n){case"lines":u=new e.LineSegments(s.data,h);break;case"linestrips":u=new e.Line(s.data,h);break;case"triangles":case"polylist":u=o?new e.SkinnedMesh(s.data,h):new e.Mesh(s.data,h)}a.push(u)}return a}function Ue(e){return void 0!==Ze.nodes[e]}function Ge(e){return f(Ze.nodes[e],Re)}function Ne(t){var r=new e.Group;r.name=t.name;for(var a=t.children,n=0;n<a.length;n++){var s=a[n];r.add(Ge(s.id))}return r}function Pe(e){return f(Ze.visualScenes[e],Ne)}if(0===t.length)return{scene:new e.Scene};var He=(new e.$DOMParser).parseFromString(t,"application/xml"),Je=a(He,"COLLADA")[0],_e=He.getElementsByTagName("parsererror")[0];if(void 0!==_e){var je,Ve=a(_e,"div")[0];return je=Ve?Ve.textContent:function(e){for(var t="",r=[e];r.length;){var a=r.shift();a.nodeType===Node.TEXT_NODE?t+=a.textContent:(t+="\n",r.push.apply(r,a.childNodes))}return t.trim()}(_e),console.error("THREE.ColladaLoader: Failed to parse collada file.\n",je),null}var Xe=Je.getAttribute("version");console.log("THREE.ColladaLoader: File version",Xe);var Ke,ze=function(e){return{unit:l(a(e,"unit")[0]),upAxis:u(a(e,"up_axis")[0])}}(a(Je,"asset")[0]),We=new e.TextureLoader(this.manager);We.setPath(this.resourcePath||r).setCrossOrigin(this.crossOrigin),q&&(Ke=new q(this.manager)).setPath(this.resourcePath||r);var Ye=[],Qe={},qe=0,Ze={animations:{},clips:{},controllers:{},images:{},effects:{},materials:{},cameras:{},lights:{},geometries:{},nodes:{},visualScenes:{},kinematicsModels:{},physicsModels:{},kinematicsScenes:{}};h(Je,"library_animations","animation",(function t(r){for(var a={sources:{},samplers:{},channels:{}},n=!1,s=0,i=r.childNodes.length;s<i;s++){var o,c=r.childNodes[s];if(1===c.nodeType)switch(c.nodeName){case"source":o=c.getAttribute("id"),a.sources[o]=ie(c);break;case"sampler":o=c.getAttribute("id"),a.samplers[o]=d(c);break;case"channel":o=c.getAttribute("target"),a.channels[o]=g(c);break;case"animation":t(c),n=!0;break;default:console.log(c)}}!1===n&&(Ze.animations[r.getAttribute("id")||e.MathUtils.generateUUID()]=a)})),h(Je,"library_animation_clips","animation_clip",(function(e){for(var t={name:e.getAttribute("id")||"default",start:parseFloat(e.getAttribute("start")||0),end:parseFloat(e.getAttribute("end")||0),animations:[]},r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"instance_animation":t.animations.push(o(n.getAttribute("url")))}}Ze.clips[e.getAttribute("id")]=t})),h(Je,"library_controllers","controller",(function(e){for(var t={},r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"skin":t.id=o(n.getAttribute("source")),t.skin=M(n);break;case"morph":t.id=o(n.getAttribute("source")),console.warn("THREE.ColladaLoader: Morph target animation not supported yet.")}}Ze.controllers[e.getAttribute("id")]=t})),h(Je,"library_images","image",(function(e){var t={init_from:a(e,"init_from")[0].textContent};Ze.images[e.getAttribute("id")]=t})),h(Je,"library_effects","effect",(function(e){for(var t={},r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"profile_COMMON":t.profile=O(n)}}Ze.effects[e.getAttribute("id")]=t})),h(Je,"library_materials","material",(function(e){for(var t={name:e.getAttribute("name")},r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"instance_effect":t.url=o(n.getAttribute("url"))}}Ze.materials[e.getAttribute("id")]=t})),h(Je,"library_cameras","camera",(function(e){for(var t={name:e.getAttribute("name")},r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"optics":t.optics=Q(n)}}Ze.cameras[e.getAttribute("id")]=t})),h(Je,"library_lights","light",(function(e){for(var t={},r=0,a=e.childNodes.length;r<a;r++){var n=e.childNodes[r];if(1===n.nodeType)switch(n.nodeName){case"technique_common":t=re(n)}}Ze.lights[e.getAttribute("id")]=t})),h(Je,"library_geometries","geometry",(function(e){var t={name:e.getAttribute("name"),sources:{},vertices:{},primitives:[]},r=a(e,"mesh")[0];if(void 0!==r){for(var n=0;n<r.childNodes.length;n++){var s=r.childNodes[n];if(1===s.nodeType){var i=s.getAttribute("id");switch(s.nodeName){case"source":t.sources[i]=ie(s);break;case"vertices":t.vertices=oe(s);break;case"polygons":console.warn("THREE.ColladaLoader: Unsupported primitive type: ",s.nodeName);break;case"lines":case"linestrips":case"polylist":case"triangles":t.primitives.push(ce(s));break;default:console.log(s)}}}Ze.geometries[e.getAttribute("id")]=t}})),h(Je,"library_nodes","node",Ie),h(Je,"library_visual_scenes","visual_scene",(function(e){var t={name:e.getAttribute("name"),children:[]};!function(e){for(var t=e.getElementsByTagName("node"),r=0;r<t.length;r++){var a=t[r];!1===a.hasAttribute("id")&&a.setAttribute("id","three_default_"+qe++)}}(e);for(var r=a(e,"node"),n=0;n<r.length;n++)t.children.push(Ie(r[n]));Ze.visualScenes[e.getAttribute("id")]=t})),h(Je,"library_kinematics_models","kinematics_model",(function(e){for(var t={name:e.getAttribute("name")||"",joints:{},links:[]},r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];if(1===a.nodeType)switch(a.nodeName){case"technique_common":ge(a,t)}}Ze.kinematicsModels[e.getAttribute("id")]=t})),h(Je,"library_physics_models","physics_model",(function(e){for(var t={name:e.getAttribute("name")||"",rigidBodies:{}},r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];if(1===a.nodeType)switch(a.nodeName){case"rigid_body":t.rigidBodies[a.getAttribute("name")]={},Be(a,t.rigidBodies[a.getAttribute("name")])}}Ze.physicsModels[e.getAttribute("id")]=t})),h(Je,"scene","instance_kinematics_scene",(function(e){for(var t={bindJointAxis:[]},r=0;r<e.childNodes.length;r++){var a=e.childNodes[r];if(1===a.nodeType)switch(a.nodeName){case"bind_joint_axis":t.bindJointAxis.push(xe(a))}}Ze.kinematicsScenes[o(e.getAttribute("url"))]=t})),p(Ze.animations,m),p(Ze.clips,S),p(Ze.controllers,R),p(Ze.images,L),p(Ze.effects,z),p(Ze.materials,W),p(Ze.cameras,ee),p(Ze.lights,ne),p(Ze.geometries,ue),p(Ze.visualScenes,Ne),function(){var t=Ze.clips;if(!0===c(t)){if(!1===c(Ze.animations)){var r=[];for(var a in Ze.animations)for(var n=v(a),s=0,i=n.length;s<i;s++)r.push(n[s]);Ye.push(new e.AnimationClip("default",-1,r))}}else for(var a in t)Ye.push(I(a))}(),function(){var t=Object.keys(Ze.kinematicsModels)[0],r=Object.keys(Ze.kinematicsScenes)[0],a=Object.keys(Ze.visualScenes)[0];if(void 0!==t&&void 0!==r){for(var n,s=(n=t,f(Ze.kinematicsModels[n],de)),i=function(e){return f(Ze.kinematicsScenes[e],Fe)}(r),o=Pe(a),c=i.bindJointAxis,l={},u=0,h=c.length;u<h;u++){var p=c[u],d=Je.querySelector('[sid="'+p.target+'"]');if(d){var g=d.parentElement;v(p.jointIndex,g)}}var m=new e.Matrix4;Qe={joints:s&&s.joints,getJointValue:function(e){var t=l[e];if(t)return t.position;console.warn("THREE.ColladaLoader: Joint "+e+" doesn't exist.")},setJointValue:function(t,r){var a=l[t];if(a){var n=a.joint;if(r>n.limits.max||r<n.limits.min)console.warn("THREE.ColladaLoader: Joint "+t+" value "+r+" outside of limits (min: "+n.limits.min+", max: "+n.limits.max+").");else if(n.static)console.warn("THREE.ColladaLoader: Joint "+t+" is static.");else{var s=a.object,i=n.axis,o=a.transforms;Ee.identity();for(var c=0;c<o.length;c++){var u=o[c];if(u.sid&&-1!==u.sid.indexOf(t))switch(n.type){case"revolute":Ee.multiply(m.makeRotationAxis(i,e.MathUtils.degToRad(r)));break;case"prismatic":Ee.multiply(m.makeTranslation(i.x*r,i.y*r,i.z*r));break;default:console.warn("THREE.ColladaLoader: Unknown joint type: "+n.type)}else switch(u.type){case"matrix":Ee.multiply(u.obj);break;case"translate":Ee.multiply(m.makeTranslation(u.obj.x,u.obj.y,u.obj.z));break;case"scale":Ee.scale(u.obj);break;case"rotate":Ee.multiply(m.makeRotationAxis(u.obj,u.angle))}}s.matrix.copy(Ee),s.matrix.decompose(s.position,s.quaternion,s.scale),l[t].position=r}}else console.log("THREE.ColladaLoader: "+t+" does not exist.")}}}function v(e,t){var r=t.getAttribute("name"),a=s.joints[e];o.traverse((function(n){n.name===r&&(l[e]={object:n,transforms:we(t),joint:a,position:a.zeroPosition})}))}}();var $e=function(e){return Pe(o(a(e,"instance_visual_scene")[0].getAttribute("url")))}(a(Je,"scene")[0]);return $e.animations=Ye,"Z_UP"===ze.upAxis&&$e.quaternion.setFromEuler(new e.Euler(-Math.PI/2,0,0)),$e.scale.multiplyScalar(ze.unit),{get animations(){return console.warn("THREE.ColladaLoader: Please access animations over scene.animations now."),Ye},kinematics:Qe,library:Ze,scene:$e}}});function ko(e,t){return null!=e?e:t()}class Ro{__init(){this.currFrame=0}constructor(e,t,r,a,n=24,s=!0){this.tiles=e,this.totalFrame=t,this.row=r,this.col=a,Ro.prototype.__init.call(this),this.playing=!0,this.currFrame=0,this.frameGap=1e3/n,e.forEach((e=>{e.repeat.set(1/this.col,1/this.row),s&&(e.encoding=3001)})),this.updateOffset()}stop(){this.playing=!1}play(){this.playing=!0,this.startTime=Date.now(),this.startFrame=this.currFrame}get texture(){return this.tiles[this.currTile]}animate(){if(!this.playing||1===this.totalFrame)return;const e=Date.now();this.startTime=ko(this.startTime,(()=>e)),this.startFrame=ko(this.startFrame,(()=>this.currFrame));const t=this.startFrame+~~((e-this.startTime)/this.frameGap);this.currFrame=t%this.totalFrame,t>this.currFrame&&(this.startTime=e,this.startFrame=this.currFrame),this.updateOffset()}updateOffset(){this.currTile=~~(this.currFrame/(this.col*this.row)),this.currTileOffset=this.currFrame%(this.col*this.row);const e=this.tiles[this.currTile],t=1/this.row,r=this.currTileOffset%this.col,a=~~(this.currTileOffset/this.col);e&&(e.offset.x=r/this.col,e.offset.y=1-a/this.row-t)}dispose(){!function(e){let t,r=e[0],a=1;for(;a<e.length;){const n=e[a],s=e[a+1];if(a+=2,("optionalAccess"===n||"optionalCall"===n)&&null==r)return;"access"===n||"optionalAccess"===n?(t=r,r=s(r)):"call"!==n&&"optionalCall"!==n||(r=s(((...e)=>r.call(t,...e))),t=void 0)}}([this,"access",e=>e.mesh,"optionalAccess",e=>e.material,"access",e=>e.dispose,"call",e=>e()]),this.tiles.forEach((e=>e.dispose())),this.tiles.length=0,this.mesh=null}}const Lo={url:["https://s3.ax1x.com/2021/02/26/yx0ObV.png","https://s3.ax1x.com/2021/02/26/yx0LD0.png","https://s3.ax1x.com/2021/02/26/yx0Hvn.png"],x:0,y:0,z:-15,w:10,h:10,col:2,row:2,total:10,fps:16};var Do=function(t){!1===e.$window.isSecureContext&&console.error("THREE.DeviceOrientationControls: DeviceOrientationEvent is only available in secure contexts (https)");var r=this,a={type:"change"};this.object=t,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alphaOffset=0;var n,s,i,o,c,l=function(e){r.deviceOrientation=e},u=function(){r.screenOrientation=e.$window.orientation||0},h=(n=new e.Vector3(0,0,1),s=new e.Euler,i=new e.Quaternion,o=new e.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5)),function(e,t,r,a,c){s.set(r,t,-a,"YXZ"),e.setFromEuler(s),e.multiply(o),e.multiply(i.setFromAxisAngle(n,-c))});this.connect=function(){u(),void 0!==e.$window.DeviceOrientationEvent&&"function"==typeof e.$window.DeviceOrientationEvent.requestPermission?e.$window.DeviceOrientationEvent.requestPermission().then((function(t){"granted"==t&&(e.$window.addEventListener("orientationchange",u),e.$window.addEventListener("deviceorientation",l))})).catch((function(e){console.error("THREE.DeviceOrientationControls: Unable to use DeviceOrientation API:",e)})):(e.$window.addEventListener("orientationchange",u),e.$window.addEventListener("deviceorientation",l)),r.enabled=!0},this.disconnect=function(){e.$window.removeEventListener("orientationchange",u),e.$window.removeEventListener("deviceorientation",l),r.enabled=!1},this.update=(c=new e.Quaternion,function(){if(!1!==r.enabled){var t=r.deviceOrientation;if(t){var n=t.alpha?e.MathUtils.degToRad(t.alpha)+r.alphaOffset:0,s=t.beta?e.MathUtils.degToRad(t.beta):0,i=t.gamma?e.MathUtils.degToRad(t.gamma):0,o=r.screenOrientation?e.MathUtils.degToRad(r.screenOrientation):0;h(r.object.quaternion,n,s,i,o),8*(1-c.dot(r.object.quaternion))>1e-6&&(c.copy(r.object.quaternion),r.dispatchEvent(a))}}}),this.dispose=function(){r.disconnect()},this.connect()};(Do.prototype=Object.create(e.EventDispatcher.prototype)).constructor=Do;function Oo(e,t,r,a){if(Array.isArray(e)){for(var n=Oo(new Float64Array(e),t,r,a),s=0;s<e.length;s++)e[s]=n[s];return e}if(!t||!r)throw Error("Bad dimensions");a||(a=e.length/(t*r));for(var i=r>>1,o=t*a,c=new(0,e.constructor)(t*a),l=0;l<i;++l){var u=l*o,h=(r-l-1)*o;c.set(e.subarray(u,u+o)),e.copyWithin(u,h,h+o),e.set(c,h)}return e}exports.DemoBVHLoader=class extends T{async init(){const{scene:t,camera:r}=this.deps,a=new Sn;r.position.set(0,200,300);const n=await a.loadAsync(M+"/models/bvh/pirouette.bvh"),s=new e.SkeletonHelper(n.skeleton.bones[0]);s.skeleton=n.skeleton;const i=new e.Group;i.add(n.skeleton.bones[0]),this.add(s),this.add(i),t.background=new e.Color(15658734),this.add(new e.GridHelper(400,10)),this.mixer=new e.AnimationMixer(s),this.mixer.clipAction(n.clip).setEffectiveWeight(1).play(),this.addControl(),this.orbitControl.minDistance=300,this.orbitControl.maxDistance=700}update(){In([this,"access",e=>e.mixer,"optionalAccess",e=>e.update,"call",e=>e(this.deps.clock.getDelta())]),In([this,"access",e=>e.orbitControl,"optionalAccess",e=>e.update,"call",e=>e()])}dispose(){this.reset(),this.mixer.stopAllAction(),this.mixer=null}},exports.DemoColladaLoader=class extends T{async init(){const{camera:t}=this.deps;t.position.set(8,10,8),t.lookAt(0,3,0);const r=new To,a=await r.loadAsync(M+"/models/collada/elf/elf.dae");this.add(a.scene);const n=new e.AmbientLight(13421772,.4);this.add(n);const s=new e.DirectionalLight(16777215,.8);s.position.set(1,1,0).normalize(),this.add(s),this.addControl()}update(){!function(e){let t,r=e[0],a=1;for(;a<e.length;){const n=e[a],s=e[a+1];if(a+=2,("optionalAccess"===n||"optionalCall"===n)&&null==r)return;"access"===n||"optionalAccess"===n?(t=r,r=s(r)):"call"!==n&&"optionalCall"!==n||(r=s(((...e)=>r.call(t,...e))),t=void 0)}}([this,"access",e=>e.orbitControl,"optionalAccess",e=>e.update,"call",e=>e()])}dispose(){this.reset()}},exports.DemoDeviceOrientationControls=class extends T{async init(){const{camera:t,textureLoader:r}=this.deps;this.control=new Do(t);const a=new e.SphereGeometry(500,60,40);a.scale(-1,1,1);const n=new e.MeshBasicMaterial({map:await r.loadAsync("https://s3.ax1x.com/2021/02/26/yx0quq.jpg")}),s=new e.BoxGeometry(100,100,100,4,4,4),i=new e.MeshBasicMaterial({color:16711935,wireframe:!0});this.add(new e.Mesh(a,n)),this.add(new e.Mesh(s,i))}update(){!function(e){let t,r=e[0],a=1;for(;a<e.length;){const n=e[a],s=e[a+1];if(a+=2,("optionalAccess"===n||"optionalCall"===n)&&null==r)return;"access"===n||"optionalAccess"===n?(t=r,r=s(r)):"call"!==n&&"optionalCall"!==n||(r=s(((...e)=>r.call(t,...e))),t=void 0)}}([this,"access",e=>e.control,"optionalAccess",e=>e.update,"call",e=>e()])}dispose(){this.reset(),this.control.disconnect(),this.control.dispose(),this.control=null}},exports.DemoEXRLoader=class extends T{async init(){const{renderer:t}=this.deps,r=(new oo).setDataType(e.FloatType),a=await r.loadAsync(M+"/textures/memorial.exr"),n=new e.MeshBasicMaterial({map:a}),s=new e.PlaneGeometry(4.5*a.image.width/a.image.height,4.5);this.add(new e.Mesh(s,n)),this.lastToneMapping=t.toneMapping,this.lastToneMappingExposure=t.toneMappingExposure,t.toneMapping=e.ReinhardToneMapping,t.toneMappingExposure=2}update(){}dispose(){this.deps.renderer.toneMapping=this.lastToneMapping,this.deps.renderer.toneMappingExposure=this.lastToneMappingExposure,this.reset()}},exports.DemoFBXLoader=class extends T{async init(){const{camera:t,scene:r}=this.deps;t.position.set(100,200,300),r.background=new e.Color(10526880),r.fog=new e.Fog(10526880,200,1e3);const a=new e.HemisphereLight(16777215,4473924);a.position.set(0,200,0),this.add(a);const n=new e.DirectionalLight(16777215);n.position.set(0,200,100),n.castShadow=!0,n.shadow.camera.top=180,n.shadow.camera.bottom=-100,n.shadow.camera.left=-120,n.shadow.camera.right=120,this.add(n);const s=new e.Mesh(new e.PlaneGeometry(2e3,2e3),new e.MeshPhongMaterial({color:10066329,depthWrite:!1}));s.rotation.x=-Math.PI/2,s.receiveShadow=!0,this.add(s);const i=new e.GridHelper(2e3,20,0,0);i.material.opacity=.2,i.material.transparent=!0,this.add(i);const o=new Xi,c=await o.loadAsync(M+"/models/fbx/Samba Dancing.fbx"),l=new e.AnimationMixer(c);l.clipAction(c.animations[0]).play(),c.traverse((function(e){e.isMesh&&(e.castShadow=!0,e.receiveShadow=!0)})),this.add(c),this.addControl(),this.orbitControl.target.set(0,100,0),this.orbitControl.update(),this.mixer=l}update(){Ki([this,"access",e=>e.mixer,"optionalAccess",e=>e.update,"call",e=>e(this.deps.clock.getDelta())]),Ki([this,"access",e=>e.orbitControl,"optionalAccess",e=>e.update,"call",e=>e()])}dispose(){this.reset(),this.mixer.stopAllAction(),this.mixer=null}},exports.DemoGLTFLoader=class extends T{async init(){const t=await this.deps.gltfLoader.loadAsync("https://dtmall-tel.alicdn.com/edgeComputingConfig/upload_models/1591673169101/RobotExpressive.glb");t.scene.position.z=2.5,t.scene.position.y=-2,this.add(new e.DirectionalLight(16777215,1)),this.add(new e.AmbientLight(16777215,1)),this.add(t.scene),this.deps.camera.position.z=10;const r=["Idle","Walking","Running","Dance","Death","Sitting","Standing"],a=["Jump","Yes","No","Wave","Punch","ThumbsUp"];this.mixer=new e.AnimationMixer(t.scene);const n={};for(let s=0;s<t.animations.length;s++){const i=t.animations[s],o=this.mixer.clipAction(i);n[i.name]=o,(a.indexOf(i.name)>=0||r.indexOf(i.name)>=4)&&(o.clampWhenFinished=!0,o.loop=e.LoopOnce)}n.Walking.play(),this.addControl()}update(){Mo([this,"access",e=>e.mixer,"optionalAccess",e=>e.update,"call",e=>e(this.deps.clock.getDelta())]),Mo([this,"access",e=>e.orbitControl,"optionalAccess",e=>e.update,"call",e=>e()])}dispose(){this.mixer.stopAllAction(),this.mixer=null,this.reset()}},exports.DemoHDRPrefilterTexture=class extends T{async init(){const{scene:t,camera:r}=this.deps,a=await this.deps.textureLoader.loadAsync("https://i.loli.net/2021/02/01/FAf8VEDdSNHBQLG.png");!function(t,r=!0){r&&(t.format=e.RGBEFormat,t.encoding=e.RGBEEncoding),t.generateMipmaps=!1,t.magFilter=e.NearestFilter,t.minFilter=e.NearestFilter,t.type=e.UnsignedByteType,t.mapping=e.CubeUVReflectionMapping,t.name="PMREM.cubeUv"}(a);const n=new e.PlaneGeometry(3,3),s=new e.MeshBasicMaterial({map:a}),i=new e.Mesh(n,s);this.add(i),t.background=a,r.position.z=1,this.addControl()}update(){!function(e){let t,r=e[0],a=1;for(;a<e.length;){const n=e[a],s=e[a+1];if(a+=2,("optionalAccess"===n||"optionalCall"===n)&&null==r)return;"access"===n||"optionalAccess"===n?(t=r,r=s(r)):"call"!==n&&"optionalCall"!==n||(r=s(((...e)=>r.call(t,...e))),t=void 0)}}([this,"access",e=>e.orbitControl,"optionalAccess",e=>e.update,"call",e=>e()])}dispose(){this.reset()}},exports.DemoLWOLoader=class extends T{async init(){const{scene:t,renderer:r,camera:a}=this.deps;a.position.set(-.7,14.6,43.2),t.background=new e.Color(10526880);const n=new e.AmbientLight(11184810,1.75);this.add(n);const s=new e.DirectionalLight(16777215,1);s.position.set(0,200,100),s.castShadow=!0,s.shadow.camera.top=180,s.shadow.camera.bottom=-100,s.shadow.camera.left=-120,s.shadow.camera.right=120,this.add(s);const i=new e.DirectionalLight(16777215,.7);i.position.set(-100,200,-100),this.add(i);const o=new e.DirectionalLight(16777215,.4);o.position.set(100,-200,100),this.add(o);const c=new e.DirectionalLight(16777215,1);c.position.set(-100,-100,100),this.add(c);const l=new e.GridHelper(200,20,0,0);l.material.opacity=.3,l.material.transparent=!0,this.add(l);const u=new eo,h=await u.loadAsync(M+"/models/lwo/Objects/LWO3/Demo.lwo"),p=h.meshes[0];p.position.set(-2,12,0);const f=h.meshes[1];f.position.set(2,12,0);const d=h.meshes[2];d.position.set(0,10.5,-1),this.add(p),this.add(d),this.add(f),r.shadowMap.enabled=!0,r.physicallyCorrectLights=!0,r.gammaFactor=1.18,this.addControl(),this.orbitControl.target.set(1.33,10,-6.7)}update(){!function(e){let t,r=e[0],a=1;for(;a<e.length;){const n=e[a],s=e[a+1];if(a+=2,("optionalAccess"===n||"optionalCall"===n)&&null==r)return;"access"===n||"optionalAccess"===n?(t=r,r=s(r)):"call"!==n&&"optionalCall"!==n||(r=s(((...e)=>r.call(t,...e))),t=void 0)}}([this,"access",e=>e.orbitControl,"optionalAccess",e=>e.update,"call",e=>e()])}dispose(){this.reset()}},exports.DemoMTLLoader=class extends T{async init(){const{camera:t,renderer:r}=this.deps,a=new e.LoadingManager;a.addHandler(/\.dds$/i,new so);const n=new no(a),s=new io(a),i=await n.loadAsync(M+"/models/obj/male02/male02.mtl");i.preload();const o=await s.setMaterials(i).loadAsync(M+"/models/obj/male02/male02.obj");o.position.y=-95,this.addControl(),this.add(new e.AmbientLight(13421772,.4)),this.addCamera(new e.PointLight(16777215,.8)),this.add(o),this.add(t),o.position.y=-95,t.position.z=200,r.outputEncoding=e.LinearEncoding}update(){!function(e){let t,r=e[0],a=1;for(;a<e.length;){const n=e[a],s=e[a+1];if(a+=2,("optionalAccess"===n||"optionalCall"===n)&&null==r)return;"access"===n||"optionalAccess"===n?(t=r,r=s(r)):"call"!==n&&"optionalCall"!==n||(r=s(((...e)=>r.call(t,...e))),t=void 0)}}([this,"access",e=>e.orbitControl,"optionalAccess",e=>e.update,"call",e=>e()])}dispose(){this.reset()}},exports.DemoMemoryTest=class extends T{async init(){this.reset(!1);const t=await this.deps.gltfLoader.loadAsync(M+"/models/gltf/Soldier.glb");this.add(new e.DirectionalLight(16777215,1)),this.add(new e.AmbientLight(16777215,1)),this.add(t.scene),this.timer=setTimeout((()=>this.init()),300)}update(){}dispose(){this.reset(),clearTimeout(this.timer)}},exports.DemoMeshOpt=class extends T{async init(){const{gltfLoader:t,camera:r,scene:a}=this.deps;t.setMeshoptDecoder(Y);const n=Date.now(),s=await t.loadAsync("https://meshoptimizer.org/demo/pirate.glb");console.log(Date.now()-n);const i=new e.PointLight(16777215,.8);i.position.set(3,3,0),this.add(new e.AmbientLight(13421772,.3)),this.add(s.scene),this.add(r),this.addCamera(i),s.scene.position.y=-1,a.position.z=0,r.position.y=1,r.position.z=3,a.background=new e.Color(3148324),this.addControl()}update(){!function(e){let t,r=e[0],a=1;for(;a<e.length;){const n=e[a],s=e[a+1];if(a+=2,("optionalAccess"===n||"optionalCall"===n)&&null==r)return;"access"===n||"optionalAccess"===n?(t=r,r=s(r)):"call"!==n&&"optionalCall"!==n||(r=s(((...e)=>r.call(t,...e))),t=void 0)}}([this,"access",e=>e.orbitControl,"optionalAccess",e=>e.update,"call",e=>e()])}dispose(){this.reset()}},exports.DemoMeshQuantization=class extends T{async init(){const{camera:t,gltfLoader:r,scene:a}=this.deps,n=Date.now();r.setMeshoptDecoder(Q);const s=await r.loadAsync("https://cdn.static.oppenlab.com/weblf/test/PrimaryIonDrive-EXT_MESH_QUANTIZATION.glb"),i=Date.now();console.log("load glb time",i-n),this.add(s.scene),this.add(new e.DirectionalLight(16777215,1)),this.add(new e.AmbientLight(16777215,1)),t.position.z=3,a.position.z=0,this.addControl()}update(){!function(e){let t,r=e[0],a=1;for(;a<e.length;){const n=e[a],s=e[a+1];if(a+=2,("optionalAccess"===n||"optionalCall"===n)&&null==r)return;"access"===n||"optionalAccess"===n?(t=r,r=s(r)):"call"!==n&&"optionalCall"!==n||(r=s(((...e)=>r.call(t,...e))),t=void 0)}}([this,"access",e=>e.orbitControl,"optionalAccess",e=>e.update,"call",e=>e()])}dispose(){this.reset()}},exports.DemoOBJLoader=class extends T{async init(){const{textureLoader:t,camera:r,renderer:a}=this.deps,n=await t.loadAsync(M+"/textures/UV_Grid_Sm.jpg"),s=new io,i=await s.loadAsync(M+"/models/obj/male02/male02.obj");this.add(new e.AmbientLight(13421772,.4)),this.addCamera(new e.PointLight(16777215,.8)),this.add(i),this.add(r),i.traverse((function(e){e.isMesh&&(e.material.map=n)})),i.position.y=-95,r.position.z=200,a.outputEncoding=e.LinearEncoding,this.addControl()}update(){!function(e){let t,r=e[0],a=1;for(;a<e.length;){const n=e[a],s=e[a+1];if(a+=2,("optionalAccess"===n||"optionalCall"===n)&&null==r)return;"access"===n||"optionalAccess"===n?(t=r,r=s(r)):"call"!==n&&"optionalCall"!==n||(r=s(((...e)=>r.call(t,...e))),t=void 0)}}([this,"access",e=>e.orbitControl,"optionalAccess",e=>e.update,"call",e=>e()])}dispose(){this.reset()}},exports.DemoPDBLoader=class extends T{async init(){const{camera:t,scene:r,renderer:a}=this.deps;t.position.z=100,r.position.z=0,r.background=new e.Color(328965),a.outputEncoding=e.LinearEncoding,this.addControl(),this.obj=new e.Group,this.obj.scale.set(.1,.1,.1),this.add(this.obj);const n=new e.DirectionalLight(16777215,.8);n.position.set(1,1,1);const s=new e.DirectionalLight(16777215,.5);s.position.set(-1,-1,1),this.add(n),this.add(s);const i=new Z,o=await i.loadAsync(M+"/models/molecules/caffeine.pdb");this.loadMolecule(o)}update(){!function(e){let t,r=e[0],a=1;for(;a<e.length;){const n=e[a],s=e[a+1];if(a+=2,("optionalAccess"===n||"optionalCall"===n)&&null==r)return;"access"===n||"optionalAccess"===n?(t=r,r=s(r)):"call"!==n&&"optionalCall"!==n||(r=s(((...e)=>r.call(t,...e))),t=void 0)}}([this,"access",e=>e.orbitControl,"optionalAccess",e=>e.update,"call",e=>e()])}dispose(){this.reset()}loadMolecule(t){var r=t.geometryAtoms,a=t.geometryBonds,n=t.json,s=new e.Vector3,i=new e.BoxGeometry(1,1,1),o=new e.IcosahedronGeometry(1,2);r.computeBoundingBox(),r.boundingBox.getCenter(s).negate(),r.translate(s.x,s.y,s.z),a.translate(s.x,s.y,s.z);for(var c=r.getAttribute("position"),l=r.getAttribute("color"),u=new e.Vector3,h=new e.Color,p=0;p<c.count;p++){u.x=c.getX(p),u.y=c.getY(p),u.z=c.getZ(p),h.r=l.getX(p),h.g=l.getY(p),h.b=l.getZ(p);var f=new e.MeshPhongMaterial({color:h});(m=new e.Mesh(o,f)).position.copy(u),m.position.multiplyScalar(75),m.scale.multiplyScalar(25),this.obj.add(m);n.atoms[p]}c=a.getAttribute("position");var d=new e.Vector3,g=new e.Vector3;for(p=0;p<c.count;p+=2){var m;d.x=c.getX(p),d.y=c.getY(p),d.z=c.getZ(p),g.x=c.getX(p+1),g.y=c.getY(p+1),g.z=c.getZ(p+1),d.multiplyScalar(75),g.multiplyScalar(75),(m=new e.Mesh(i,new e.MeshPhongMaterial({color:16777215}))).position.copy(d),m.position.lerp(g,.5),m.scale.set(5,5,d.distanceTo(g)),m.lookAt(g),this.obj.add(m)}}},exports.DemoRGBELoader=class extends T{async init(){const{renderer:t,gltfLoader:r,scene:a,camera:n}=this.deps,s=await r.loadAsync(Io+"/examples/models/gltf/MetalRoughSpheres/glTF/MetalRoughSpheres.gltf");s.scene.rotation.copy(new e.Euler(0,0,0)),t.physicallyCorrectLights=!0;const i=new So,o=new e.PMREMGenerator(t);o.compileEquirectangularShader();const c=Date.now(),l=await i.setDataType(e.UnsignedByteType).loadAsync(Io+"/examples/textures/equirectangular/venice_sunset_2k.hdr"),u=Date.now(),h=o.fromEquirectangular(l).texture;console.log("time cost",Date.now()-u,u-c),l.dispose(),o.dispose(),a.background=h,s.scene.traverse((function(e){e.material&&(e.material.isMeshStandardMaterial||e.material.isShaderMaterial&&void 0!==e.material.envMap)&&(e.material.envMap=h,e.material.envMapIntensity=1.5),(e.isMesh||e.isLight)&&(e.castShadow=!0)}));const p=new e.DirectionalLight(14540253,4);p.position.set(0,0,1).normalize();const f=new e.SpotLight(16777215,1);f.position.set(5,10,5),f.angle=.5,f.penumbra=.75,f.intensity=100,f.decay=2,n.position.set(2,1,15),this.add(s.scene),this.add(p),this.add(new e.AmbientLight(2236962)),this.add(f),this.addControl()}update(){!function(e){let t,r=e[0],a=1;for(;a<e.length;){const n=e[a],s=e[a+1];if(a+=2,("optionalAccess"===n||"optionalCall"===n)&&null==r)return;"access"===n||"optionalAccess"===n?(t=r,r=s(r)):"call"!==n&&"optionalCall"!==n||(r=s(((...e)=>r.call(t,...e))),t=void 0)}}([this,"access",e=>e.orbitControl,"optionalAccess",e=>e.update,"call",e=>e()])}dispose(){this.reset()}},exports.DemoSTLLoader=class extends T{async init(){const{camera:t,renderer:r,scene:a}=this.deps;t.position.set(3,.15,3),r.setClearColor(16777215),a.position.z=0,a.background=new e.Color(7496795),a.fog=new e.Fog(7496795,2,15),r.shadowMap.enabled=!0;const n=new e.Mesh(new e.PlaneGeometry(40,40),new e.MeshPhongMaterial({color:10066329,specular:1052688}));n.rotation.x=-Math.PI/2,n.position.y=-.5,n.receiveShadow=!0,this.add(n),this.add(new e.AmbientLight(4473924)),this.addShadowedLight(1,1,1,16777215,1.35),this.addShadowedLight(.5,1,-1,16755200,1),this.addControl(),this.loadModels()}addShadowedLight(t,r,a,n,s){const i=new e.DirectionalLight(n,s);i.position.set(t,r,a),this.add(i),i.castShadow=!0;i.shadow.camera.left=-1,i.shadow.camera.right=1,i.shadow.camera.top=1,i.shadow.camera.bottom=-1,i.shadow.camera.near=1,i.shadow.camera.far=4,i.shadow.bias=-.002}loadModels(){const t=new te;t.load(M+"/models/stl/ascii/slotted_disk.stl",(t=>{const r=new e.MeshPhongMaterial({color:16733491,specular:1118481,shininess:200}),a=new e.Mesh(t,r);a.position.set(0,-.25,.6),a.rotation.set(0,-Math.PI/2,0),a.scale.set(.5,.5,.5),a.castShadow=!0,a.receiveShadow=!0,this.add(a)}));const r=new e.MeshPhongMaterial({color:11184810,specular:1118481,shininess:200});t.load(M+"/models/stl/binary/pr2_head_pan.stl",(t=>{const a=new e.Mesh(t,r);a.position.set(0,-.37,-.6),a.rotation.set(-Math.PI/2,0,0),a.scale.set(2,2,2),a.castShadow=!0,a.receiveShadow=!0,this.add(a)})),t.load("./models/stl/binary/pr2_head_tilt.stl",(t=>{const a=new e.Mesh(t,r);a.position.set(.136,-.37,-.6),a.rotation.set(-Math.PI/2,.3,0),a.scale.set(2,2,2),a.castShadow=!0,a.receiveShadow=!0,this.add(a)})),t.load(M+"/models/stl/binary/colored.stl",(t=>{let a=r;t.hasColors&&(a=new e.MeshPhongMaterial({opacity:t.alpha,vertexColors:!0}));const n=new e.Mesh(t,a);n.position.set(.5,.2,0),n.rotation.set(-Math.PI/2,Math.PI/2,0),n.scale.set(.3,.3,.3),n.castShadow=!0,n.receiveShadow=!0,this.add(n)}))}update(){!function(e){let t,r=e[0],a=1;for(;a<e.length;){const n=e[a],s=e[a+1];if(a+=2,("optionalAccess"===n||"optionalCall"===n)&&null==r)return;"access"===n||"optionalAccess"===n?(t=r,r=s(r)):"call"!==n&&"optionalCall"!==n||(r=s(((...e)=>r.call(t,...e))),t=void 0)}}([this,"access",e=>e.orbitControl,"optionalAccess",e=>e.update,"call",e=>e()]),this.deps.camera.lookAt(new e.Vector3(0,-.25,0))}dispose(){this.reset()}},exports.DemoSVGLoader=class extends T{async init(){const{camera:t,renderer:r}=this.deps,a=new Eo,n=await a.loadAsync("http://www.yanhuangxueyuan.com/threejs/examples/models/svg/tiger.svg"),s=new e.GridHelper(160,10);s.rotation.x=Math.PI/2,this.add(s),this.add(this.initSVG(n)),this.addControl(),t.position.set(0,0,200),r.outputEncoding=e.LinearEncoding}initSVG(t){const r=!1,a=!1,{paths:n}=t;var s=new e.Group;s.scale.multiplyScalar(.25),s.position.x=-70,s.position.y=70,s.scale.y*=-1;for(var i=0;i<n.length;i++){var o=n[i],c=o.userData.style.fill;if(void 0!==c&&"none"!==c)for(var l=new e.MeshBasicMaterial({color:(new e.Color).setStyle(c),opacity:o.userData.style.fillOpacity,transparent:o.userData.style.fillOpacity<1,side:e.DoubleSide,depthWrite:!1,wireframe:r}),u=o.toShapes(!0),h=0;h<u.length;h++){var p=u[h],f=new e.ShapeGeometry(p),d=new e.Mesh(f,l);s.add(d)}var g=o.userData.style.stroke;if(void 0!==g&&"none"!==g){l=new e.MeshBasicMaterial({color:(new e.Color).setStyle(g),opacity:o.userData.style.strokeOpacity,transparent:o.userData.style.strokeOpacity<1,side:e.DoubleSide,depthWrite:!1,wireframe:a}),h=0;for(var m=o.subPaths.length;h<m;h++){var v=o.subPaths[h];if(f=Eo.pointsToStroke(v.getPoints(),o.userData.style)){d=new e.Mesh(f,l);s.add(d)}}}}return s}update(){!function(e){let t,r=e[0],a=1;for(;a<e.length;){const n=e[a],s=e[a+1];if(a+=2,("optionalAccess"===n||"optionalCall"===n)&&null==r)return;"access"===n||"optionalAccess"===n?(t=r,r=s(r)):"call"!==n&&"optionalCall"!==n||(r=s(((...e)=>r.call(t,...e))),t=void 0)}}([this,"access",e=>e.orbitControl,"optionalAccess",e=>e.update,"call",e=>e()])}dispose(){this.reset()}},exports.DemoTGALoader=class extends T{async init(){const{camera:t,renderer:r}=this.deps,a=new q,[n,s]=await Promise.all([a.loadAsync(M+"/textures/crate_grey8.tga"),a.loadAsync(M+"/textures/crate_color8.tga")]);t.position.set(0,50,250);const i=new e.BoxGeometry(50,50,50),o=new e.MeshPhongMaterial({color:16777215,map:n}),c=new e.Mesh(i,o);c.position.x=-50;const l=new e.MeshPhongMaterial({color:16777215,map:s}),u=new e.Mesh(i,l);u.position.x=50;const h=new e.DirectionalLight(16777215,1);h.position.set(1,1,1),this.add(c),this.add(u),this.add(h),this.add(new e.AmbientLight(16777215,.4)),this.addControl(),r.outputEncoding=e.LinearEncoding}update(){!function(e){let t,r=e[0],a=1;for(;a<e.length;){const n=e[a],s=e[a+1];if(a+=2,("optionalAccess"===n||"optionalCall"===n)&&null==r)return;"access"===n||"optionalAccess"===n?(t=r,r=s(r)):"call"!==n&&"optionalCall"!==n||(r=s(((...e)=>r.call(t,...e))),t=void 0)}}([this,"access",e=>e.orbitControl,"optionalAccess",e=>e.update,"call",e=>e()])}dispose(){this.reset()}},exports.DemoTTFLoader=class extends T{async init(){const{camera:t,scene:r,renderer:a}=this.deps;t.position.set(0,400,700),r.background=new e.Color(0),r.fog=new e.Fog(0,250,1400);const n=new e.DirectionalLight(16777215,.125);n.position.set(0,0,1).normalize(),this.add(n);const s=new e.PointLight(16777215,1.5);s.position.set(0,100,90),s.color.setHSL(Math.random(),1,.5),this.add(s);const i=new e.MeshPhongMaterial({color:16777215,flatShading:!0}),o=new e.Group;o.position.y=100,this.add(o);const c=new En,l=await c.loadAsync(M+"/fonts/ttf/kenpixel.ttf");console.log(l),this.createText(new e.Font(l),o,i);const u=new e.Mesh(new e.PlaneGeometry(1e4,1e4),new e.MeshBasicMaterial({color:16777215,opacity:.5,transparent:!0}));u.position.y=100,u.rotation.x=-Math.PI/2,a.outputEncoding=e.LinearEncoding,this.add(u),this.addControl()}createText(t,r,a){const n=new e.TextGeometry("three.js",{font:t,size:70,height:20,curveSegments:4,bevelThickness:2,bevelSize:1.5,bevelEnabled:!0});n.computeBoundingBox(),n.computeVertexNormals();const s=-.5*(n.boundingBox.max.x-n.boundingBox.min.x),i=new e.Mesh(n,a);i.position.x=s,i.position.y=30,i.position.z=0,i.rotation.x=0,i.rotation.y=2*Math.PI,r.add(i);{const t=new e.Mesh(n,a);t.position.x=s,t.position.y=-30,t.position.z=20,t.rotation.x=Math.PI,t.rotation.y=2*Math.PI,r.add(t)}}update(){!function(e){let t,r=e[0],a=1;for(;a<e.length;){const n=e[a],s=e[a+1];if(a+=2,("optionalAccess"===n||"optionalCall"===n)&&null==r)return;"access"===n||"optionalAccess"===n?(t=r,r=s(r)):"call"!==n&&"optionalCall"!==n||(r=s(((...e)=>r.call(t,...e))),t=void 0)}}([this,"access",e=>e.orbitControl,"optionalAccess",e=>e.update,"call",e=>e()])}dispose(){this.reset()}},exports.DemoThreeSpritePlayer=class extends T{async init(){const{textureLoader:t}=this.deps,r=await Promise.all(Lo.url.map((e=>t.loadAsync(e)))),a=new Ro(r,Lo.total,Lo.row,Lo.col,Lo.fps,!0),n=new e.PlaneGeometry(Lo.w,Lo.h),s=new e.MeshBasicMaterial({map:a.texture,transparent:!1}),i=new e.Mesh(n,s),o=new e.BoxGeometry,c=new e.Mesh(o,s);c.position.y=-1.2,i.position.z=-8,i.position.y=4,this.add(i),this.add(c),this.mesh=i,this.player=a}update(){this.player.animate(),this.mesh.material.map=this.player.texture}dispose(){this.reset(),this.player.dispose(),this.player=null,this.mesh=null}},exports.GLTFLoader=x,exports.WechatPlatform=class{constructor(e,t,r){const a=wx.getSystemInfoSync(),n="android"===a.platform;this.canvas=e,this.canvasW=void 0===t?e.width:t,this.canvasH=void 0===r?e.height:r,this.document={createElementNS:(t,r)=>"canvas"===r?e:"img"===r?e.createImage():void 0},this.window={innerWidth:a.windowWidth,innerHeight:a.windowHeight,devicePixelRatio:a.pixelRatio,URL:new s,AudioContext:function(){},requestAnimationFrame:this.canvas.requestAnimationFrame,cancelAnimationFrame:this.canvas.cancelAnimationFrame,DeviceOrientationEvent:{requestPermission:()=>Promise.resolve("granted")},DOMParser:b,TextDecoder:B},[this.canvas,this.document,this.window].forEach((e=>{const t=e.__proto__;e.__proto__={},e.__proto__.__proto__=t,function(e,t){for(let r of Object.getOwnPropertyNames(t))if("constructor"!==r&&"prototype"!==r&&"name"!==r){let a=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,a)}}(e.__proto__,u.prototype)})),this.patchCanvas(),this.onDeviceMotionChange=e=>{e.type="deviceorientation",n&&(e.alpha*=-1,e.beta*=-1,e.gamma*=-1),this.window.dispatchEvent(e)}}patchCanvas(){const{canvasH:e,canvasW:t}=this;Object.defineProperty(this.canvas,"style",{get(){return{width:this.width+"px",height:this.height+"px"}}}),Object.defineProperty(this.canvas,"clientHeight",{get(){return e||this.height}}),Object.defineProperty(this.canvas,"clientWidth",{get(){return t||this.width}}),this.canvas.ownerDocument=this.document}patchXHR(){return v.useFetchPatch=!0,this}getGlobals(){return{atob:i,Blob:t,window:this.window,document:this.document,HTMLCanvasElement:void 0,XMLHttpRequest:v,OffscreenCanvas:C,createImageBitmap:void 0}}enableDeviceOrientation(e){return new Promise(((t,r)=>{wx.onDeviceMotionChange(this.onDeviceMotionChange),wx.startDeviceMotionListening({interval:e,success:e=>{t(e),this.enabledDeviceMotion=!0},fail:r})}))}disableDeviceOrientation(){return new Promise(((e,t)=>{wx.offDeviceMotionChange(this.onDeviceMotionChange),this.enabledDeviceMotion&&wx.stopDeviceMotionListening({success:()=>{e(),this.enabledDeviceMotion=!1},fail:t})}))}dispatchTouchEvent(e={}){const t={...this},r={changedTouches:e.changedTouches.map((e=>new l(e))),touches:e.touches.map((e=>new l(e))),targetTouches:Array.prototype.slice.call(e.touches.map((e=>new l(e)))),timeStamp:e.timeStamp,target:t,currentTarget:t,type:e.type,cancelBubble:!1,cancelable:!1};this.canvas.dispatchEvent(r)}dispose(){this.disableDeviceOrientation(),this.canvas.width=0,this.canvas.height=0,this.canvas&&(this.canvas.ownerDocument=null),this.onDeviceMotionChange=null,this.document=null,this.window=null,this.canvas=null}},exports.screenshot=function(e,t,r,a){const{width:n,height:s}=e.domElement,i=new a(n,s),o=new Uint8Array(n*s*4);return i.texture.encoding=e.outputEncoding,e.setRenderTarget(i),e.render(t,r),e.readRenderTargetPixels(i,0,0,n,s,o),e.setRenderTarget(null),i.dispose(),Oo(o,n,s,4),[o,n,s]};
